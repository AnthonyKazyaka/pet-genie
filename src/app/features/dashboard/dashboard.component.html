
    <div class="dashboard-container">
      <header class="dashboard-header">
        <div class="header-content">
          <h1>Dashboard</h1>
          <p class="subtitle">Welcome to Pet Genie - Your pet sitting business assistant</p>
        </div>
        <div class="header-actions" *ngIf="isConnected()">
          <button mat-stroked-button routerLink="/calendar">
            <mat-icon>add</mat-icon>
            View Calendar
          </button>
        </div>
      </header>

      <!-- Quick Stats -->
      <section class="stats-grid" aria-label="Quick statistics">
        @if (isLoading()) {
          <app-skeleton-loader type="stat" [count]="4"></app-skeleton-loader>
        } @else {
          <mat-card 
            class="stat-card clickable" 
            (click)="navigateToCalendar('today')"
            (keydown.enter)="navigateToCalendar('today')"
            tabindex="0"
            role="button"
            [attr.aria-label]="getTodayAriaLabel()"
          >
            <mat-card-content>
              <div class="stat-icon">
                <mat-icon>event</mat-icon>
              </div>
              <div class="stat-info">
                <span class="stat-value">{{ todayStats().eventCount }}</span>
                <span class="stat-label">Today's Appointments</span>
              </div>
              <mat-icon class="stat-arrow">chevron_right</mat-icon>
            </mat-card-content>
          </mat-card>

          <mat-card 
            class="stat-card clickable" 
            (click)="navigateToCalendar('today')"
            (keydown.enter)="navigateToCalendar('today')"
            tabindex="0"
            role="button"
            [attr.aria-label]="'Work hours today: ' + todayStats().hoursFormatted + '. Click to view in calendar.'"
          >
            <mat-card-content>
              <div class="stat-icon">
                <mat-icon>schedule</mat-icon>
              </div>
              <div class="stat-info">
                <span class="stat-value">{{ todayStats().hoursFormatted }}</span>
                <span class="stat-label">Work Hours Today</span>
              </div>
              <mat-icon class="stat-arrow">chevron_right</mat-icon>
            </mat-card-content>
          </mat-card>

          <mat-card 
            class="stat-card clickable" 
            [style.--accent-color]="weekStats().levelColor"
            (click)="navigateToAnalytics()"
            (keydown.enter)="navigateToAnalytics()"
            tabindex="0"
            role="button"
            [attr.aria-label]="'This week: ' + weekStats().hoursFormatted + ', status ' + weekStats().levelLabel + '. Click to view analytics.'"
          >
            <mat-card-content>
              <div class="stat-icon" [style.background]="weekStats().levelColor">
                <mat-icon>trending_up</mat-icon>
              </div>
              <div class="stat-info">
                <span class="stat-value">{{ weekStats().hoursFormatted }}</span>
                <span class="stat-label">This Week ({{ weekStats().levelLabel }})</span>
              </div>
              <mat-icon class="stat-arrow">chevron_right</mat-icon>
            </mat-card-content>
          </mat-card>

          <mat-card 
            class="stat-card clickable" 
            (click)="navigateToCalendar('week')"
            (keydown.enter)="navigateToCalendar('week')"
            tabindex="0"
            role="button"
            [attr.aria-label]="'Visits this week: ' + weekStats().eventCount + '. Click to view in calendar.'"
          >
            <mat-card-content>
              <div class="stat-icon visits-icon">
                <mat-icon>pets</mat-icon>
              </div>
              <div class="stat-info">
                <span class="stat-value">{{ weekStats().eventCount }}</span>
                <span class="stat-label">Visits This Week</span>
              </div>
              <mat-icon class="stat-arrow">chevron_right</mat-icon>
            </mat-card-content>
          </mat-card>
        }
      </section>

      <!-- Burnout Warning / Workload Alert -->
      @if (isConnected() && hasCompletedSetup() && (hasWarnings() || burnoutIndicators().isHighLoad)) {
        <section class="workload-alert" aria-label="Workload alert">
          <mat-card 
            class="alert-card" 
            [class.alert-warning]="!hasCritical() && hasWarnings()"
            [class.alert-critical]="hasCritical()"
            [style.--alert-color]="burnoutIndicators().color"
          >
            <mat-card-header>
              <mat-icon mat-card-avatar class="alert-icon">
                {{ hasCritical() ? 'warning' : 'trending_up' }}
              </mat-icon>
              <mat-card-title>
                {{ hasCritical() ? 'High Workload Alert' : 'Busy Week Ahead' }}
              </mat-card-title>
              <mat-card-subtitle>
                {{ burnoutIndicators().message }}
              </mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <div class="alert-metrics">
                <div class="metric">
                  <span class="metric-value">{{ burnoutIndicators().weeklyHours | number:'1.1-1' }}h</span>
                  <span class="metric-label">This Week</span>
                </div>
                <div class="metric">
                  <span class="metric-value">{{ burnoutIndicators().dailyAverage | number:'1.1-1' }}h</span>
                  <span class="metric-label">Daily Avg</span>
                </div>
                @if (burnoutIndicators().busiestDay) {
                  <div class="metric">
                    <span class="metric-value">{{ burnoutIndicators().busiestDay!.hours | number:'1.1-1' }}h</span>
                    <span class="metric-label">{{ format(burnoutIndicators().busiestDay!.date, 'EEE') }} (Busiest)</span>
                  </div>
                }
              </div>

              @if (violations().length > 0) {
                <div class="violations-list">
                  @for (violation of violations().slice(0, 3); track violation.type + violation.date) {
                    <div class="violation-item" [class.critical]="violation.severity === 'critical'">
                      <mat-icon>{{ violation.icon }}</mat-icon>
                      <div class="violation-info">
                        <span class="violation-title">{{ violation.title }}</span>
                        <span class="violation-desc">{{ violation.description }}</span>
                      </div>
                    </div>
                  }
                </div>
              }
            </mat-card-content>
            <mat-card-actions>
              <button mat-button routerLink="/analytics">
                <mat-icon>insights</mat-icon>
                View Analytics
              </button>
              <button mat-button routerLink="/settings">
                <mat-icon>tune</mat-icon>
                Adjust Thresholds
              </button>
            </mat-card-actions>
          </mat-card>
        </section>
      }

      <!-- Getting Started / Setup Progress -->
      @if (!isConnected() || !hasCompletedSetup()) {
        <section class="getting-started" aria-label="Setup wizard">
          <mat-card>
            <mat-card-header>
              <mat-icon mat-card-avatar class="wizard-icon">auto_fix_high</mat-icon>
              <mat-card-title>Getting Started</mat-card-title>
              <mat-card-subtitle>
                Complete these steps to get the most out of Pet Genie
              </mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <!-- Progress Bar -->
              <div class="setup-progress">
                <div class="progress-info">
                  <span>Setup Progress</span>
                  <span class="progress-percentage">{{ setupProgress() }}%</span>
                </div>
                <mat-progress-bar 
                  mode="determinate" 
                  [value]="setupProgress()"
                  aria-label="Setup progress"
                ></mat-progress-bar>
              </div>

              <div class="setup-steps">
                <div class="setup-step" [class.completed]="isConnected()">
                  <div class="step-indicator">
                    @if (isConnected()) {
                      <mat-icon class="check-icon">check_circle</mat-icon>
                    } @else {
                      <span class="step-number">1</span>
                    }
                  </div>
                  <div class="step-content">
                    <h3>Connect Google Calendar</h3>
                    <p>Link your Google Calendar to import your pet sitting appointments</p>
                  </div>
                  @if (!isConnected()) {
                    <button mat-raised-button color="primary" routerLink="/settings">
                      <mat-icon>link</mat-icon>
                      Connect
                    </button>
                  } @else {
                    <mat-icon class="step-done">done</mat-icon>
                  }
                </div>

                <div class="setup-step" [class.completed]="hasCalendarsSelected()">
                  <div class="step-indicator">
                    @if (hasCalendarsSelected()) {
                      <mat-icon class="check-icon">check_circle</mat-icon>
                    } @else {
                      <span class="step-number">2</span>
                    }
                  </div>
                  <div class="step-content">
                    <h3>Select Calendars</h3>
                    <p>Choose which calendars contain your pet sitting appointments</p>
                  </div>
                  @if (!hasCalendarsSelected()) {
                    <button 
                      mat-stroked-button 
                      routerLink="/settings"
                      [disabled]="!isConnected()"
                    >
                      <mat-icon>event_note</mat-icon>
                      Select
                    </button>
                  } @else {
                    <mat-icon class="step-done">done</mat-icon>
                  }
                </div>

                <div class="setup-step" [class.completed]="hasTemplates()">
                  <div class="step-indicator">
                    @if (hasTemplates()) {
                      <mat-icon class="check-icon">check_circle</mat-icon>
                    } @else {
                      <span class="step-number">3</span>
                    }
                  </div>
                  <div class="step-content">
                    <h3>Configure Templates</h3>
                    <p>Set up appointment templates for quick scheduling</p>
                  </div>
                  @if (!hasTemplates()) {
                    <button mat-stroked-button routerLink="/templates">
                      <mat-icon>description</mat-icon>
                      Configure
                    </button>
                  } @else {
                    <mat-icon class="step-done">done</mat-icon>
                  }
                </div>

                <div class="setup-step" [class.completed]="hasCustomThresholds()">
                  <div class="step-indicator">
                    @if (hasCustomThresholds()) {
                      <mat-icon class="check-icon">check_circle</mat-icon>
                    } @else {
                      <span class="step-number">4</span>
                    }
                  </div>
                  <div class="step-content">
                    <h3>Set Workload Thresholds</h3>
                    <p>Customize your comfort levels for workload monitoring</p>
                  </div>
                  @if (!hasCustomThresholds()) {
                    <button mat-stroked-button routerLink="/settings">
                      <mat-icon>tune</mat-icon>
                      Customize
                    </button>
                  } @else {
                    <mat-icon class="step-done">done</mat-icon>
                  }
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </section>
      }

      <!-- Upcoming Appointments -->
      <section class="upcoming-section" aria-label="Upcoming appointments">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Upcoming Appointments</mat-card-title>
            <mat-card-subtitle>Your schedule for the next 7 days</mat-card-subtitle>
            <button 
              mat-stroked-button 
              class="view-all-btn" 
              routerLink="/calendar"
              *ngIf="upcomingEvents().length > 0"
            >
              View All
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </mat-card-header>
          <mat-card-content>
            @if (isLoading()) {
              <app-skeleton-loader type="list" [count]="5"></app-skeleton-loader>
            } @else if (upcomingEvents().length === 0) {
              <app-empty-state
                icon="event_available"
                title="No upcoming appointments"
                [description]="isConnected() ? 'Your schedule is clear for the next 7 days.' : 'Connect your calendar to see your schedule.'"
                [actionLabel]="isConnected() ? 'View Calendar' : 'Connect Calendar'"
                [actionLink]="isConnected() ? '/calendar' : '/settings'"
                [actionIcon]="isConnected() ? 'calendar_month' : 'link'"
                [compact]="true"
              ></app-empty-state>
            } @else {
              <div class="events-list">
                @for (group of groupedEvents(); track group.label) {
                  <div class="event-group">
                    <div class="group-header">
                      <span class="group-label">{{ group.label }}</span>
                      <span class="group-count">{{ group.events.length }} {{ group.events.length === 1 ? 'event' : 'events' }}</span>
                    </div>
                    @for (event of group.events; track event.id) {
                      <div 
                        class="event-item" 
                        [class.work-event]="event.isWorkEvent"
                        tabindex="0"
                        role="article"
                        [attr.aria-label]="getEventAriaLabel(event)"
                      >
                        <div class="event-time-block">
                          <span class="event-time">{{ format(event.start, 'h:mm a') }}</span>
                          <span class="event-duration">{{ getEventDuration(event) }}</span>
                        </div>
                        <div class="event-details">
                          <span class="event-title">{{ event.title }}</span>
                          <span class="event-client" *ngIf="event.clientName">
                            <mat-icon>pets</mat-icon>
                            {{ event.clientName }}
                          </span>
                          <span class="event-location" *ngIf="event.location">
                            <mat-icon>location_on</mat-icon>
                            {{ event.location }}
                          </span>
                        </div>
                        <mat-icon class="event-type-icon" [matTooltip]="event.isWorkEvent ? 'Pet sitting appointment' : 'Personal event'">
                          {{ event.isWorkEvent ? 'pets' : 'event' }}
                        </mat-icon>
                      </div>
                    }
                  </div>
                }
              </div>
            }
          </mat-card-content>
        </mat-card>
      </section>

      <!-- Quick Actions -->
      @if (isConnected()) {
        <section class="quick-actions" aria-label="Quick actions">
          <h2>Quick Actions</h2>
          <div class="actions-grid">
            <button mat-stroked-button class="action-card" routerLink="/calendar">
              <mat-icon>calendar_month</mat-icon>
              <span>View Calendar</span>
            </button>
            <button mat-stroked-button class="action-card" routerLink="/templates">
              <mat-icon>add_circle</mat-icon>
              <span>New Template</span>
            </button>
            <button mat-stroked-button class="action-card" routerLink="/analytics">
              <mat-icon>insights</mat-icon>
              <span>View Analytics</span>
            </button>
            <button mat-stroked-button class="action-card" routerLink="/settings">
              <mat-icon>settings</mat-icon>
              <span>Settings</span>
            </button>
          </div>
        </section>
      }
    </div>
  