
    <div class="templates-container">
      <header class="page-header">
        <div class="header-content">
          <h1>Templates</h1>
          <p class="subtitle">Create appointment templates for quick scheduling</p>
        </div>
        <button mat-raised-button color="primary" (click)="createTemplate()">
          <mat-icon>add</mat-icon>
          New Template
        </button>
      </header>

      <!-- Search and Filter -->
      <div class="search-filter-bar">
        <mat-form-field appearance="outline" class="search-field">
          <mat-icon matPrefix>search</mat-icon>
          <input
            matInput
            placeholder="Search templates..."
            [(ngModel)]="searchQuery"
            (ngModelChange)="onSearchChange()"
          />
          @if (searchQuery) {
            <button mat-icon-button matSuffix (click)="clearSearch()">
              <mat-icon>close</mat-icon>
            </button>
          }
        </mat-form-field>

        <div class="filter-chips">
          <mat-chip-listbox [value]="selectedType()" (selectionChange)="onTypeChange($event)">
            <mat-chip-option value="">All</mat-chip-option>
            @for (type of serviceTypes; track type.value) {
              <mat-chip-option [value]="type.value">{{ type.label }}</mat-chip-option>
            }
          </mat-chip-listbox>
        </div>
      </div>

      @if (filteredTemplates().length === 0) {
        @if (searchQuery || selectedType()) {
          <app-empty-state
            icon="search_off"
            title="No templates found"
            description="Try adjusting your search or filter criteria"
            actionLabel="Clear Filters"
            (action)="clearFilters()"
          ></app-empty-state>
        } @else {
          <app-empty-state
            icon="description"
            title="No templates yet"
            description="Create your first template to streamline your scheduling"
            actionLabel="Create Template"
            (action)="createTemplate()"
          ></app-empty-state>
        }
      } @else {
        <div class="templates-grid">
          @for (template of filteredTemplates(); track template.id) {
            <mat-card class="template-card" [class.default]="template.isDefault">
              <div class="card-content" (click)="editTemplate(template)">
                <div class="template-header">
                  <span class="template-icon">{{ template.icon }}</span>
                  <div class="template-info">
                    <h3>{{ template.name }}</h3>
                    <span class="template-duration">{{ formatDuration(template.duration) }}</span>
                  </div>
                  @if (template.isDefault) {
                    <span class="default-badge">Default</span>
                  }
                </div>

                <div class="template-details">
                  <div class="detail-chip">
                    <mat-icon>category</mat-icon>
                    <span>{{ formatType(template.type) }}</span>
                  </div>
                  @if (template.includeTravel) {
                    <div class="detail-chip">
                      <mat-icon>directions_car</mat-icon>
                      <span>+{{ template.travelBuffer }}min</span>
                    </div>
                  }
                </div>
              </div>

              <div class="card-actions">
                <button mat-icon-button matTooltip="Edit" (click)="editTemplate(template); $event.stopPropagation()">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button matTooltip="Duplicate" (click)="duplicateTemplate(template); $event.stopPropagation()">
                  <mat-icon>content_copy</mat-icon>
                </button>
                <button
                  mat-icon-button
                  matTooltip="Delete"
                  (click)="confirmDeleteTemplate(template); $event.stopPropagation()"
                  [disabled]="template.isDefault"
                >
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </mat-card>
          }

          <!-- Add New Card -->
          <button class="add-template-card" (click)="createTemplate()">
            <mat-icon>add_circle_outline</mat-icon>
            <span>Add Template</span>
          </button>
        </div>
      }
    </div>
  