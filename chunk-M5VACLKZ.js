import{Na as xr,Oa as He,Pa as Vr}from"./chunk-77V6CQ2B.js";import{C as Ji,E as Xi,G as Ge,K as Zi,X as to,a as C,b as V,ba as G,d as S,ga as Ke,ha as It,hb as eo,k as he,lb as ft,n as $e,o as N,p as Zt,t as Yi,u as te,xc as zt,yc as no}from"./chunk-5MEO4XP4.js";var Tt=(()=>{class r{constructor(){this.PREFIX="petgenie_"}get(e){try{let s=localStorage.getItem(this.PREFIX+e);return s?JSON.parse(s):null}catch{return this.remove(e),null}}set(e,s){try{localStorage.setItem(this.PREFIX+e,JSON.stringify(s))}catch(i){console.error(`Error writing to localStorage: ${e}`,i)}}remove(e){localStorage.removeItem(this.PREFIX+e)}clear(){let e=[];for(let s=0;s<localStorage.length;s++){let i=localStorage.key(s);i?.startsWith(this.PREFIX)&&e.push(i)}e.forEach(s=>localStorage.removeItem(s))}getCached(e){let s=this.get(e);return Vr(s)?s.data:(s&&this.remove(e),null)}setCached(e,s,i=15){let c={data:s,timestamp:Date.now(),expiryMs:i*60*1e3};this.set(e,c)}isCacheValid(e){let s=this.get(e);return Vr(s)}getCacheTimestamp(e){let s=this.get(e);return s?new Date(s.timestamp):null}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var ro=(()=>{class r{constructor(e){this.storage=e,this.EVENTS_CACHE_KEY="events_cache",this.SETTINGS_KEY="settings",this.CALENDARS_KEY="calendars",this.IGNORED_EVENTS_KEY="ignored_events",this.CACHE_EXPIRY_MINUTES=15,this.eventsSignal=ft([]),this.calendarsSignal=ft([]),this.settingsSignal=ft(He),this.ignoredEventIdsSignal=ft(new Set),this.isLoadingSignal=ft(!1),this.lastRefreshSignal=ft(null),this.events=this.eventsSignal.asReadonly(),this.calendars=this.calendarsSignal.asReadonly(),this.settings=this.settingsSignal.asReadonly(),this.ignoredEventIds=this.ignoredEventIdsSignal.asReadonly(),this.isLoading=this.isLoadingSignal.asReadonly(),this.lastRefresh=this.lastRefreshSignal.asReadonly(),this.selectedCalendars=zt(()=>this.calendarsSignal().filter(s=>s.selected)),this.workEvents=zt(()=>this.eventsSignal().filter(s=>s.isWorkEvent&&!this.ignoredEventIdsSignal().has(s.id))),this.visibleEvents=zt(()=>this.eventsSignal().filter(s=>!this.ignoredEventIdsSignal().has(s.id))),this.loadFromStorage()}loadFromStorage(){let e=this.storage.get(this.SETTINGS_KEY);e&&this.settingsSignal.set(C(C({},He),e));let s=this.storage.get(this.CALENDARS_KEY);s&&this.calendarsSignal.set(s);let i=this.storage.get(this.IGNORED_EVENTS_KEY);i&&this.ignoredEventIdsSignal.set(new Set(i));let c=this.storage.getCached(this.EVENTS_CACHE_KEY);if(c){let u=c.map(m=>V(C({},m),{start:new Date(m.start),end:new Date(m.end)}));this.eventsSignal.set(u),this.lastRefreshSignal.set(this.storage.getCacheTimestamp(this.EVENTS_CACHE_KEY))}}setEvents(e){this.eventsSignal.set(e),this.storage.setCached(this.EVENTS_CACHE_KEY,e,this.CACHE_EXPIRY_MINUTES),this.lastRefreshSignal.set(new Date)}clearEventsCache(){this.storage.remove(this.EVENTS_CACHE_KEY),this.eventsSignal.set([]),this.lastRefreshSignal.set(null)}isEventsCacheValid(){return this.storage.isCacheValid(this.EVENTS_CACHE_KEY)}getEventsInRange(e,s){return this.eventsSignal().filter(i=>i.start>=e&&i.start<=s)}getEventsForDate(e){let s=new Date(e);s.setHours(0,0,0,0);let i=new Date(e);return i.setHours(23,59,59,999),this.getEventsInRange(s,i)}downloadEventsAsJSON(e="events.json"){let s=JSON.stringify(this.eventsSignal(),null,2),i=new Blob([s],{type:"application/json;charset=utf-8"}),c=URL.createObjectURL(i),u=document.createElement("a");u.href=c,u.download=e,u.click(),URL.revokeObjectURL(c)}setCalendars(e){this.calendarsSignal.set(e),this.storage.set(this.CALENDARS_KEY,e)}toggleCalendarSelection(e){let s=this.calendarsSignal().map(i=>i.id===e?V(C({},i),{selected:!i.selected}):i);this.setCalendars(s)}setSelectedCalendarIds(e){let s=this.calendarsSignal().map(i=>V(C({},i),{selected:e.includes(i.id)}));this.setCalendars(s)}updateSettings(e){let s=C(C({},this.settingsSignal()),e);this.settingsSignal.set(s),this.storage.set(this.SETTINGS_KEY,s)}resetSettings(){this.settingsSignal.set(He),this.storage.set(this.SETTINGS_KEY,He)}ignoreEvent(e){let s=new Set(this.ignoredEventIdsSignal());s.add(e),this.ignoredEventIdsSignal.set(s),this.storage.set(this.IGNORED_EVENTS_KEY,Array.from(s))}unignoreEvent(e){let s=new Set(this.ignoredEventIdsSignal());s.delete(e),this.ignoredEventIdsSignal.set(s),this.storage.set(this.IGNORED_EVENTS_KEY,Array.from(s))}isEventIgnored(e){return this.ignoredEventIdsSignal().has(e)}setLoading(e){this.isLoadingSignal.set(e)}static{this.\u0275fac=function(s){return new(s||r)(Ke(Tt))}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Yc={};function An(){return Yc}var Jc=Math.pow(10,8)*24*60*60*1e3,Ld=-Jc,Bd=6048e5,so=864e5,io=6e4;var Ud=43200,qd=1440;var Xc=3600;var oo=Xc*24,jd=oo*7,Zc=oo*365.2425,tu=Zc/12,zd=tu*3,kr=Symbol.for("constructDateFrom");function de(r,t){return typeof r=="function"?r(t):r&&typeof r=="object"&&kr in r?r[kr](t):r instanceof Date?new r.constructor(t):new Date(t)}function z(r,t){return de(t||r,r)}function ao(r,t){let e=An(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??e.weekStartsOn??e.locale?.options?.weekStartsOn??0,i=z(r,t?.in),c=i.getDay(),u=(c<s?7:0)+c-s;return i.setDate(i.getDate()-u),i.setHours(0,0,0,0),i}function pt(r,t){let e=z(r,t?.in);return e.setHours(0,0,0,0),e}function fe(r,...t){let e=de.bind(null,r||t.find(s=>typeof s=="object"));return t.map(e)}function co(r,t,e){let[s,i]=fe(e?.in,r,t);return+pt(s)==+pt(i)}function uo(r){return t=>{let s=(r?Math[r]:Math.trunc)(t);return s===0?0:s}}function lo(r,t){return+z(r)-+z(t)}function Nr(r,t,e){let s=lo(r,t)/io;return uo(e?.roundingMethod)(s)}function We(r,t){let e=z(r,t?.in);return e.setHours(23,59,59,999),e}function ho(r,t){let e=z(r,t?.in),s=e.getMonth();return e.setFullYear(e.getFullYear(),s+1,0),e.setHours(23,59,59,999),e}function fo(r,t){let[e,s]=fe(r,t.start,t.end);return{start:e,end:s}}function mo(r,t){let{start:e,end:s}=fo(t?.in,r),i=+e>+s,c=i?+e:+s,u=i?s:e;u.setHours(0,0,0,0);let m=t?.step??1;if(!m)return[];m<0&&(m=-m,i=!i);let E=[];for(;+u<=c;)E.push(de(e,u)),u.setDate(u.getDate()+m),u.setHours(0,0,0,0);return i?E.reverse():E}function po(r,t){let e=z(r,t?.in);return e.setDate(1),e.setHours(0,0,0,0),e}function go(r,t){let e=An(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??e.weekStartsOn??e.locale?.options?.weekStartsOn??0,i=z(r,t?.in),c=i.getDay(),u=(c<s?-7:0)+6-(c-s);return i.setDate(i.getDate()+u),i.setHours(23,59,59,999),i}function Or(r){let t=z(r),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+r-+e}function yo(r,t,e){let[s,i]=fe(e?.in,r,t),c=pt(s),u=pt(i),m=+c-Or(c),E=+u-Or(u);return Math.round((m-E)/so)}function Mr(r,t){return+z(r)>+z(t)}function Fr(r,t){return+z(r)<+z(t)}var Sn=(()=>{class r{constructor(){this.workEventPatterns={minutesSuffix:/\b(15|20|30|45|60)\b/i,meetAndGreet:/\b(MG|M&G|Meet\s*&?\s*Greet)\b/i,housesitSuffix:/\b(HS|Housesit|House\s*sit)\b/i,overnight:/\b(ON|Overnight|Over\s*night)\b/i,nailTrim:/\b(nail\s*trim|NT)\b/i,walk:/\b(walk|walking)\b/i,dropIn:/\b(drop[\s-]?in|visit)\b/i,petNamePattern:/^([A-Za-z]+(?:\s*(?:&|and|,)\s*[A-Za-z]+)*)\s*[-–—]\s*/i},this.personalEventPatterns={admin:/\b(admin|administration|administrative|paperwork|bookkeeping|billing)\b/i,offDay:/^\s*✨\s*off\s*✨/i,dayOff:/\b(day\s*off|off\s*day|no\s*work)\b/i,doctor:/\b(doctor|dr\.|dentist|medical|appointment|appt)\b/i,personal:/\b(personal|private|family)\b/i,blocked:/\b(blocked|busy|unavailable|break)\b/i,holiday:/\b(holiday|vacation|pto|time\s*off)\b/i,meals:/\b(lunch|dinner|breakfast|meal)\b/i,travel:/\b(flight|airport|travel(?!.*time))\b/i,entertainment:/\b(movie|concert|show|game|party)\b/i,me:/\b(me time|self care|gym|workout|exercise)\b/i}}isWorkEvent(e){let s=typeof e=="string"?e:e.title;return!s||s.trim().length===0||this.isDefinitelyPersonal(s)?!1:this.matchesWorkPattern(s)}isDefinitelyPersonal(e){for(let s of Object.values(this.personalEventPatterns))if(s.test(e))return!0;return!1}matchesWorkPattern(e){return!!(this.workEventPatterns.minutesSuffix.test(e)||this.workEventPatterns.meetAndGreet.test(e)||this.workEventPatterns.housesitSuffix.test(e)||this.workEventPatterns.overnight.test(e)||this.workEventPatterns.nailTrim.test(e)||this.workEventPatterns.walk.test(e)||this.workEventPatterns.dropIn.test(e)||this.workEventPatterns.petNamePattern.test(e))}isOvernightEvent(e){let s=e.title.toLowerCase();return!!(this.workEventPatterns.housesitSuffix.test(s)||this.workEventPatterns.overnight.test(s)||Nr(e.end,e.start)/60>=8&&!co(e.start,e.end))}calculateOvernightNights(e){if(!this.isOvernightEvent(e))return 0;let s=yo(e.end,e.start);return Math.max(1,s)}calculateEventDurationForDay(e,s){let i=pt(s),c=We(s);if(Mr(e.start,c)||Fr(e.end,i))return 0;let u=Mr(e.start,i)?e.start:i,m=Fr(e.end,c)?e.end:c,E=Nr(m,u);return this.isOvernightEvent(e)&&(E=Math.min(E,12*60)),Math.max(0,E)}extractClientName(e){let s=e.match(this.workEventPatterns.petNamePattern);if(s)return s[1].trim();let i=[" - "," \u2013 "," \u2014 "," | "," @ "];for(let c of i){let u=e.indexOf(c);if(u>0)return e.substring(0,u).trim()}return e.trim()}extractServiceInfo(e){let s={type:"other",duration:30},i=e.match(/\b(15|20|30|45|60)\b/);return i&&(s.duration=parseInt(i[1],10)),this.workEventPatterns.meetAndGreet.test(e)?(s.type="meet-greet",s.duration=s.duration||30):this.workEventPatterns.housesitSuffix.test(e)?(s.type="housesit",s.duration=1440):this.workEventPatterns.overnight.test(e)?(s.type="overnight",s.duration=720):this.workEventPatterns.nailTrim.test(e)?(s.type="nail-trim",s.duration=s.duration||15):this.workEventPatterns.walk.test(e)?s.type="walk":(this.workEventPatterns.dropIn.test(e)||i)&&(s.type="drop-in"),s.petName=this.extractClientName(e),s}processEvent(e){let s=this.isWorkEvent(e);return V(C({},e),{isWorkEvent:s,isOvernightEvent:s?this.isOvernightEvent(e):!1,clientName:s?this.extractClientName(e.title):void 0,serviceInfo:s?this.extractServiceInfo(e.title):void 0})}processEvents(e){return e.map(s=>this.processEvent(s))}getServiceTypeLabel(e){return{"drop-in":"Drop-In Visit",walk:"Walk",overnight:"Overnight",housesit:"Housesit","meet-greet":"Meet & Greet","nail-trim":"Nail Trim",other:"Other"}[e]||"Other"}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var jf=(()=>{class r{constructor(e,s){this.dataService=e,this.eventProcessor=s,this.DEFAULT_TRAVEL_TIME=15}calculateDailyMetrics(e,s){let c=(s||this.dataService.getEventsForDate(e)).filter(b=>b.isWorkEvent),u=this.dataService.settings(),m=0;for(let b of c)m+=this.eventProcessor.calculateEventDurationForDay(b,e);let E=u.includeTravelTime?this.calculateEstimatedTravelTime(c):0,T=m+E,R=T/60;return{date:e,workTime:m,travelTime:E,totalTime:T,eventCount:c.length,level:xr(R,"daily",u.thresholds)}}calculateRangeMetrics(e,s,i){let c=mo({start:e,end:s}),u=i||this.dataService.events();return c.map(m=>{let E=u.filter(T=>this.eventOverlapsDay(T,m));return this.calculateDailyMetrics(m,E)})}eventOverlapsDay(e,s){let i=pt(s),c=We(s);return e.start<=c&&e.end>=i}calculateEstimatedTravelTime(e){if(e.length===0)return 0;let s=0,i=[...e].sort((c,u)=>c.start.getTime()-u.start.getTime());for(let c=0;c<i.length;c++){let u=i[c],m=c>0?i[c-1]:null;m&&u.location&&m.location===u.location?s+=1:s+=2}return s*this.DEFAULT_TRAVEL_TIME}getWorkloadSummary(e,s=new Date){let i,c;switch(e){case"daily":i=pt(s),c=We(s);break;case"weekly":i=ao(s,{weekStartsOn:0}),c=go(s,{weekStartsOn:0});break;case"monthly":i=po(s),c=ho(s);break}let u=this.calculateRangeMetrics(i,c),m=u.reduce((x,M)=>x+M.workTime,0),E=u.reduce((x,M)=>x+M.travelTime,0),T=u.reduce((x,M)=>x+M.eventCount,0),R=u.reduce((x,M)=>M.totalTime>x.hours*60?{date:M.date,hours:M.totalTime/60}:x,{date:i,hours:0}),b=(m+E)/60,A=u.length,O=b/A;return{period:e,startDate:i,endDate:c,totalWorkHours:m/60,totalTravelHours:E/60,averageDailyHours:O,busiestDay:R,level:xr(b,e,this.dataService.settings().thresholds),eventCount:T}}getTodayMetrics(){return this.calculateDailyMetrics(new Date)}getThisWeekSummary(){return this.getWorkloadSummary("weekly",new Date)}getThisMonthSummary(){return this.getWorkloadSummary("monthly",new Date)}getWorkloadColor(e){return{comfortable:"#10B981",busy:"#F59E0B",high:"#F97316",burnout:"#EF4444"}[e]}getWorkloadLabel(e){return{comfortable:"Comfortable",busy:"Busy",high:"High",burnout:"Burnout Risk"}[e]}formatHours(e){if(e<1)return`${Math.round(e*60)} min`;let s=Math.floor(e),i=Math.round((e-s)*60);return i===0?`${s}h`:`${s}h ${i}m`}static{this.\u0275fac=function(s){return new(s||r)(Ke(ro),Ke(Sn))}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Yf=(()=>{class r{constructor(){this.SCOPES="https://www.googleapis.com/auth/calendar.readonly",this.DISCOVERY_DOC="https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest",this.TOKEN_KEY="google_access_token",this.TOKEN_EXPIRY_KEY="google_token_expiry",this.ngZone=It(eo),this.storage=It(Tt),this.eventProcessor=It(Sn),this.authStateSignal=ft({isInitialized:!1,isSignedIn:!1,accessToken:null,tokenExpiry:null,userEmail:null}),this.tokenClient=null,this.gapiInitialized=!1,this.gisInitialized=!1,this.signInResolver=null,this.signInRejecter=null,this.authState=this.authStateSignal.asReadonly(),this.isInitialized=zt(()=>this.authStateSignal().isInitialized),this.isSignedIn=zt(()=>this.authStateSignal().isSignedIn),this.userEmail=zt(()=>this.authStateSignal().userEmail),this.loadStoredToken()}getGapi(){return window.gapi}getGoogle(){return window.google}loadStoredToken(){let e=this.storage.get(this.TOKEN_KEY),s=this.storage.get(this.TOKEN_EXPIRY_KEY);if(e&&s){let i=new Date(s);i>new Date?this.authStateSignal.update(c=>V(C({},c),{accessToken:e,tokenExpiry:i,isSignedIn:!0})):this.clearStoredToken()}}storeToken(e,s){let i=new Date(Date.now()+s*1e3);this.storage.set(this.TOKEN_KEY,e),this.storage.set(this.TOKEN_EXPIRY_KEY,i.toISOString())}clearStoredToken(){this.storage.remove(this.TOKEN_KEY),this.storage.remove(this.TOKEN_EXPIRY_KEY)}initialize(e){return S(this,null,function*(){if(!e)throw new Error("Google Client ID is required");try{yield this.loadGapiClient(),yield this.loadGisClient(e);let s=this.authStateSignal().accessToken;s&&this.getGapi()?.client&&this.getGapi().client.setToken({access_token:s}),this.authStateSignal.update(i=>V(C({},i),{isInitialized:!0}))}catch(s){throw console.error("Failed to initialize Google Calendar:",s),s}})}loadGapiClient(){return S(this,null,function*(){if(!this.gapiInitialized)return new Promise((e,s)=>{if(typeof gapi>"u"){let i=document.createElement("script");i.src="https://apis.google.com/js/api.js",i.onload=()=>{let c=window.gapi;c.load("client",()=>S(this,null,function*(){try{yield c.client.init({discoveryDocs:[this.DISCOVERY_DOC]}),this.gapiInitialized=!0,e()}catch(u){s(u)}}))},i.onerror=s,document.body.appendChild(i)}else{let i=gapi;i.load("client",()=>S(this,null,function*(){try{yield i.client.init({discoveryDocs:[this.DISCOVERY_DOC]}),this.gapiInitialized=!0,e()}catch(c){s(c)}}))}})})}loadGisClient(e){return S(this,null,function*(){if(!this.gisInitialized)return new Promise((s,i)=>{if(typeof google>"u"||!google?.accounts){let c=document.createElement("script");c.src="https://accounts.google.com/gsi/client",c.onload=()=>{this.initializeTokenClient(e),this.gisInitialized=!0,s()},c.onerror=i,document.body.appendChild(c)}else this.initializeTokenClient(e),this.gisInitialized=!0,s()})})}initializeTokenClient(e){let s=window.google;this.tokenClient=s.accounts.oauth2.initTokenClient({client_id:e,scope:this.SCOPES,callback:i=>{this.ngZone.run(()=>{if(i.error){console.error("OAuth error:",i.error,i.error_description),this.signInRejecter&&(this.signInRejecter(new Error(i.error_description||i.error)),this.signInRejecter=null,this.signInResolver=null);return}let c=i.access_token,u=i.expires_in||3600;this.storeToken(c,u),this.getGapi().client.setToken({access_token:c}),this.authStateSignal.update(m=>V(C({},m),{accessToken:c,tokenExpiry:new Date(Date.now()+u*1e3),isSignedIn:!0})),this.fetchUserEmail(),this.signInResolver&&(this.signInResolver(),this.signInResolver=null,this.signInRejecter=null)})},error_callback:i=>{this.ngZone.run(()=>{console.error("OAuth error callback:",i),this.signInRejecter&&(this.signInRejecter(new Error(i.message||"OAuth error")),this.signInRejecter=null,this.signInResolver=null)})}})}fetchUserEmail(){return S(this,null,function*(){try{let s=yield(yield fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${this.authStateSignal().accessToken}`}})).json();this.authStateSignal.update(i=>V(C({},i),{userEmail:s.email}))}catch(e){console.error("Failed to fetch user email:",e)}})}signIn(){return S(this,null,function*(){if(!this.tokenClient)throw new Error("Google Calendar not initialized. Call initialize() first.");let e=this.authStateSignal();if(e.accessToken&&e.tokenExpiry&&e.tokenExpiry>new Date){this.getGapi().client.setToken({access_token:e.accessToken});return}return new Promise((s,i)=>{this.signInResolver=s,this.signInRejecter=i;try{this.tokenClient.requestAccessToken({prompt:""})}catch(c){this.signInResolver=null,this.signInRejecter=null,i(c)}})})}signOut(){let e=this.authStateSignal().accessToken;e&&this.getGoogle().accounts.oauth2.revoke(e),this.getGapi().client.setToken(null),this.clearStoredToken(),this.authStateSignal.update(s=>V(C({},s),{accessToken:null,tokenExpiry:null,isSignedIn:!1,userEmail:null}))}listCalendars(){return this.isSignedIn()?!this.gapiInitialized||!this.getGapi()?.client?.calendar?Zt(()=>new Error("Google API not initialized")):$e(this.getGapi().client.calendar.calendarList.list()).pipe(te(e=>(e.result.items||[]).map(i=>({id:i.id,summary:i.summary,description:i.description,primary:i.primary||!1,backgroundColor:i.backgroundColor,foregroundColor:i.foregroundColor,accessRole:i.accessRole,selected:i.primary||!1}))),Ge(e=>(console.error("Failed to list calendars:",e),(e.status===401||e.result?.error?.code===401)&&(this.clearStoredToken(),this.authStateSignal.update(s=>V(C({},s),{accessToken:null,tokenExpiry:null,isSignedIn:!1}))),Zt(()=>e)))):Zt(()=>new Error("Not signed in"))}fetchCalendarEvents(e,s){return this.isSignedIn()?!this.gapiInitialized||!this.getGapi()?.client?.calendar?Zt(()=>new Error("Google API not initialized")):$e(this.getGapi().client.calendar.events.list({calendarId:e,timeMin:s.start.toISOString(),timeMax:s.end.toISOString(),singleEvents:!0,orderBy:"startTime",maxResults:2500})).pipe(te(i=>(i.result.items||[]).map(u=>this.parseGoogleEvent(u,e))),te(i=>this.eventProcessor.processEvents(i)),Ge(i=>(console.error(`Failed to fetch events from ${e}:`,i),(i.status===401||i.result?.error?.code===401)&&(this.clearStoredToken(),this.authStateSignal.update(c=>V(C({},c),{accessToken:null,tokenExpiry:null,isSignedIn:!1}))),N([])))):Zt(()=>new Error("Not signed in"))}fetchEventsFromCalendars(e,s){if(e.length===0)return N([]);let i=e.map(c=>this.fetchCalendarEvents(c,s));return $e(Promise.all(i.map(c=>c.toPromise()))).pipe(te(c=>c.flat().filter(m=>m!==void 0).sort((m,E)=>m.start.getTime()-E.start.getTime())))}parseGoogleEvent(e,s){let i=!e.start.dateTime,c=i?new Date(e.start.date+"T00:00:00"):new Date(e.start.dateTime),u=i?new Date(e.end.date+"T23:59:59"):new Date(e.end.dateTime);return{id:e.id,calendarId:s,title:e.summary||"(No title)",description:e.description,location:e.location,start:c,end:u,allDay:i,recurringEventId:e.recurringEventId,status:e.status||"confirmed"}}getDefaultDateRange(){let e=new Date,s=new Date(e.getFullYear(),e.getMonth()-1,1),i=new Date(e.getFullYear(),e.getMonth()+2,0);return{start:s,end:i}}waitForApiInitialization(e=1e4){return this.gapiInitialized&&this.getGapi()?.client?.calendar?N(!0):Ji(0,100).pipe(te(()=>this.gapiInitialized&&this.getGapi()?.client?.calendar),Xi(s=>!!s),Zi(1),Yi(e),Ge(()=>N(!1)))}getEventById(e,s){return this.isSignedIn()?this.waitForApiInitialization().pipe(to(i=>i?$e(this.getGapi().client.calendar.events.get({calendarId:e,eventId:s})).pipe(te(c=>{let u=c.result;return this.parseGoogleEvent(u,e)}),Ge(c=>(console.error(`Failed to fetch event ${s}:`,c),c.status===404?N(null):((c.status===401||c.result?.error?.code===401)&&(this.clearStoredToken(),this.authStateSignal.update(u=>V(C({},u),{accessToken:null,tokenExpiry:null,isSignedIn:!1}))),N(null))))):(console.warn("Google API initialization timed out"),N(null)))):Zt(()=>new Error("Not signed in"))}needsTokenRefresh(){let e=this.authStateSignal();if(!e.tokenExpiry)return!0;let s=new Date(Date.now()+5*60*1e3);return e.tokenExpiry<s}refreshToken(){return S(this,null,function*(){this.tokenClient&&this.tokenClient.requestAccessToken({prompt:""})})}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var em=(()=>{class r{constructor(){this.STORAGE_KEY="pet-genie-theme",this.currentTheme=ft(this.getStoredTheme()),this.isDarkMode=ft(!1),no(()=>{this.applyTheme(this.currentTheme())},{allowSignalWrites:!0}),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{this.currentTheme()==="system"&&this.applyTheme("system")}),this.applyTheme(this.currentTheme())}setTheme(e){this.currentTheme.set(e),localStorage.setItem(this.STORAGE_KEY,e)}toggleTheme(){let e=this.currentTheme();e==="light"?this.setTheme("dark"):e==="dark"?this.setTheme("system"):this.setTheme("light")}getStoredTheme(){if(typeof localStorage>"u")return"system";let e=localStorage.getItem(this.STORAGE_KEY);return e==="light"||e==="dark"||e==="system"?e:"system"}applyTheme(e){if(typeof document>"u")return;let s=!1;e==="system"?s=window.matchMedia("(prefers-color-scheme: dark)").matches:s=e==="dark",this.isDarkMode.set(s),s?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.removeAttribute("data-theme")}getThemeIcon(){switch(this.currentTheme()){case"light":return"light_mode";case"dark":return"dark_mode";case"system":return"brightness_auto"}}getThemeLabel(){switch(this.currentTheme()){case"light":return"Light";case"dark":return"Dark";case"system":return"System"}}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var am=(()=>{class r{constructor(){this.storage=It(Tt),this.STORAGE_KEY="clients",this.clientsSubject=new he([]),this.clients$=this.clientsSubject.asObservable(),this.loadClients()}getAll(){return N(this.clientsSubject.value)}getById(e){let s=this.clientsSubject.value.find(i=>i.id===e);return N(s||null)}create(e){let s=new Date,i=V(C({id:this.generateId()},e),{createdAt:s,updatedAt:s}),c=[...this.clientsSubject.value,i];return this.saveClients(c),N(i)}update(e){let s=this.clientsSubject.value,i=s.findIndex(m=>m.id===e.id);if(i===-1)return N(null);let c=V(C(C({},s[i]),e),{updatedAt:new Date}),u=[...s];return u[i]=c,this.saveClients(u),N(c)}delete(e){let s=this.clientsSubject.value.filter(i=>i.id!==e);return this.saveClients(s),N(!0)}searchByName(e){let s=e.toLowerCase(),i=this.clientsSubject.value.filter(c=>c.name.toLowerCase().includes(s));return N(i)}loadClients(){let s=(this.storage.get(this.STORAGE_KEY)||[]).map(i=>V(C({},i),{createdAt:new Date(i.createdAt),updatedAt:new Date(i.updatedAt)}));this.clientsSubject.next(s)}saveClients(e){this.storage.set(this.STORAGE_KEY,e),this.clientsSubject.next(e)}generateId(){return`client_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var mm=(()=>{class r{constructor(){this.storage=It(Tt),this.STORAGE_KEY="pets",this.petsSubject=new he([]),this.pets$=this.petsSubject.asObservable(),this.loadPets()}getAll(){return N(this.petsSubject.value)}getById(e){let s=this.petsSubject.value.find(i=>i.id===e);return N(s||null)}getByClientId(e){let s=this.petsSubject.value.filter(i=>i.clientId===e);return N(s)}create(e){let s=new Date,i=V(C({id:this.generateId()},e),{createdAt:s,updatedAt:s}),c=[...this.petsSubject.value,i];return this.savePets(c),N(i)}update(e){let s=this.petsSubject.value,i=s.findIndex(m=>m.id===e.id);if(i===-1)return N(null);let c=V(C(C({},s[i]),e),{updatedAt:new Date}),u=[...s];return u[i]=c,this.savePets(u),N(c)}delete(e){let s=this.petsSubject.value.filter(i=>i.id!==e);return this.savePets(s),N(!0)}searchByName(e){let s=e.toLowerCase(),i=this.petsSubject.value.filter(c=>c.name.toLowerCase().includes(s));return N(i)}loadPets(){let s=(this.storage.get(this.STORAGE_KEY)||[]).map(i=>V(C({},i),{createdAt:new Date(i.createdAt),updatedAt:new Date(i.updatedAt)}));this.petsSubject.next(s)}savePets(e){this.storage.set(this.STORAGE_KEY,e),this.petsSubject.next(e)}generateId(){return`pet_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Em=(()=>{class r{constructor(){this.storage=It(Tt),this.STORAGE_KEY="visit_records",this.visitRecordsSubject=new he([]),this.visitRecords$=this.visitRecordsSubject.asObservable(),this.loadVisitRecords()}getAll(){return N(this.visitRecordsSubject.value)}getById(e){let s=this.visitRecordsSubject.value.find(i=>i.id===e);return N(s||null)}getByEventId(e,s){let i=this.visitRecordsSubject.value.find(c=>c.eventId===e&&c.calendarId===s);return N(i||null)}getByClientId(e){let s=this.visitRecordsSubject.value.filter(i=>i.clientId===e);return N(s)}getByStatus(e){let s=this.visitRecordsSubject.value.filter(i=>i.status===e);return N(s)}getByDateRange(e,s){let i=this.visitRecordsSubject.value.filter(c=>{let u=new Date(c.createdAt);return u>=e&&u<=s});return N(i)}create(e){let s=new Date,i=V(C({id:this.generateId(),status:e.status||"scheduled"},e),{createdAt:s,updatedAt:s}),c=[...this.visitRecordsSubject.value,i];return this.saveVisitRecords(c),N(i)}update(e){let s=this.visitRecordsSubject.value,i=s.findIndex(m=>m.id===e.id);if(i===-1)return N(null);let c=V(C(C({},s[i]),e),{updatedAt:new Date}),u=[...s];return u[i]=c,this.saveVisitRecords(u),N(c)}checkIn(e){return this.update({id:e.id,status:"in-progress",checkInAt:e.checkInAt})}checkOut(e){return this.update({id:e.id,status:"completed",checkOutAt:e.checkOutAt,notes:e.notes})}delete(e){let s=this.visitRecordsSubject.value.filter(i=>i.id!==e);return this.saveVisitRecords(s),N(!0)}linkClient(e,s,i){let c=this.visitRecordsSubject.value.find(u=>u.eventId===e&&u.calendarId===s);return c?this.update({id:c.id,clientId:i}):this.create({eventId:e,calendarId:s,clientId:i,status:"scheduled"})}unlinkClient(e,s){let i=this.visitRecordsSubject.value.find(c=>c.eventId===e&&c.calendarId===s);return i?this.update({id:i.id,clientId:void 0}):N(null)}loadVisitRecords(){let s=(this.storage.get(this.STORAGE_KEY)||[]).map(i=>V(C({},i),{createdAt:new Date(i.createdAt),updatedAt:new Date(i.updatedAt),checkInAt:i.checkInAt?new Date(i.checkInAt):void 0,checkOutAt:i.checkOutAt?new Date(i.checkOutAt):void 0,lastSummarySentAt:i.lastSummarySentAt?new Date(i.lastSummarySentAt):void 0}));this.visitRecordsSubject.next(s)}saveVisitRecords(e){this.storage.set(this.STORAGE_KEY,e),this.visitRecordsSubject.next(e)}generateId(){return`visit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var bm=(()=>{class r{generateSummary(e,s,i,c){let u=[];return u.push(this.generateHeader(e,i)),u.push(""),u.push(this.generateVisitDetails(e,s)),u.push(""),c.length>0&&(u.push(this.generatePetsSection(c)),u.push("")),s.notes&&(u.push(this.generateNotesSection(s.notes)),u.push("")),u.push(this.generateFooter(s)),u.join(`
`)}generateShortSummary(e,s,i){let c=e.serviceInfo?.type||"visit",u=i.map(E=>E.name).join(", "),m=this.calculateDuration(e.start,e.end);return`${c} for ${s.name}${u?` (${u})`:""} - ${m}`}generateEmailSummary(e,s,i,c){return this.generateSummary(e,s,i,c).split(`
`).map(m=>m.startsWith("===")?"<hr>":m.startsWith("VISIT SUMMARY")||m.startsWith("PETS:")||m.startsWith("VISIT NOTES:")?`<h3>${m}</h3>`:m.trim()===""?"<br>":`<p>${m}</p>`).join(`
`)}generateHeader(e,s){let i=[];return i.push("==================================="),i.push("VISIT SUMMARY"),i.push("==================================="),i.push(`Client: ${s.name}`),i.push(`Service: ${this.formatServiceType(e.serviceInfo?.type||"other")}`),i.join(`
`)}generateVisitDetails(e,s){let i=[];i.push(`Date: ${this.formatDate(e.start)}`),i.push(`Scheduled: ${this.formatTime(e.start)} - ${this.formatTime(e.end)}`),s.checkInAt&&i.push(`Check-in: ${this.formatTime(s.checkInAt)}`),s.checkOutAt&&i.push(`Check-out: ${this.formatTime(s.checkOutAt)}`);let c=this.calculateDuration(e.start,e.end);return i.push(`Duration: ${c}`),e.location&&i.push(`Location: ${e.location}`),i.push(`Status: ${this.formatStatus(s.status)}`),i.join(`
`)}generatePetsSection(e){let s=[];return s.push("PETS:"),e.forEach(i=>{let c=[`  \u2022 ${i.name}`];if(i.species||i.breed){let u=[];i.species&&u.push(i.species),i.breed&&u.push(i.breed),c.push(` (${u.join(", ")})`)}s.push(c.join("")),i.specialNeeds&&s.push(`    Special needs: ${i.specialNeeds}`),i.medications&&i.medications.length>0&&s.push(`    Medications: ${i.medications.map(u=>u.name).join(", ")}`)}),s.join(`
`)}generateNotesSection(e){let s=[];return s.push("VISIT NOTES:"),e.split(`
`).forEach(c=>{s.push(`  ${c}`)}),s.join(`
`)}generateFooter(e){let s=[];return s.push("==================================="),s.push(`Generated: ${this.formatDateTime(new Date)}`),e.lastSummarySentAt&&s.push(`Last sent: ${this.formatDateTime(e.lastSummarySentAt)}`),s.join(`
`)}formatServiceType(e){return{"drop-in":"Drop-in Visit",walk:"Dog Walk",overnight:"Overnight Care",housesit:"House Sitting","meet-greet":"Meet & Greet","nail-trim":"Nail Trim",other:"Pet Care"}[e]||e}formatStatus(e){return{scheduled:"Scheduled","in-progress":"In Progress",completed:"Completed",cancelled:"Cancelled"}[e]||e}formatDate(e){return e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}formatTime(e){return e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}formatDateTime(e){return e.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}calculateDuration(e,s){let i=s.getTime()-e.getTime(),c=Math.floor(i/6e4),u=Math.floor(c/60),m=c%60;return u>0?m>0?`${u}h ${m}m`:`${u}h`:`${c}m`}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Rn={production:!0,firebase:{apiKey:"AIzaSyDYA9khbP7M02swa0xQM4yWFZouhihIUlo",authDomain:"gps-admin-477717.firebaseapp.com",projectId:"gps-admin-477717",storageBucket:"gps-admin-477717.firebasestorage.app",messagingSenderId:"766196805611",appId:"1:766196805611:web:a63d0f5cd5fea2029673ae",measurementId:"G-ZZP162C6MZ"},googleClientId:"766196805611-h28run6kbm1jkvipg66n95m7er2uau09.apps.googleusercontent.com"};var _o=()=>{};var Eo=function(r){let t=[],e=0;for(let s=0;s<r.length;s++){let i=r.charCodeAt(s);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&s+1<r.length&&(r.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++s)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},nu=function(r){let t=[],e=0,s=0;for(;e<r.length;){let i=r[e++];if(i<128)t[s++]=String.fromCharCode(i);else if(i>191&&i<224){let c=r[e++];t[s++]=String.fromCharCode((i&31)<<6|c&63)}else if(i>239&&i<365){let c=r[e++],u=r[e++],m=r[e++],E=((i&7)<<18|(c&63)<<12|(u&63)<<6|m&63)-65536;t[s++]=String.fromCharCode(55296+(E>>10)),t[s++]=String.fromCharCode(56320+(E&1023))}else{let c=r[e++],u=r[e++];t[s++]=String.fromCharCode((i&15)<<12|(c&63)<<6|u&63)}}return t.join("")},To={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();let e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<r.length;i+=3){let c=r[i],u=i+1<r.length,m=u?r[i+1]:0,E=i+2<r.length,T=E?r[i+2]:0,R=c>>2,b=(c&3)<<4|m>>4,A=(m&15)<<2|T>>6,O=T&63;E||(O=64,u||(A=64)),s.push(e[R],e[b],e[A],e[O])}return s.join("")},encodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(Eo(r),t)},decodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):nu(this.decodeStringToByteArray(r,t))},decodeStringToByteArray(r,t){this.init_();let e=t?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<r.length;){let c=e[r.charAt(i++)],m=i<r.length?e[r.charAt(i)]:0;++i;let T=i<r.length?e[r.charAt(i)]:64;++i;let b=i<r.length?e[r.charAt(i)]:64;if(++i,c==null||m==null||T==null||b==null)throw new Lr;let A=c<<2|m>>4;if(s.push(A),T!==64){let O=m<<4&240|T>>2;if(s.push(O),b!==64){let x=T<<6&192|b;s.push(x)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}},Lr=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},ru=function(r){let t=Eo(r);return To.encodeByteArray(t,!0)},Ye=function(r){return ru(r).replace(/\./g,"")},vo=function(r){try{return To.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function bo(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var su=()=>bo().__FIREBASE_DEFAULTS__,iu=()=>{if(typeof process>"u"||typeof process.env>"u")return;let r=process.env.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},ou=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let t=r&&vo(r[1]);return t&&JSON.parse(t)},Ao=()=>{try{return _o()||su()||iu()||ou()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},au=r=>Ao()?.emulatorHosts?.[r],So=r=>{let t=au(r);if(!t)return;let e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);let s=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),s]:[t.substring(0,e),s]},Br=()=>Ao()?.config;var Pn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,s)=>{e?this.reject(e):this.resolve(s),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,s))}}};function Cn(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}function Ro(r){return S(this,null,function*(){return(yield fetch(r,{credentials:"include"})).ok})}function Po(r,t){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let e={alg:"none",type:"JWT"},s=t||"demo-project",i=r.iat||0,c=r.sub||r.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let u=C({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Ye(JSON.stringify(e)),Ye(JSON.stringify(u)),""].join(".")}var Qe={};function cu(){let r={prod:[],emulator:[]};for(let t of Object.keys(Qe))Qe[t]?r.emulator.push(t):r.prod.push(t);return r}function uu(r){let t=document.getElementById(r),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",r),e=!0),{created:e,element:t}}var wo=!1;function Co(r,t){if(typeof window>"u"||typeof document>"u"||!Cn(window.location.host)||Qe[r]===t||Qe[r]||wo)return;Qe[r]=t;function e(A){return`__firebase__banner__${A}`}let s="__firebase__banner",c=cu().prod.length>0;function u(){let A=document.getElementById(s);A&&A.remove()}function m(A){A.style.display="flex",A.style.background="#7faaf0",A.style.position="fixed",A.style.bottom="5px",A.style.left="5px",A.style.padding=".5em",A.style.borderRadius="5px",A.style.alignItems="center"}function E(A,O){A.setAttribute("width","24"),A.setAttribute("id",O),A.setAttribute("height","24"),A.setAttribute("viewBox","0 0 24 24"),A.setAttribute("fill","none"),A.style.marginLeft="-6px"}function T(){let A=document.createElement("span");return A.style.cursor="pointer",A.style.marginLeft="16px",A.style.fontSize="24px",A.innerHTML=" &times;",A.onclick=()=>{wo=!0,u()},A}function R(A,O){A.setAttribute("id",O),A.innerText="Learn more",A.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",A.setAttribute("target","__blank"),A.style.paddingLeft="5px",A.style.textDecoration="underline"}function b(){let A=uu(s),O=e("text"),x=document.getElementById(O)||document.createElement("span"),M=e("learnmore"),q=document.getElementById(M)||document.createElement("a"),Y=e("preprendIcon"),J=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(A.created){let tt=A.element;m(tt),R(q,M);let mt=T();E(J,Y),tt.append(J,x,q,mt),document.body.appendChild(tt)}c?(x.innerText="Preview backend disconnected.",J.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(J.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}function Do(){let r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function Je(){try{return typeof indexedDB=="object"}catch{return!1}}function Dn(){return new Promise((r,t)=>{try{let e=!0,s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(s),r(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}function xo(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}var lu="FirebaseError",ht=class r extends Error{constructor(t,e,s){super(e),this.code=t,this.customData=s,this.name=lu,Object.setPrototypeOf(this,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ct.prototype.create)}},Ct=class{constructor(t,e,s){this.service=t,this.serviceName=e,this.errors=s}create(t,...e){let s=e[0]||{},i=`${this.service}/${t}`,c=this.errors[t],u=c?hu(c,s):"Error",m=`${this.serviceName}: ${u} (${i}).`;return new ht(i,m,s)}};function hu(r,t){return r.replace(du,(e,s)=>{let i=t[s];return i!=null?String(i):`<${s}?>`})}var du=/\{\$([^}]+)}/g;function Dt(r,t){if(r===t)return!0;let e=Object.keys(r),s=Object.keys(t);for(let i of e){if(!s.includes(i))return!1;let c=r[i],u=t[i];if(Io(c)&&Io(u)){if(!Dt(c,u))return!1}else if(c!==u)return!1}for(let i of s)if(!e.includes(i))return!1;return!0}function Io(r){return r!==null&&typeof r=="object"}var fu=1e3,mu=2,pu=4*60*60*1e3,gu=.5;function Ur(r,t=fu,e=mu){let s=t*Math.pow(e,r),i=Math.round(gu*s*(Math.random()-.5)*2);return Math.min(pu,s+i)}function ee(r){return r&&r._delegate?r._delegate:r}var it=class{constructor(t,e,s){this.name=t,this.instanceFactory=e,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}};var ne="[DEFAULT]";var qr=class{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){let e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){let s=new Pn;if(this.instancesDeferred.set(e,s),this.isInitialized(e)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:e});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){let e=this.normalizeInstanceIdentifier(t?.identifier),s=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(_u(t))try{this.getOrInitializeService({instanceIdentifier:ne})}catch{}for(let[e,s]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(e);try{let c=this.getOrInitializeService({instanceIdentifier:i});s.resolve(c)}catch{}}}}clearInstance(t=ne){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){return S(this,null,function*(){let t=Array.from(this.instances.values());yield Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])})}isComponentSet(){return this.component!=null}isInitialized(t=ne){return this.instances.has(t)}getOptions(t=ne){return this.instancesOptions.get(t)||{}}initialize(t={}){let{options:e={}}=t,s=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:s,options:e});for(let[c,u]of this.instancesDeferred.entries()){let m=this.normalizeInstanceIdentifier(c);s===m&&u.resolve(i)}return i}onInit(t,e){let s=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(s)??new Set;i.add(t),this.onInitCallbacks.set(s,i);let c=this.instances.get(s);return c&&t(c,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){let s=this.onInitCallbacks.get(e);if(s)for(let i of s)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let s=this.instances.get(t);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:yu(t),options:e}),this.instances.set(t,s),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(s,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,s)}catch{}return s||null}normalizeInstanceIdentifier(t=ne){return this.component?this.component.multipleInstances?t:ne:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function yu(r){return r===ne?void 0:r}function _u(r){return r.instantiationMode==="EAGER"}var xn=class{constructor(t){this.name=t,this.providers=new Map}addComponent(t){let e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);let e=new qr(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}};var wu=[],B=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(B||{}),Iu={debug:B.DEBUG,verbose:B.VERBOSE,info:B.INFO,warn:B.WARN,error:B.ERROR,silent:B.SILENT},Eu=B.INFO,Tu={[B.DEBUG]:"log",[B.VERBOSE]:"log",[B.INFO]:"info",[B.WARN]:"warn",[B.ERROR]:"error"},vu=(r,t,...e)=>{if(t<r.logLevel)return;let s=new Date().toISOString(),i=Tu[t];if(i)console[i](`[${s}]  ${r.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)},$t=class{constructor(t){this.name=t,this._logLevel=Eu,this._logHandler=vu,this._userLogHandler=null,wu.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in B))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Iu[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,B.DEBUG,...t),this._logHandler(this,B.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,B.VERBOSE,...t),this._logHandler(this,B.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,B.INFO,...t),this._logHandler(this,B.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,B.WARN,...t),this._logHandler(this,B.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,B.ERROR,...t),this._logHandler(this,B.ERROR,...t)}};var bu=(r,t)=>t.some(e=>r instanceof e),Vo,ko;function Au(){return Vo||(Vo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Su(){return ko||(ko=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var No=new WeakMap,zr=new WeakMap,Oo=new WeakMap,jr=new WeakMap,Gr=new WeakMap;function Ru(r){let t=new Promise((e,s)=>{let i=()=>{r.removeEventListener("success",c),r.removeEventListener("error",u)},c=()=>{e(vt(r.result)),i()},u=()=>{s(r.error),i()};r.addEventListener("success",c),r.addEventListener("error",u)});return t.then(e=>{e instanceof IDBCursor&&No.set(e,r)}).catch(()=>{}),Gr.set(t,r),t}function Pu(r){if(zr.has(r))return;let t=new Promise((e,s)=>{let i=()=>{r.removeEventListener("complete",c),r.removeEventListener("error",u),r.removeEventListener("abort",u)},c=()=>{e(),i()},u=()=>{s(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",c),r.addEventListener("error",u),r.addEventListener("abort",u)});zr.set(r,t)}var $r={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return zr.get(r);if(t==="objectStoreNames")return r.objectStoreNames||Oo.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return vt(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function Mo(r){$r=r($r)}function Cu(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){let s=r.call(Vn(this),t,...e);return Oo.set(s,t.sort?t.sort():[t]),vt(s)}:Su().includes(r)?function(...t){return r.apply(Vn(this),t),vt(No.get(this))}:function(...t){return vt(r.apply(Vn(this),t))}}function Du(r){return typeof r=="function"?Cu(r):(r instanceof IDBTransaction&&Pu(r),bu(r,Au())?new Proxy(r,$r):r)}function vt(r){if(r instanceof IDBRequest)return Ru(r);if(jr.has(r))return jr.get(r);let t=Du(r);return t!==r&&(jr.set(r,t),Gr.set(t,r)),t}var Vn=r=>Gr.get(r);function Lo(r,t,{blocked:e,upgrade:s,blocking:i,terminated:c}={}){let u=indexedDB.open(r,t),m=vt(u);return s&&u.addEventListener("upgradeneeded",E=>{s(vt(u.result),E.oldVersion,E.newVersion,vt(u.transaction),E)}),e&&u.addEventListener("blocked",E=>e(E.oldVersion,E.newVersion,E)),m.then(E=>{c&&E.addEventListener("close",()=>c()),i&&E.addEventListener("versionchange",T=>i(T.oldVersion,T.newVersion,T))}).catch(()=>{}),m}var xu=["get","getKey","getAll","getAllKeys","count"],Vu=["put","add","delete","clear"],Kr=new Map;function Fo(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(Kr.get(t))return Kr.get(t);let e=t.replace(/FromIndex$/,""),s=t!==e,i=Vu.includes(e);if(!(e in(s?IDBIndex:IDBObjectStore).prototype)||!(i||xu.includes(e)))return;let c=function(u,...m){return S(this,null,function*(){let E=this.transaction(u,i?"readwrite":"readonly"),T=E.store;return s&&(T=T.index(m.shift())),(yield Promise.all([T[e](...m),i&&E.done]))[0]})};return Kr.set(t,c),c}Mo(r=>V(C({},r),{get:(t,e,s)=>Fo(t,e)||r.get(t,e,s),has:(t,e)=>!!Fo(t,e)||r.has(t,e)}));var Wr=class{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(ku(e)){let s=e.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(e=>e).join(" ")}};function ku(r){return r.getComponent()?.type==="VERSION"}var Qr="@firebase/app",Bo="0.14.7";var xt=new $t("@firebase/app"),Nu="@firebase/app-compat",Ou="@firebase/analytics-compat",Mu="@firebase/analytics",Fu="@firebase/app-check-compat",Lu="@firebase/app-check",Bu="@firebase/auth",Uu="@firebase/auth-compat",qu="@firebase/database",ju="@firebase/data-connect",zu="@firebase/database-compat",$u="@firebase/functions",Gu="@firebase/functions-compat",Ku="@firebase/installations",Hu="@firebase/installations-compat",Wu="@firebase/messaging",Qu="@firebase/messaging-compat",Yu="@firebase/performance",Ju="@firebase/performance-compat",Xu="@firebase/remote-config",Zu="@firebase/remote-config-compat",tl="@firebase/storage",el="@firebase/storage-compat",nl="@firebase/firestore",rl="@firebase/ai",sl="@firebase/firestore-compat",il="firebase",ol="12.8.0";var Yr="[DEFAULT]",al={[Qr]:"fire-core",[Nu]:"fire-core-compat",[Mu]:"fire-analytics",[Ou]:"fire-analytics-compat",[Lu]:"fire-app-check",[Fu]:"fire-app-check-compat",[Bu]:"fire-auth",[Uu]:"fire-auth-compat",[qu]:"fire-rtdb",[ju]:"fire-data-connect",[zu]:"fire-rtdb-compat",[$u]:"fire-fn",[Gu]:"fire-fn-compat",[Ku]:"fire-iid",[Hu]:"fire-iid-compat",[Wu]:"fire-fcm",[Qu]:"fire-fcm-compat",[Yu]:"fire-perf",[Ju]:"fire-perf-compat",[Xu]:"fire-rc",[Zu]:"fire-rc-compat",[tl]:"fire-gcs",[el]:"fire-gcs-compat",[nl]:"fire-fst",[sl]:"fire-fst-compat",[rl]:"fire-vertex","fire-js":"fire-js",[il]:"fire-js-all"};var kn=new Map,cl=new Map,Jr=new Map;function Uo(r,t){try{r.container.addComponent(t)}catch(e){xt.debug(`Component ${t.name} failed to register with FirebaseApp ${r.name}`,e)}}function gt(r){let t=r.name;if(Jr.has(t))return xt.debug(`There were multiple attempts to register component ${t}.`),!1;Jr.set(t,r);for(let e of kn.values())Uo(e,r);for(let e of cl.values())Uo(e,r);return!0}function Kt(r,t){let e=r.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),r.container.getProvider(t)}function $o(r){return r==null?!1:r.settings!==void 0}var ul={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gt=new Ct("app","Firebase",ul);var Xr=class{constructor(t,e,s){this._isDeleted=!1,this._options=C({},t),this._config=C({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new it("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Gt.create("app-deleted",{appName:this._name})}};var Go=ol;function es(r,t={}){let e=r;typeof t!="object"&&(t={name:t});let s=C({name:Yr,automaticDataCollectionEnabled:!0},t),i=s.name;if(typeof i!="string"||!i)throw Gt.create("bad-app-name",{appName:String(i)});if(e||(e=Br()),!e)throw Gt.create("no-options");let c=kn.get(i);if(c){if(Dt(e,c.options)&&Dt(s,c.config))return c;throw Gt.create("duplicate-app",{appName:i})}let u=new xn(i);for(let E of Jr.values())u.addComponent(E);let m=new Xr(e,s,u);return kn.set(i,m),m}function Ze(r=Yr){let t=kn.get(r);if(!t&&r===Yr&&Br())return es();if(!t)throw Gt.create("no-app",{appName:r});return t}function ut(r,t,e){let s=al[r]??r;e&&(s+=`-${e}`);let i=s.match(/\s|\//),c=t.match(/\s|\//);if(i||c){let u=[`Unable to register library "${s}" with version "${t}":`];i&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&c&&u.push("and"),c&&u.push(`version name "${t}" contains illegal characters (whitespace or "/")`),xt.warn(u.join(" "));return}gt(new it(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}var ll="firebase-heartbeat-database",hl=1,Xe="firebase-heartbeat-store",Hr=null;function Ko(){return Hr||(Hr=Lo(ll,hl,{upgrade:(r,t)=>{switch(t){case 0:try{r.createObjectStore(Xe)}catch(e){console.warn(e)}}}}).catch(r=>{throw Gt.create("idb-open",{originalErrorMessage:r.message})})),Hr}function dl(r){return S(this,null,function*(){try{let e=(yield Ko()).transaction(Xe),s=yield e.objectStore(Xe).get(Ho(r));return yield e.done,s}catch(t){if(t instanceof ht)xt.warn(t.message);else{let e=Gt.create("idb-get",{originalErrorMessage:t?.message});xt.warn(e.message)}}})}function qo(r,t){return S(this,null,function*(){try{let s=(yield Ko()).transaction(Xe,"readwrite");yield s.objectStore(Xe).put(t,Ho(r)),yield s.done}catch(e){if(e instanceof ht)xt.warn(e.message);else{let s=Gt.create("idb-set",{originalErrorMessage:e?.message});xt.warn(s.message)}}})}function Ho(r){return`${r.name}!${r.options.appId}`}var fl=1024,ml=30,Zr=class{constructor(t){this.container=t,this._heartbeatsCache=null;let e=this.container.getProvider("app").getImmediate();this._storage=new ts(e),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}triggerHeartbeat(){return S(this,null,function*(){try{let e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=jo();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:e}),this._heartbeatsCache.heartbeats.length>ml){let i=gl(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){xt.warn(t)}})}getHeartbeatsHeader(){return S(this,null,function*(){try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=jo(),{heartbeatsToSend:e,unsentEntries:s}=pl(this._heartbeatsCache.heartbeats),i=Ye(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return xt.warn(t),""}})}};function jo(){return new Date().toISOString().substring(0,10)}function pl(r,t=fl){let e=[],s=r.slice();for(let i of r){let c=e.find(u=>u.agent===i.agent);if(c){if(c.dates.push(i.date),zo(e)>t){c.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),zo(e)>t){e.pop();break}s=s.slice(1)}return{heartbeatsToSend:e,unsentEntries:s}}var ts=class{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return S(this,null,function*(){return Je()?Dn().then(()=>!0).catch(()=>!1):!1})}read(){return S(this,null,function*(){if(yield this._canUseIndexedDBPromise){let e=yield dl(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(t){return S(this,null,function*(){if(yield this._canUseIndexedDBPromise){let s=yield this.read();return qo(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return})}add(t){return S(this,null,function*(){if(yield this._canUseIndexedDBPromise){let s=yield this.read();return qo(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return})}};function zo(r){return Ye(JSON.stringify({version:2,heartbeats:r})).length}function gl(r){if(r.length===0)return-1;let t=0,e=r[0].date;for(let s=1;s<r.length;s++)r[s].date<e&&(e=r[s].date,t=s);return t}function yl(r){gt(new it("platform-logger",t=>new Wr(t),"PRIVATE")),gt(new it("heartbeat",t=>new Zr(t),"PRIVATE")),ut(Qr,Bo,r),ut(Qr,Bo,"esm2020"),ut("fire-js","")}yl("");var _l="firebase",wl="12.8.0";ut(_l,wl,"app");var Wo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Qo={};var Nn,Yo;(function(){var r;function t(g,h){function f(){}f.prototype=h.prototype,g.F=h.prototype,g.prototype=new f,g.prototype.constructor=g,g.D=function(y,p,w){for(var d=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)d[ct-2]=arguments[ct];return h.prototype[p].apply(y,d)}}function e(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(s,e),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(g,h,f){f||(f=0);let y=Array(16);if(typeof h=="string")for(var p=0;p<16;++p)y[p]=h.charCodeAt(f++)|h.charCodeAt(f++)<<8|h.charCodeAt(f++)<<16|h.charCodeAt(f++)<<24;else for(p=0;p<16;++p)y[p]=h[f++]|h[f++]<<8|h[f++]<<16|h[f++]<<24;h=g.g[0],f=g.g[1],p=g.g[2];let w=g.g[3],d;d=h+(w^f&(p^w))+y[0]+3614090360&4294967295,h=f+(d<<7&4294967295|d>>>25),d=w+(p^h&(f^p))+y[1]+3905402710&4294967295,w=h+(d<<12&4294967295|d>>>20),d=p+(f^w&(h^f))+y[2]+606105819&4294967295,p=w+(d<<17&4294967295|d>>>15),d=f+(h^p&(w^h))+y[3]+3250441966&4294967295,f=p+(d<<22&4294967295|d>>>10),d=h+(w^f&(p^w))+y[4]+4118548399&4294967295,h=f+(d<<7&4294967295|d>>>25),d=w+(p^h&(f^p))+y[5]+1200080426&4294967295,w=h+(d<<12&4294967295|d>>>20),d=p+(f^w&(h^f))+y[6]+2821735955&4294967295,p=w+(d<<17&4294967295|d>>>15),d=f+(h^p&(w^h))+y[7]+4249261313&4294967295,f=p+(d<<22&4294967295|d>>>10),d=h+(w^f&(p^w))+y[8]+1770035416&4294967295,h=f+(d<<7&4294967295|d>>>25),d=w+(p^h&(f^p))+y[9]+2336552879&4294967295,w=h+(d<<12&4294967295|d>>>20),d=p+(f^w&(h^f))+y[10]+4294925233&4294967295,p=w+(d<<17&4294967295|d>>>15),d=f+(h^p&(w^h))+y[11]+2304563134&4294967295,f=p+(d<<22&4294967295|d>>>10),d=h+(w^f&(p^w))+y[12]+1804603682&4294967295,h=f+(d<<7&4294967295|d>>>25),d=w+(p^h&(f^p))+y[13]+4254626195&4294967295,w=h+(d<<12&4294967295|d>>>20),d=p+(f^w&(h^f))+y[14]+2792965006&4294967295,p=w+(d<<17&4294967295|d>>>15),d=f+(h^p&(w^h))+y[15]+1236535329&4294967295,f=p+(d<<22&4294967295|d>>>10),d=h+(p^w&(f^p))+y[1]+4129170786&4294967295,h=f+(d<<5&4294967295|d>>>27),d=w+(f^p&(h^f))+y[6]+3225465664&4294967295,w=h+(d<<9&4294967295|d>>>23),d=p+(h^f&(w^h))+y[11]+643717713&4294967295,p=w+(d<<14&4294967295|d>>>18),d=f+(w^h&(p^w))+y[0]+3921069994&4294967295,f=p+(d<<20&4294967295|d>>>12),d=h+(p^w&(f^p))+y[5]+3593408605&4294967295,h=f+(d<<5&4294967295|d>>>27),d=w+(f^p&(h^f))+y[10]+38016083&4294967295,w=h+(d<<9&4294967295|d>>>23),d=p+(h^f&(w^h))+y[15]+3634488961&4294967295,p=w+(d<<14&4294967295|d>>>18),d=f+(w^h&(p^w))+y[4]+3889429448&4294967295,f=p+(d<<20&4294967295|d>>>12),d=h+(p^w&(f^p))+y[9]+568446438&4294967295,h=f+(d<<5&4294967295|d>>>27),d=w+(f^p&(h^f))+y[14]+3275163606&4294967295,w=h+(d<<9&4294967295|d>>>23),d=p+(h^f&(w^h))+y[3]+4107603335&4294967295,p=w+(d<<14&4294967295|d>>>18),d=f+(w^h&(p^w))+y[8]+1163531501&4294967295,f=p+(d<<20&4294967295|d>>>12),d=h+(p^w&(f^p))+y[13]+2850285829&4294967295,h=f+(d<<5&4294967295|d>>>27),d=w+(f^p&(h^f))+y[2]+4243563512&4294967295,w=h+(d<<9&4294967295|d>>>23),d=p+(h^f&(w^h))+y[7]+1735328473&4294967295,p=w+(d<<14&4294967295|d>>>18),d=f+(w^h&(p^w))+y[12]+2368359562&4294967295,f=p+(d<<20&4294967295|d>>>12),d=h+(f^p^w)+y[5]+4294588738&4294967295,h=f+(d<<4&4294967295|d>>>28),d=w+(h^f^p)+y[8]+2272392833&4294967295,w=h+(d<<11&4294967295|d>>>21),d=p+(w^h^f)+y[11]+1839030562&4294967295,p=w+(d<<16&4294967295|d>>>16),d=f+(p^w^h)+y[14]+4259657740&4294967295,f=p+(d<<23&4294967295|d>>>9),d=h+(f^p^w)+y[1]+2763975236&4294967295,h=f+(d<<4&4294967295|d>>>28),d=w+(h^f^p)+y[4]+1272893353&4294967295,w=h+(d<<11&4294967295|d>>>21),d=p+(w^h^f)+y[7]+4139469664&4294967295,p=w+(d<<16&4294967295|d>>>16),d=f+(p^w^h)+y[10]+3200236656&4294967295,f=p+(d<<23&4294967295|d>>>9),d=h+(f^p^w)+y[13]+681279174&4294967295,h=f+(d<<4&4294967295|d>>>28),d=w+(h^f^p)+y[0]+3936430074&4294967295,w=h+(d<<11&4294967295|d>>>21),d=p+(w^h^f)+y[3]+3572445317&4294967295,p=w+(d<<16&4294967295|d>>>16),d=f+(p^w^h)+y[6]+76029189&4294967295,f=p+(d<<23&4294967295|d>>>9),d=h+(f^p^w)+y[9]+3654602809&4294967295,h=f+(d<<4&4294967295|d>>>28),d=w+(h^f^p)+y[12]+3873151461&4294967295,w=h+(d<<11&4294967295|d>>>21),d=p+(w^h^f)+y[15]+530742520&4294967295,p=w+(d<<16&4294967295|d>>>16),d=f+(p^w^h)+y[2]+3299628645&4294967295,f=p+(d<<23&4294967295|d>>>9),d=h+(p^(f|~w))+y[0]+4096336452&4294967295,h=f+(d<<6&4294967295|d>>>26),d=w+(f^(h|~p))+y[7]+1126891415&4294967295,w=h+(d<<10&4294967295|d>>>22),d=p+(h^(w|~f))+y[14]+2878612391&4294967295,p=w+(d<<15&4294967295|d>>>17),d=f+(w^(p|~h))+y[5]+4237533241&4294967295,f=p+(d<<21&4294967295|d>>>11),d=h+(p^(f|~w))+y[12]+1700485571&4294967295,h=f+(d<<6&4294967295|d>>>26),d=w+(f^(h|~p))+y[3]+2399980690&4294967295,w=h+(d<<10&4294967295|d>>>22),d=p+(h^(w|~f))+y[10]+4293915773&4294967295,p=w+(d<<15&4294967295|d>>>17),d=f+(w^(p|~h))+y[1]+2240044497&4294967295,f=p+(d<<21&4294967295|d>>>11),d=h+(p^(f|~w))+y[8]+1873313359&4294967295,h=f+(d<<6&4294967295|d>>>26),d=w+(f^(h|~p))+y[15]+4264355552&4294967295,w=h+(d<<10&4294967295|d>>>22),d=p+(h^(w|~f))+y[6]+2734768916&4294967295,p=w+(d<<15&4294967295|d>>>17),d=f+(w^(p|~h))+y[13]+1309151649&4294967295,f=p+(d<<21&4294967295|d>>>11),d=h+(p^(f|~w))+y[4]+4149444226&4294967295,h=f+(d<<6&4294967295|d>>>26),d=w+(f^(h|~p))+y[11]+3174756917&4294967295,w=h+(d<<10&4294967295|d>>>22),d=p+(h^(w|~f))+y[2]+718787259&4294967295,p=w+(d<<15&4294967295|d>>>17),d=f+(w^(p|~h))+y[9]+3951481745&4294967295,g.g[0]=g.g[0]+h&4294967295,g.g[1]=g.g[1]+(p+(d<<21&4294967295|d>>>11))&4294967295,g.g[2]=g.g[2]+p&4294967295,g.g[3]=g.g[3]+w&4294967295}s.prototype.v=function(g,h){h===void 0&&(h=g.length);let f=h-this.blockSize,y=this.C,p=this.h,w=0;for(;w<h;){if(p==0)for(;w<=f;)i(this,g,w),w+=this.blockSize;if(typeof g=="string"){for(;w<h;)if(y[p++]=g.charCodeAt(w++),p==this.blockSize){i(this,y),p=0;break}}else for(;w<h;)if(y[p++]=g[w++],p==this.blockSize){i(this,y),p=0;break}}this.h=p,this.o+=h},s.prototype.A=function(){var g=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);g[0]=128;for(var h=1;h<g.length-8;++h)g[h]=0;h=this.o*8;for(var f=g.length-8;f<g.length;++f)g[f]=h&255,h/=256;for(this.v(g),g=Array(16),h=0,f=0;f<4;++f)for(let y=0;y<32;y+=8)g[h++]=this.g[f]>>>y&255;return g};function c(g,h){var f=m;return Object.prototype.hasOwnProperty.call(f,g)?f[g]:f[g]=h(g)}function u(g,h){this.h=h;let f=[],y=!0;for(let p=g.length-1;p>=0;p--){let w=g[p]|0;y&&w==h||(f[p]=w,y=!1)}this.g=f}var m={};function E(g){return-128<=g&&g<128?c(g,function(h){return new u([h|0],h<0?-1:0)}):new u([g|0],g<0?-1:0)}function T(g){if(isNaN(g)||!isFinite(g))return b;if(g<0)return q(T(-g));let h=[],f=1;for(let y=0;g>=f;y++)h[y]=g/f|0,f*=4294967296;return new u(h,0)}function R(g,h){if(g.length==0)throw Error("number format error: empty string");if(h=h||10,h<2||36<h)throw Error("radix out of range: "+h);if(g.charAt(0)=="-")return q(R(g.substring(1),h));if(g.indexOf("-")>=0)throw Error('number format error: interior "-" character');let f=T(Math.pow(h,8)),y=b;for(let w=0;w<g.length;w+=8){var p=Math.min(8,g.length-w);let d=parseInt(g.substring(w,w+p),h);p<8?(p=T(Math.pow(h,p)),y=y.j(p).add(T(d))):(y=y.j(f),y=y.add(T(d)))}return y}var b=E(0),A=E(1),O=E(16777216);r=u.prototype,r.m=function(){if(M(this))return-q(this).m();let g=0,h=1;for(let f=0;f<this.g.length;f++){let y=this.i(f);g+=(y>=0?y:4294967296+y)*h,h*=4294967296}return g},r.toString=function(g){if(g=g||10,g<2||36<g)throw Error("radix out of range: "+g);if(x(this))return"0";if(M(this))return"-"+q(this).toString(g);let h=T(Math.pow(g,6));var f=this;let y="";for(;;){let p=mt(f,h).g;f=Y(f,p.j(h));let w=((f.g.length>0?f.g[0]:f.h)>>>0).toString(g);if(f=p,x(f))return w+y;for(;w.length<6;)w="0"+w;y=w+y}},r.i=function(g){return g<0?0:g<this.g.length?this.g[g]:this.h};function x(g){if(g.h!=0)return!1;for(let h=0;h<g.g.length;h++)if(g.g[h]!=0)return!1;return!0}function M(g){return g.h==-1}r.l=function(g){return g=Y(this,g),M(g)?-1:x(g)?0:1};function q(g){let h=g.g.length,f=[];for(let y=0;y<h;y++)f[y]=~g.g[y];return new u(f,~g.h).add(A)}r.abs=function(){return M(this)?q(this):this},r.add=function(g){let h=Math.max(this.g.length,g.g.length),f=[],y=0;for(let p=0;p<=h;p++){let w=y+(this.i(p)&65535)+(g.i(p)&65535),d=(w>>>16)+(this.i(p)>>>16)+(g.i(p)>>>16);y=d>>>16,w&=65535,d&=65535,f[p]=d<<16|w}return new u(f,f[f.length-1]&-2147483648?-1:0)};function Y(g,h){return g.add(q(h))}r.j=function(g){if(x(this)||x(g))return b;if(M(this))return M(g)?q(this).j(q(g)):q(q(this).j(g));if(M(g))return q(this.j(q(g)));if(this.l(O)<0&&g.l(O)<0)return T(this.m()*g.m());let h=this.g.length+g.g.length,f=[];for(var y=0;y<2*h;y++)f[y]=0;for(y=0;y<this.g.length;y++)for(let p=0;p<g.g.length;p++){let w=this.i(y)>>>16,d=this.i(y)&65535,ct=g.i(p)>>>16,Mt=g.i(p)&65535;f[2*y+2*p]+=d*Mt,J(f,2*y+2*p),f[2*y+2*p+1]+=w*Mt,J(f,2*y+2*p+1),f[2*y+2*p+1]+=d*ct,J(f,2*y+2*p+1),f[2*y+2*p+2]+=w*ct,J(f,2*y+2*p+2)}for(g=0;g<h;g++)f[g]=f[2*g+1]<<16|f[2*g];for(g=h;g<2*h;g++)f[g]=0;return new u(f,0)};function J(g,h){for(;(g[h]&65535)!=g[h];)g[h+1]+=g[h]>>>16,g[h]&=65535,h++}function tt(g,h){this.g=g,this.h=h}function mt(g,h){if(x(h))throw Error("division by zero");if(x(g))return new tt(b,b);if(M(g))return h=mt(q(g),h),new tt(q(h.g),q(h.h));if(M(h))return h=mt(g,q(h)),new tt(q(h.g),h.h);if(g.g.length>30){if(M(g)||M(h))throw Error("slowDivide_ only works with positive integers.");for(var f=A,y=h;y.l(g)<=0;)f=Pt(f),y=Pt(y);var p=at(f,1),w=at(y,1);for(y=at(y,2),f=at(f,2);!x(y);){var d=w.add(y);d.l(g)<=0&&(p=p.add(f),w=d),y=at(y,1),f=at(f,1)}return h=Y(g,p.j(h)),new tt(p,h)}for(p=b;g.l(h)>=0;){for(f=Math.max(1,Math.floor(g.m()/h.m())),y=Math.ceil(Math.log(f)/Math.LN2),y=y<=48?1:Math.pow(2,y-48),w=T(f),d=w.j(h);M(d)||d.l(g)>0;)f-=y,w=T(f),d=w.j(h);x(w)&&(w=A),p=p.add(w),g=Y(g,d)}return new tt(p,g)}r.B=function(g){return mt(this,g).h},r.and=function(g){let h=Math.max(this.g.length,g.g.length),f=[];for(let y=0;y<h;y++)f[y]=this.i(y)&g.i(y);return new u(f,this.h&g.h)},r.or=function(g){let h=Math.max(this.g.length,g.g.length),f=[];for(let y=0;y<h;y++)f[y]=this.i(y)|g.i(y);return new u(f,this.h|g.h)},r.xor=function(g){let h=Math.max(this.g.length,g.g.length),f=[];for(let y=0;y<h;y++)f[y]=this.i(y)^g.i(y);return new u(f,this.h^g.h)};function Pt(g){let h=g.g.length+1,f=[];for(let y=0;y<h;y++)f[y]=g.i(y)<<1|g.i(y-1)>>>31;return new u(f,g.h)}function at(g,h){let f=h>>5;h%=32;let y=g.g.length-f,p=[];for(let w=0;w<y;w++)p[w]=h>0?g.i(w+f)>>>h|g.i(w+f+1)<<32-h:g.i(w+f);return new u(p,g.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,Yo=Qo.Md5=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=T,u.fromString=R,Nn=Qo.Integer=u}).apply(typeof Wo<"u"?Wo:typeof self<"u"?self:typeof window<"u"?window:{});var On=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Vt={};var ns,Il,me,rs,tn,Mn,ss,is,os;(function(){var r,t=Object.defineProperty;function e(n){n=[typeof globalThis=="object"&&globalThis,n,typeof window=="object"&&window,typeof self=="object"&&self,typeof On=="object"&&On];for(var o=0;o<n.length;++o){var a=n[o];if(a&&a.Math==Math)return a}throw Error("Cannot find global object")}var s=e(this);function i(n,o){if(o)t:{var a=s;n=n.split(".");for(var l=0;l<n.length-1;l++){var _=n[l];if(!(_ in a))break t;a=a[_]}n=n[n.length-1],l=a[n],o=o(l),o!=l&&o!=null&&t(a,n,{configurable:!0,writable:!0,value:o})}}i("Symbol.dispose",function(n){return n||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(n){return n||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(n){return n||function(o){var a=[],l;for(l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.push([l,o[l]]);return a}});var c=c||{},u=this||self;function m(n){var o=typeof n;return o=="object"&&n!=null||o=="function"}function E(n,o,a){return n.call.apply(n.bind,arguments)}function T(n,o,a){return T=E,T.apply(null,arguments)}function R(n,o){var a=Array.prototype.slice.call(arguments,1);return function(){var l=a.slice();return l.push.apply(l,arguments),n.apply(this,l)}}function b(n,o){function a(){}a.prototype=o.prototype,n.Z=o.prototype,n.prototype=new a,n.prototype.constructor=n,n.Ob=function(l,_,I){for(var v=Array(arguments.length-2),k=2;k<arguments.length;k++)v[k-2]=arguments[k];return o.prototype[_].apply(l,v)}}var A=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?n=>n&&AsyncContext.Snapshot.wrap(n):n=>n;function O(n){let o=n.length;if(o>0){let a=Array(o);for(let l=0;l<o;l++)a[l]=n[l];return a}return[]}function x(n,o){for(let l=1;l<arguments.length;l++){let _=arguments[l];var a=typeof _;if(a=a!="object"?a:_?Array.isArray(_)?"array":a:"null",a=="array"||a=="object"&&typeof _.length=="number"){a=n.length||0;let I=_.length||0;n.length=a+I;for(let v=0;v<I;v++)n[a+v]=_[v]}else n.push(_)}}class M{constructor(o,a){this.i=o,this.j=a,this.h=0,this.g=null}get(){let o;return this.h>0?(this.h--,o=this.g,this.g=o.next,o.next=null):o=this.i(),o}}function q(n){u.setTimeout(()=>{throw n},0)}function Y(){var n=g;let o=null;return n.g&&(o=n.g,n.g=n.g.next,n.g||(n.h=null),o.next=null),o}class J{constructor(){this.h=this.g=null}add(o,a){let l=tt.get();l.set(o,a),this.h?this.h.next=l:this.g=l,this.h=l}}var tt=new M(()=>new mt,n=>n.reset());class mt{constructor(){this.next=this.g=this.h=null}set(o,a){this.h=o,this.g=a,this.next=null}reset(){this.next=this.g=this.h=null}}let Pt,at=!1,g=new J,h=()=>{let n=Promise.resolve(void 0);Pt=()=>{n.then(f)}};function f(){for(var n;n=Y();){try{n.h.call(n.g)}catch(a){q(a)}var o=tt;o.j(n),o.h<100&&(o.h++,n.next=o.g,o.g=n)}at=!1}function y(){this.u=this.u,this.C=this.C}y.prototype.u=!1,y.prototype.dispose=function(){this.u||(this.u=!0,this.N())},y.prototype[Symbol.dispose]=function(){this.dispose()},y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function p(n,o){this.type=n,this.g=this.target=o,this.defaultPrevented=!1}p.prototype.h=function(){this.defaultPrevented=!0};var w=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var n=!1,o=Object.defineProperty({},"passive",{get:function(){n=!0}});try{let a=()=>{};u.addEventListener("test",a,o),u.removeEventListener("test",a,o)}catch{}return n}();function d(n){return/^[\s\xa0]*$/.test(n)}function ct(n,o){p.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n&&this.init(n,o)}b(ct,p),ct.prototype.init=function(n,o){let a=this.type=n.type,l=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;this.target=n.target||n.srcElement,this.g=o,o=n.relatedTarget,o||(a=="mouseover"?o=n.fromElement:a=="mouseout"&&(o=n.toElement)),this.relatedTarget=o,l?(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=n.pointerType,this.state=n.state,this.i=n,n.defaultPrevented&&ct.Z.h.call(this)},ct.prototype.h=function(){ct.Z.h.call(this);let n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Mt="closure_listenable_"+(Math.random()*1e6|0),yc=0;function _c(n,o,a,l,_){this.listener=n,this.proxy=null,this.src=o,this.type=a,this.capture=!!l,this.ha=_,this.key=++yc,this.da=this.fa=!1}function un(n){n.da=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function ln(n,o,a){for(let l in n)o.call(a,n[l],l,n)}function wc(n,o){for(let a in n)o.call(void 0,n[a],a,n)}function Ws(n){let o={};for(let a in n)o[a]=n[a];return o}let Qs="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ys(n,o){let a,l;for(let _=1;_<arguments.length;_++){l=arguments[_];for(a in l)n[a]=l[a];for(let I=0;I<Qs.length;I++)a=Qs[I],Object.prototype.hasOwnProperty.call(l,a)&&(n[a]=l[a])}}function hn(n){this.src=n,this.g={},this.h=0}hn.prototype.add=function(n,o,a,l,_){let I=n.toString();n=this.g[I],n||(n=this.g[I]=[],this.h++);let v=cr(n,o,l,_);return v>-1?(o=n[v],a||(o.fa=!1)):(o=new _c(o,this.src,I,!!l,_),o.fa=a,n.push(o)),o};function ar(n,o){let a=o.type;if(a in n.g){var l=n.g[a],_=Array.prototype.indexOf.call(l,o,void 0),I;(I=_>=0)&&Array.prototype.splice.call(l,_,1),I&&(un(o),n.g[a].length==0&&(delete n.g[a],n.h--))}}function cr(n,o,a,l){for(let _=0;_<n.length;++_){let I=n[_];if(!I.da&&I.listener==o&&I.capture==!!a&&I.ha==l)return _}return-1}var ur="closure_lm_"+(Math.random()*1e6|0),lr={};function Js(n,o,a,l,_){if(l&&l.once)return Zs(n,o,a,l,_);if(Array.isArray(o)){for(let I=0;I<o.length;I++)Js(n,o[I],a,l,_);return null}return a=mr(a),n&&n[Mt]?n.J(o,a,m(l)?!!l.capture:!!l,_):Xs(n,o,a,!1,l,_)}function Xs(n,o,a,l,_,I){if(!o)throw Error("Invalid event type");let v=m(_)?!!_.capture:!!_,k=dr(n);if(k||(n[ur]=k=new hn(n)),a=k.add(o,a,l,v,I),a.proxy)return a;if(l=Ic(),a.proxy=l,l.src=n,l.listener=a,n.addEventListener)w||(_=v),_===void 0&&(_=!1),n.addEventListener(o.toString(),l,_);else if(n.attachEvent)n.attachEvent(ei(o.toString()),l);else if(n.addListener&&n.removeListener)n.addListener(l);else throw Error("addEventListener and attachEvent are unavailable.");return a}function Ic(){function n(a){return o.call(n.src,n.listener,a)}let o=Ec;return n}function Zs(n,o,a,l,_){if(Array.isArray(o)){for(let I=0;I<o.length;I++)Zs(n,o[I],a,l,_);return null}return a=mr(a),n&&n[Mt]?n.K(o,a,m(l)?!!l.capture:!!l,_):Xs(n,o,a,!0,l,_)}function ti(n,o,a,l,_){if(Array.isArray(o))for(var I=0;I<o.length;I++)ti(n,o[I],a,l,_);else l=m(l)?!!l.capture:!!l,a=mr(a),n&&n[Mt]?(n=n.i,I=String(o).toString(),I in n.g&&(o=n.g[I],a=cr(o,a,l,_),a>-1&&(un(o[a]),Array.prototype.splice.call(o,a,1),o.length==0&&(delete n.g[I],n.h--)))):n&&(n=dr(n))&&(o=n.g[o.toString()],n=-1,o&&(n=cr(o,a,l,_)),(a=n>-1?o[n]:null)&&hr(a))}function hr(n){if(typeof n!="number"&&n&&!n.da){var o=n.src;if(o&&o[Mt])ar(o.i,n);else{var a=n.type,l=n.proxy;o.removeEventListener?o.removeEventListener(a,l,n.capture):o.detachEvent?o.detachEvent(ei(a),l):o.addListener&&o.removeListener&&o.removeListener(l),(a=dr(o))?(ar(a,n),a.h==0&&(a.src=null,o[ur]=null)):un(n)}}}function ei(n){return n in lr?lr[n]:lr[n]="on"+n}function Ec(n,o){if(n.da)n=!0;else{o=new ct(o,this);let a=n.listener,l=n.ha||n.src;n.fa&&hr(n),n=a.call(l,o)}return n}function dr(n){return n=n[ur],n instanceof hn?n:null}var fr="__closure_events_fn_"+(Math.random()*1e9>>>0);function mr(n){return typeof n=="function"?n:(n[fr]||(n[fr]=function(o){return n.handleEvent(o)}),n[fr])}function et(){y.call(this),this.i=new hn(this),this.M=this,this.G=null}b(et,y),et.prototype[Mt]=!0,et.prototype.removeEventListener=function(n,o,a,l){ti(this,n,o,a,l)};function rt(n,o){var a,l=n.G;if(l)for(a=[];l;l=l.G)a.push(l);if(n=n.M,l=o.type||o,typeof o=="string")o=new p(o,n);else if(o instanceof p)o.target=o.target||n;else{var _=o;o=new p(l,n),Ys(o,_)}_=!0;let I,v;if(a)for(v=a.length-1;v>=0;v--)I=o.g=a[v],_=dn(I,l,!0,o)&&_;if(I=o.g=n,_=dn(I,l,!0,o)&&_,_=dn(I,l,!1,o)&&_,a)for(v=0;v<a.length;v++)I=o.g=a[v],_=dn(I,l,!1,o)&&_}et.prototype.N=function(){if(et.Z.N.call(this),this.i){var n=this.i;for(let o in n.g){let a=n.g[o];for(let l=0;l<a.length;l++)un(a[l]);delete n.g[o],n.h--}}this.G=null},et.prototype.J=function(n,o,a,l){return this.i.add(String(n),o,!1,a,l)},et.prototype.K=function(n,o,a,l){return this.i.add(String(n),o,!0,a,l)};function dn(n,o,a,l){if(o=n.i.g[String(o)],!o)return!0;o=o.concat();let _=!0;for(let I=0;I<o.length;++I){let v=o[I];if(v&&!v.da&&v.capture==a){let k=v.listener,W=v.ha||v.src;v.fa&&ar(n.i,v),_=k.call(W,l)!==!1&&_}}return _&&!l.defaultPrevented}function Tc(n,o){if(typeof n!="function")if(n&&typeof n.handleEvent=="function")n=T(n.handleEvent,n);else throw Error("Invalid listener argument");return Number(o)>2147483647?-1:u.setTimeout(n,o||0)}function ni(n){n.g=Tc(()=>{n.g=null,n.i&&(n.i=!1,ni(n))},n.l);let o=n.h;n.h=null,n.m.apply(null,o)}class vc extends y{constructor(o,a){super(),this.m=o,this.l=a,this.h=null,this.i=!1,this.g=null}j(o){this.h=arguments,this.g?this.i=!0:ni(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pe(n){y.call(this),this.h=n,this.g={}}b(Pe,y);var ri=[];function si(n){ln(n.g,function(o,a){this.g.hasOwnProperty(a)&&hr(o)},n),n.g={}}Pe.prototype.N=function(){Pe.Z.N.call(this),si(this)},Pe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pr=u.JSON.stringify,bc=u.JSON.parse,Ac=class{stringify(n){return u.JSON.stringify(n,void 0)}parse(n){return u.JSON.parse(n,void 0)}};function ii(){}function oi(){}var Ce={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gr(){p.call(this,"d")}b(gr,p);function yr(){p.call(this,"c")}b(yr,p);var Wt={},ai=null;function fn(){return ai=ai||new et}Wt.Ia="serverreachability";function ci(n){p.call(this,Wt.Ia,n)}b(ci,p);function De(n){let o=fn();rt(o,new ci(o))}Wt.STAT_EVENT="statevent";function ui(n,o){p.call(this,Wt.STAT_EVENT,n),this.stat=o}b(ui,p);function st(n){let o=fn();rt(o,new ui(o,n))}Wt.Ja="timingevent";function li(n,o){p.call(this,Wt.Ja,n),this.size=o}b(li,p);function xe(n,o){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){n()},o)}function Ve(){this.g=!0}Ve.prototype.ua=function(){this.g=!1};function Sc(n,o,a,l,_,I){n.info(function(){if(n.g)if(I){var v="",k=I.split("&");for(let U=0;U<k.length;U++){var W=k[U].split("=");if(W.length>1){let Q=W[0];W=W[1];let wt=Q.split("_");v=wt.length>=2&&wt[1]=="type"?v+(Q+"="+W+"&"):v+(Q+"=redacted&")}}}else v=null;else v=I;return"XMLHTTP REQ ("+l+") [attempt "+_+"]: "+o+`
`+a+`
`+v})}function Rc(n,o,a,l,_,I,v){n.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+_+"]: "+o+`
`+a+`
`+I+" "+v})}function ce(n,o,a,l){n.info(function(){return"XMLHTTP TEXT ("+o+"): "+Cc(n,a)+(l?" "+l:"")})}function Pc(n,o){n.info(function(){return"TIMEOUT: "+o})}Ve.prototype.info=function(){};function Cc(n,o){if(!n.g)return o;if(!o)return null;try{let I=JSON.parse(o);if(I){for(n=0;n<I.length;n++)if(Array.isArray(I[n])){var a=I[n];if(!(a.length<2)){var l=a[1];if(Array.isArray(l)&&!(l.length<1)){var _=l[0];if(_!="noop"&&_!="stop"&&_!="close")for(let v=1;v<l.length;v++)l[v]=""}}}}return pr(I)}catch{return o}}var mn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},hi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},di;function _r(){}b(_r,ii),_r.prototype.g=function(){return new XMLHttpRequest},di=new _r;function ke(n){return encodeURIComponent(String(n))}function Dc(n){var o=1;n=n.split(":");let a=[];for(;o>0&&n.length;)a.push(n.shift()),o--;return n.length&&a.push(n.join(":")),a}function Ft(n,o,a,l){this.j=n,this.i=o,this.l=a,this.S=l||1,this.V=new Pe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new fi}function fi(){this.i=null,this.g="",this.h=!1}var mi={},wr={};function Ir(n,o,a){n.M=1,n.A=gn(_t(o)),n.u=a,n.R=!0,pi(n,null)}function pi(n,o){n.F=Date.now(),pn(n),n.B=_t(n.A);var a=n.B,l=n.S;Array.isArray(l)||(l=[String(l)]),Pi(a.i,"t",l),n.C=0,a=n.j.L,n.h=new fi,n.g=Ki(n.j,a?o:null,!n.u),n.P>0&&(n.O=new vc(T(n.Y,n,n.g),n.P)),o=n.V,a=n.g,l=n.ba;var _="readystatechange";Array.isArray(_)||(_&&(ri[0]=_.toString()),_=ri);for(let I=0;I<_.length;I++){let v=Js(a,_[I],l||o.handleEvent,!1,o.h||o);if(!v)break;o.g[v.key]=v}o=n.J?Ws(n.J):{},n.u?(n.v||(n.v="POST"),o["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.B,n.v,n.u,o)):(n.v="GET",n.g.ea(n.B,n.v,null,o)),De(),Sc(n.i,n.v,n.B,n.l,n.S,n.u)}Ft.prototype.ba=function(n){n=n.target;let o=this.O;o&&Ut(n)==3?o.j():this.Y(n)},Ft.prototype.Y=function(n){try{if(n==this.g)t:{let k=Ut(this.g),W=this.g.ya(),U=this.g.ca();if(!(k<3)&&(k!=3||this.g&&(this.h.h||this.g.la()||Oi(this.g)))){this.K||k!=4||W==7||(W==8||U<=0?De(3):De(2)),Er(this);var o=this.g.ca();this.X=o;var a=xc(this);if(this.o=o==200,Rc(this.i,this.v,this.B,this.l,this.S,k,o),this.o){if(this.U&&!this.L){e:{if(this.g){var l,_=this.g;if((l=_.g?_.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!d(l)){var I=l;break e}}I=null}if(n=I)ce(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Tr(this,n);else{this.o=!1,this.m=3,st(12),Qt(this),Ne(this);break t}}if(this.R){n=!0;let Q;for(;!this.K&&this.C<a.length;)if(Q=Vc(this,a),Q==wr){k==4&&(this.m=4,st(14),n=!1),ce(this.i,this.l,null,"[Incomplete Response]");break}else if(Q==mi){this.m=4,st(15),ce(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}else ce(this.i,this.l,Q,null),Tr(this,Q);if(gi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),k!=4||a.length!=0||this.h.h||(this.m=1,st(16),n=!1),this.o=this.o&&n,!n)ce(this.i,this.l,a,"[Invalid Chunked Response]"),Qt(this),Ne(this);else if(a.length>0&&!this.W){this.W=!0;var v=this.j;v.g==this&&v.aa&&!v.P&&(v.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),Cr(v),v.P=!0,st(11))}}else ce(this.i,this.l,a,null),Tr(this,a);k==4&&Qt(this),this.o&&!this.K&&(k==4?ji(this.j,this):(this.o=!1,pn(this)))}else Kc(this.g),o==400&&a.indexOf("Unknown SID")>0?(this.m=3,st(12)):(this.m=0,st(13)),Qt(this),Ne(this)}}}catch{}finally{}};function xc(n){if(!gi(n))return n.g.la();let o=Oi(n.g);if(o==="")return"";let a="",l=o.length,_=Ut(n.g)==4;if(!n.h.i){if(typeof TextDecoder>"u")return Qt(n),Ne(n),"";n.h.i=new u.TextDecoder}for(let I=0;I<l;I++)n.h.h=!0,a+=n.h.i.decode(o[I],{stream:!(_&&I==l-1)});return o.length=0,n.h.g+=a,n.C=0,n.h.g}function gi(n){return n.g?n.v=="GET"&&n.M!=2&&n.j.Aa:!1}function Vc(n,o){var a=n.C,l=o.indexOf(`
`,a);return l==-1?wr:(a=Number(o.substring(a,l)),isNaN(a)?mi:(l+=1,l+a>o.length?wr:(o=o.slice(l,l+a),n.C=l+a,o)))}Ft.prototype.cancel=function(){this.K=!0,Qt(this)};function pn(n){n.T=Date.now()+n.H,yi(n,n.H)}function yi(n,o){if(n.D!=null)throw Error("WatchDog timer not null");n.D=xe(T(n.aa,n),o)}function Er(n){n.D&&(u.clearTimeout(n.D),n.D=null)}Ft.prototype.aa=function(){this.D=null;let n=Date.now();n-this.T>=0?(Pc(this.i,this.B),this.M!=2&&(De(),st(17)),Qt(this),this.m=2,Ne(this)):yi(this,this.T-n)};function Ne(n){n.j.I==0||n.K||ji(n.j,n)}function Qt(n){Er(n);var o=n.O;o&&typeof o.dispose=="function"&&o.dispose(),n.O=null,si(n.V),n.g&&(o=n.g,n.g=null,o.abort(),o.dispose())}function Tr(n,o){try{var a=n.j;if(a.I!=0&&(a.g==n||vr(a.h,n))){if(!n.L&&vr(a.h,n)&&a.I==3){try{var l=a.Ba.g.parse(o)}catch{l=null}if(Array.isArray(l)&&l.length==3){var _=l;if(_[0]==0){t:if(!a.v){if(a.g)if(a.g.F+3e3<n.F)Tn(a),In(a);else break t;Pr(a),st(18)}}else a.xa=_[1],0<a.xa-a.K&&_[2]<37500&&a.F&&a.A==0&&!a.C&&(a.C=xe(T(a.Va,a),6e3));Ii(a.h)<=1&&a.ta&&(a.ta=void 0)}else Jt(a,11)}else if((n.L||a.g==n)&&Tn(a),!d(o))for(_=a.Ba.g.parse(o),o=0;o<_.length;o++){let U=_[o],Q=U[0];if(!(Q<=a.K))if(a.K=Q,U=U[1],a.I==2)if(U[0]=="c"){a.M=U[1],a.ba=U[2];let wt=U[3];wt!=null&&(a.ka=wt,a.j.info("VER="+a.ka));let Xt=U[4];Xt!=null&&(a.za=Xt,a.j.info("SVER="+a.za));let qt=U[5];qt!=null&&typeof qt=="number"&&qt>0&&(l=1.5*qt,a.O=l,a.j.info("backChannelRequestTimeoutMs_="+l)),l=a;let jt=n.g;if(jt){let bn=jt.g?jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bn){var I=l.h;I.g||bn.indexOf("spdy")==-1&&bn.indexOf("quic")==-1&&bn.indexOf("h2")==-1||(I.j=I.l,I.g=new Set,I.h&&(br(I,I.h),I.h=null))}if(l.G){let Dr=jt.g?jt.g.getResponseHeader("X-HTTP-Session-Id"):null;Dr&&(l.wa=Dr,j(l.J,l.G,Dr))}}a.I=3,a.l&&a.l.ra(),a.aa&&(a.T=Date.now()-n.F,a.j.info("Handshake RTT: "+a.T+"ms")),l=a;var v=n;if(l.na=Gi(l,l.L?l.ba:null,l.W),v.L){Ei(l.h,v);var k=v,W=l.O;W&&(k.H=W),k.D&&(Er(k),pn(k)),l.g=v}else Ui(l);a.i.length>0&&En(a)}else U[0]!="stop"&&U[0]!="close"||Jt(a,7);else a.I==3&&(U[0]=="stop"||U[0]=="close"?U[0]=="stop"?Jt(a,7):Rr(a):U[0]!="noop"&&a.l&&a.l.qa(U),a.A=0)}}De(4)}catch{}}var kc=class{constructor(n,o){this.g=n,this.map=o}};function _i(n){this.l=n||10,u.PerformanceNavigationTiming?(n=u.performance.getEntriesByType("navigation"),n=n.length>0&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=n?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function wi(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function Ii(n){return n.h?1:n.g?n.g.size:0}function vr(n,o){return n.h?n.h==o:n.g?n.g.has(o):!1}function br(n,o){n.g?n.g.add(o):n.h=o}function Ei(n,o){n.h&&n.h==o?n.h=null:n.g&&n.g.has(o)&&n.g.delete(o)}_i.prototype.cancel=function(){if(this.i=Ti(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let n of this.g.values())n.cancel();this.g.clear()}};function Ti(n){if(n.h!=null)return n.i.concat(n.h.G);if(n.g!=null&&n.g.size!==0){let o=n.i;for(let a of n.g.values())o=o.concat(a.G);return o}return O(n.i)}var vi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Nc(n,o){if(n){n=n.split("&");for(let a=0;a<n.length;a++){let l=n[a].indexOf("="),_,I=null;l>=0?(_=n[a].substring(0,l),I=n[a].substring(l+1)):_=n[a],o(_,I?decodeURIComponent(I.replace(/\+/g," ")):"")}}}function Lt(n){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let o;n instanceof Lt?(this.l=n.l,Oe(this,n.j),this.o=n.o,this.g=n.g,Me(this,n.u),this.h=n.h,Ar(this,Ci(n.i)),this.m=n.m):n&&(o=String(n).match(vi))?(this.l=!1,Oe(this,o[1]||"",!0),this.o=Fe(o[2]||""),this.g=Fe(o[3]||"",!0),Me(this,o[4]),this.h=Fe(o[5]||"",!0),Ar(this,o[6]||"",!0),this.m=Fe(o[7]||"")):(this.l=!1,this.i=new Be(null,this.l))}Lt.prototype.toString=function(){let n=[];var o=this.j;o&&n.push(Le(o,bi,!0),":");var a=this.g;return(a||o=="file")&&(n.push("//"),(o=this.o)&&n.push(Le(o,bi,!0),"@"),n.push(ke(a).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a=this.u,a!=null&&n.push(":",String(a))),(a=this.h)&&(this.g&&a.charAt(0)!="/"&&n.push("/"),n.push(Le(a,a.charAt(0)=="/"?Fc:Mc,!0))),(a=this.i.toString())&&n.push("?",a),(a=this.m)&&n.push("#",Le(a,Bc)),n.join("")},Lt.prototype.resolve=function(n){let o=_t(this),a=!!n.j;a?Oe(o,n.j):a=!!n.o,a?o.o=n.o:a=!!n.g,a?o.g=n.g:a=n.u!=null;var l=n.h;if(a)Me(o,n.u);else if(a=!!n.h){if(l.charAt(0)!="/")if(this.g&&!this.h)l="/"+l;else{var _=o.h.lastIndexOf("/");_!=-1&&(l=o.h.slice(0,_+1)+l)}if(_=l,_==".."||_==".")l="";else if(_.indexOf("./")!=-1||_.indexOf("/.")!=-1){l=_.lastIndexOf("/",0)==0,_=_.split("/");let I=[];for(let v=0;v<_.length;){let k=_[v++];k=="."?l&&v==_.length&&I.push(""):k==".."?((I.length>1||I.length==1&&I[0]!="")&&I.pop(),l&&v==_.length&&I.push("")):(I.push(k),l=!0)}l=I.join("/")}else l=_}return a?o.h=l:a=n.i.toString()!=="",a?Ar(o,Ci(n.i)):a=!!n.m,a&&(o.m=n.m),o};function _t(n){return new Lt(n)}function Oe(n,o,a){n.j=a?Fe(o,!0):o,n.j&&(n.j=n.j.replace(/:$/,""))}function Me(n,o){if(o){if(o=Number(o),isNaN(o)||o<0)throw Error("Bad port number "+o);n.u=o}else n.u=null}function Ar(n,o,a){o instanceof Be?(n.i=o,Uc(n.i,n.l)):(a||(o=Le(o,Lc)),n.i=new Be(o,n.l))}function j(n,o,a){n.i.set(o,a)}function gn(n){return j(n,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),n}function Fe(n,o){return n?o?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Le(n,o,a){return typeof n=="string"?(n=encodeURI(n).replace(o,Oc),a&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Oc(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var bi=/[#\/\?@]/g,Mc=/[#\?:]/g,Fc=/[#\?]/g,Lc=/[#\?@]/g,Bc=/#/g;function Be(n,o){this.h=this.g=null,this.i=n||null,this.j=!!o}function Yt(n){n.g||(n.g=new Map,n.h=0,n.i&&Nc(n.i,function(o,a){n.add(decodeURIComponent(o.replace(/\+/g," ")),a)}))}r=Be.prototype,r.add=function(n,o){Yt(this),this.i=null,n=ue(this,n);let a=this.g.get(n);return a||this.g.set(n,a=[]),a.push(o),this.h+=1,this};function Ai(n,o){Yt(n),o=ue(n,o),n.g.has(o)&&(n.i=null,n.h-=n.g.get(o).length,n.g.delete(o))}function Si(n,o){return Yt(n),o=ue(n,o),n.g.has(o)}r.forEach=function(n,o){Yt(this),this.g.forEach(function(a,l){a.forEach(function(_){n.call(o,_,l,this)},this)},this)};function Ri(n,o){Yt(n);let a=[];if(typeof o=="string")Si(n,o)&&(a=a.concat(n.g.get(ue(n,o))));else for(n=Array.from(n.g.values()),o=0;o<n.length;o++)a=a.concat(n[o]);return a}r.set=function(n,o){return Yt(this),this.i=null,n=ue(this,n),Si(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[o]),this.h+=1,this},r.get=function(n,o){return n?(n=Ri(this,n),n.length>0?String(n[0]):o):o};function Pi(n,o,a){Ai(n,o),a.length>0&&(n.i=null,n.g.set(ue(n,o),O(a)),n.h+=a.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";let n=[],o=Array.from(this.g.keys());for(let l=0;l<o.length;l++){var a=o[l];let _=ke(a);a=Ri(this,a);for(let I=0;I<a.length;I++){let v=_;a[I]!==""&&(v+="="+ke(a[I])),n.push(v)}}return this.i=n.join("&")};function Ci(n){let o=new Be;return o.i=n.i,n.g&&(o.g=new Map(n.g),o.h=n.h),o}function ue(n,o){return o=String(o),n.j&&(o=o.toLowerCase()),o}function Uc(n,o){o&&!n.j&&(Yt(n),n.i=null,n.g.forEach(function(a,l){let _=l.toLowerCase();l!=_&&(Ai(this,l),Pi(this,_,a))},n)),n.j=o}function qc(n,o){let a=new Ve;if(u.Image){let l=new Image;l.onload=R(Bt,a,"TestLoadImage: loaded",!0,o,l),l.onerror=R(Bt,a,"TestLoadImage: error",!1,o,l),l.onabort=R(Bt,a,"TestLoadImage: abort",!1,o,l),l.ontimeout=R(Bt,a,"TestLoadImage: timeout",!1,o,l),u.setTimeout(function(){l.ontimeout&&l.ontimeout()},1e4),l.src=n}else o(!1)}function jc(n,o){let a=new Ve,l=new AbortController,_=setTimeout(()=>{l.abort(),Bt(a,"TestPingServer: timeout",!1,o)},1e4);fetch(n,{signal:l.signal}).then(I=>{clearTimeout(_),I.ok?Bt(a,"TestPingServer: ok",!0,o):Bt(a,"TestPingServer: server error",!1,o)}).catch(()=>{clearTimeout(_),Bt(a,"TestPingServer: error",!1,o)})}function Bt(n,o,a,l,_){try{_&&(_.onload=null,_.onerror=null,_.onabort=null,_.ontimeout=null),l(a)}catch{}}function zc(){this.g=new Ac}function yn(n){this.i=n.Sb||null,this.h=n.ab||!1}b(yn,ii),yn.prototype.g=function(){return new _n(this.i,this.h)};function _n(n,o){et.call(this),this.H=n,this.o=o,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(_n,et),r=_n.prototype,r.open=function(n,o){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=n,this.D=o,this.readyState=1,qe(this)},r.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let o={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};n&&(o.body=n),(this.H||u).fetch(new Request(this.D,o)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ue(this)),this.readyState=0},r.Pa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,qe(this)),this.g&&(this.readyState=3,qe(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Di(this)}else n.text().then(this.Oa.bind(this),this.ga.bind(this))};function Di(n){n.j.read().then(n.Ma.bind(n)).catch(n.ga.bind(n))}r.Ma=function(n){if(this.g){if(this.o&&n.value)this.response.push(n.value);else if(!this.o){var o=n.value?n.value:new Uint8Array(0);(o=this.B.decode(o,{stream:!n.done}))&&(this.response=this.responseText+=o)}n.done?Ue(this):qe(this),this.readyState==3&&Di(this)}},r.Oa=function(n){this.g&&(this.response=this.responseText=n,Ue(this))},r.Na=function(n){this.g&&(this.response=n,Ue(this))},r.ga=function(){this.g&&Ue(this)};function Ue(n){n.readyState=4,n.l=null,n.j=null,n.B=null,qe(n)}r.setRequestHeader=function(n,o){this.A.append(n,o)},r.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";let n=[],o=this.h.entries();for(var a=o.next();!a.done;)a=a.value,n.push(a[0]+": "+a[1]),a=o.next();return n.join(`\r
`)};function qe(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(_n.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});function xi(n){let o="";return ln(n,function(a,l){o+=l,o+=":",o+=a,o+=`\r
`}),o}function Sr(n,o,a){t:{for(l in a){var l=!1;break t}l=!0}l||(a=xi(a),typeof n=="string"?a!=null&&ke(a):j(n,o,a))}function $(n){et.call(this),this.headers=new Map,this.L=n||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b($,et);var $c=/^https?$/i,Gc=["POST","PUT"];r=$.prototype,r.Fa=function(n){this.H=n},r.ea=function(n,o,a,l){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+n);o=o?o.toUpperCase():"GET",this.D=n,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():di.g(),this.g.onreadystatechange=A(T(this.Ca,this));try{this.B=!0,this.g.open(o,String(n),!0),this.B=!1}catch(I){Vi(this,I);return}if(n=a||"",a=new Map(this.headers),l)if(Object.getPrototypeOf(l)===Object.prototype)for(var _ in l)a.set(_,l[_]);else if(typeof l.keys=="function"&&typeof l.get=="function")for(let I of l.keys())a.set(I,l.get(I));else throw Error("Unknown input type for opt_headers: "+String(l));l=Array.from(a.keys()).find(I=>I.toLowerCase()=="content-type"),_=u.FormData&&n instanceof u.FormData,!(Array.prototype.indexOf.call(Gc,o,void 0)>=0)||l||_||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[I,v]of a)this.g.setRequestHeader(I,v);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(n),this.v=!1}catch(I){Vi(this,I)}};function Vi(n,o){n.h=!1,n.g&&(n.j=!0,n.g.abort(),n.j=!1),n.l=o,n.o=5,ki(n),wn(n)}function ki(n){n.A||(n.A=!0,rt(n,"complete"),rt(n,"error"))}r.abort=function(n){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=n||7,rt(this,"complete"),rt(this,"abort"),wn(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),wn(this,!0)),$.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?Ni(this):this.Xa())},r.Xa=function(){Ni(this)};function Ni(n){if(n.h&&typeof c<"u"){if(n.v&&Ut(n)==4)setTimeout(n.Ca.bind(n),0);else if(rt(n,"readystatechange"),Ut(n)==4){n.h=!1;try{let I=n.ca();t:switch(I){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var o=!0;break t;default:o=!1}var a;if(!(a=o)){var l;if(l=I===0){let v=String(n.D).match(vi)[1]||null;!v&&u.self&&u.self.location&&(v=u.self.location.protocol.slice(0,-1)),l=!$c.test(v?v.toLowerCase():"")}a=l}if(a)rt(n,"complete"),rt(n,"success");else{n.o=6;try{var _=Ut(n)>2?n.g.statusText:""}catch{_=""}n.l=_+" ["+n.ca()+"]",ki(n)}}finally{wn(n)}}}}function wn(n,o){if(n.g){n.m&&(clearTimeout(n.m),n.m=null);let a=n.g;n.g=null,o||rt(n,"ready");try{a.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function Ut(n){return n.g?n.g.readyState:0}r.ca=function(){try{return Ut(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(n){if(this.g){var o=this.g.responseText;return n&&o.indexOf(n)==0&&(o=o.substring(n.length)),bc(o)}};function Oi(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.F){case"":case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Kc(n){let o={};n=(n.g&&Ut(n)>=2&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let l=0;l<n.length;l++){if(d(n[l]))continue;var a=Dc(n[l]);let _=a[0];if(a=a[1],typeof a!="string")continue;a=a.trim();let I=o[_]||[];o[_]=I,I.push(a)}wc(o,function(l){return l.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function je(n,o,a){return a&&a.internalChannelParams&&a.internalChannelParams[n]||o}function Mi(n){this.za=0,this.i=[],this.j=new Ve,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=je("failFast",!1,n),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=je("baseRetryDelayMs",5e3,n),this.Za=je("retryDelaySeedMs",1e4,n),this.Ta=je("forwardChannelMaxRetries",2,n),this.va=je("forwardChannelRequestTimeoutMs",2e4,n),this.ma=n&&n.xmlHttpFactory||void 0,this.Ua=n&&n.Rb||void 0,this.Aa=n&&n.useFetchStreams||!1,this.O=void 0,this.L=n&&n.supportsCrossDomainXhr||!1,this.M="",this.h=new _i(n&&n.concurrentRequestLimit),this.Ba=new zc,this.S=n&&n.fastHandshake||!1,this.R=n&&n.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=n&&n.Pb||!1,n&&n.ua&&this.j.ua(),n&&n.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&n&&n.detectBufferingProxy||!1,this.ia=void 0,n&&n.longPollingTimeout&&n.longPollingTimeout>0&&(this.ia=n.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=Mi.prototype,r.ka=8,r.I=1,r.connect=function(n,o,a,l){st(0),this.W=n,this.H=o||{},a&&l!==void 0&&(this.H.OSID=a,this.H.OAID=l),this.F=this.X,this.J=Gi(this,null,this.W),En(this)};function Rr(n){if(Fi(n),n.I==3){var o=n.V++,a=_t(n.J);if(j(a,"SID",n.M),j(a,"RID",o),j(a,"TYPE","terminate"),ze(n,a),o=new Ft(n,n.j,o),o.M=2,o.A=gn(_t(a)),a=!1,u.navigator&&u.navigator.sendBeacon)try{a=u.navigator.sendBeacon(o.A.toString(),"")}catch{}!a&&u.Image&&(new Image().src=o.A,a=!0),a||(o.g=Ki(o.j,null),o.g.ea(o.A)),o.F=Date.now(),pn(o)}$i(n)}function In(n){n.g&&(Cr(n),n.g.cancel(),n.g=null)}function Fi(n){In(n),n.v&&(u.clearTimeout(n.v),n.v=null),Tn(n),n.h.cancel(),n.m&&(typeof n.m=="number"&&u.clearTimeout(n.m),n.m=null)}function En(n){if(!wi(n.h)&&!n.m){n.m=!0;var o=n.Ea;Pt||h(),at||(Pt(),at=!0),g.add(o,n),n.D=0}}function Hc(n,o){return Ii(n.h)>=n.h.j-(n.m?1:0)?!1:n.m?(n.i=o.G.concat(n.i),!0):n.I==1||n.I==2||n.D>=(n.Sa?0:n.Ta)?!1:(n.m=xe(T(n.Ea,n,o),zi(n,n.D)),n.D++,!0)}r.Ea=function(n){if(this.m)if(this.m=null,this.I==1){if(!n){this.V=Math.floor(Math.random()*1e5),n=this.V++;let _=new Ft(this,this.j,n),I=this.o;if(this.U&&(I?(I=Ws(I),Ys(I,this.U)):I=this.U),this.u!==null||this.R||(_.J=I,I=null),this.S)t:{for(var o=0,a=0;a<this.i.length;a++){e:{var l=this.i[a];if("__data__"in l.map&&(l=l.map.__data__,typeof l=="string")){l=l.length;break e}l=void 0}if(l===void 0)break;if(o+=l,o>4096){o=a;break t}if(o===4096||a===this.i.length-1){o=a+1;break t}}o=1e3}else o=1e3;o=Bi(this,_,o),a=_t(this.J),j(a,"RID",n),j(a,"CVER",22),this.G&&j(a,"X-HTTP-Session-Id",this.G),ze(this,a),I&&(this.R?o="headers="+ke(xi(I))+"&"+o:this.u&&Sr(a,this.u,I)),br(this.h,_),this.Ra&&j(a,"TYPE","init"),this.S?(j(a,"$req",o),j(a,"SID","null"),_.U=!0,Ir(_,a,null)):Ir(_,a,o),this.I=2}}else this.I==3&&(n?Li(this,n):this.i.length==0||wi(this.h)||Li(this))};function Li(n,o){var a;o?a=o.l:a=n.V++;let l=_t(n.J);j(l,"SID",n.M),j(l,"RID",a),j(l,"AID",n.K),ze(n,l),n.u&&n.o&&Sr(l,n.u,n.o),a=new Ft(n,n.j,a,n.D+1),n.u===null&&(a.J=n.o),o&&(n.i=o.G.concat(n.i)),o=Bi(n,a,1e3),a.H=Math.round(n.va*.5)+Math.round(n.va*.5*Math.random()),br(n.h,a),Ir(a,l,o)}function ze(n,o){n.H&&ln(n.H,function(a,l){j(o,l,a)}),n.l&&ln({},function(a,l){j(o,l,a)})}function Bi(n,o,a){a=Math.min(n.i.length,a);let l=n.l?T(n.l.Ka,n.l,n):null;t:{var _=n.i;let k=-1;for(;;){let W=["count="+a];k==-1?a>0?(k=_[0].g,W.push("ofs="+k)):k=0:W.push("ofs="+k);let U=!0;for(let Q=0;Q<a;Q++){var I=_[Q].g;let wt=_[Q].map;if(I-=k,I<0)k=Math.max(0,_[Q].g-100),U=!1;else try{I="req"+I+"_"||"";try{var v=wt instanceof Map?wt:Object.entries(wt);for(let[Xt,qt]of v){let jt=qt;m(qt)&&(jt=pr(qt)),W.push(I+Xt+"="+encodeURIComponent(jt))}}catch(Xt){throw W.push(I+"type="+encodeURIComponent("_badmap")),Xt}}catch{l&&l(wt)}}if(U){v=W.join("&");break t}}v=void 0}return n=n.i.splice(0,a),o.G=n,v}function Ui(n){if(!n.g&&!n.v){n.Y=1;var o=n.Da;Pt||h(),at||(Pt(),at=!0),g.add(o,n),n.A=0}}function Pr(n){return n.g||n.v||n.A>=3?!1:(n.Y++,n.v=xe(T(n.Da,n),zi(n,n.A)),n.A++,!0)}r.Da=function(){if(this.v=null,qi(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var n=4*this.T;this.j.info("BP detection timer enabled: "+n),this.B=xe(T(this.Wa,this),n)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,st(10),In(this),qi(this))};function Cr(n){n.B!=null&&(u.clearTimeout(n.B),n.B=null)}function qi(n){n.g=new Ft(n,n.j,"rpc",n.Y),n.u===null&&(n.g.J=n.o),n.g.P=0;var o=_t(n.na);j(o,"RID","rpc"),j(o,"SID",n.M),j(o,"AID",n.K),j(o,"CI",n.F?"0":"1"),!n.F&&n.ia&&j(o,"TO",n.ia),j(o,"TYPE","xmlhttp"),ze(n,o),n.u&&n.o&&Sr(o,n.u,n.o),n.O&&(n.g.H=n.O);var a=n.g;n=n.ba,a.M=1,a.A=gn(_t(o)),a.u=null,a.R=!0,pi(a,n)}r.Va=function(){this.C!=null&&(this.C=null,In(this),Pr(this),st(19))};function Tn(n){n.C!=null&&(u.clearTimeout(n.C),n.C=null)}function ji(n,o){var a=null;if(n.g==o){Tn(n),Cr(n),n.g=null;var l=2}else if(vr(n.h,o))a=o.G,Ei(n.h,o),l=1;else return;if(n.I!=0){if(o.o)if(l==1){a=o.u?o.u.length:0,o=Date.now()-o.F;var _=n.D;l=fn(),rt(l,new li(l,a)),En(n)}else Ui(n);else if(_=o.m,_==3||_==0&&o.X>0||!(l==1&&Hc(n,o)||l==2&&Pr(n)))switch(a&&a.length>0&&(o=n.h,o.i=o.i.concat(a)),_){case 1:Jt(n,5);break;case 4:Jt(n,10);break;case 3:Jt(n,6);break;default:Jt(n,2)}}}function zi(n,o){let a=n.Qa+Math.floor(Math.random()*n.Za);return n.isActive()||(a*=2),a*o}function Jt(n,o){if(n.j.info("Error code "+o),o==2){var a=T(n.bb,n),l=n.Ua;let _=!l;l=new Lt(l||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Oe(l,"https"),gn(l),_?qc(l.toString(),a):jc(l.toString(),a)}else st(2);n.I=0,n.l&&n.l.pa(o),$i(n),Fi(n)}r.bb=function(n){n?(this.j.info("Successfully pinged google.com"),st(2)):(this.j.info("Failed to ping google.com"),st(1))};function $i(n){if(n.I=0,n.ja=[],n.l){let o=Ti(n.h);(o.length!=0||n.i.length!=0)&&(x(n.ja,o),x(n.ja,n.i),n.h.i.length=0,O(n.i),n.i.length=0),n.l.oa()}}function Gi(n,o,a){var l=a instanceof Lt?_t(a):new Lt(a);if(l.g!="")o&&(l.g=o+"."+l.g),Me(l,l.u);else{var _=u.location;l=_.protocol,o=o?o+"."+_.hostname:_.hostname,_=+_.port;let I=new Lt(null);l&&Oe(I,l),o&&(I.g=o),_&&Me(I,_),a&&(I.h=a),l=I}return a=n.G,o=n.wa,a&&o&&j(l,a,o),j(l,"VER",n.ka),ze(n,l),l}function Ki(n,o,a){if(o&&!n.L)throw Error("Can't create secondary domain capable XhrIo object.");return o=n.Aa&&!n.ma?new $(new yn({ab:a})):new $(n.ma),o.Fa(n.L),o}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hi(){}r=Hi.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function vn(){}vn.prototype.g=function(n,o){return new lt(n,o)};function lt(n,o){et.call(this),this.g=new Mi(o),this.l=n,this.h=o&&o.messageUrlParams||null,n=o&&o.messageHeaders||null,o&&o.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.o=n,n=o&&o.initMessageHeaders||null,o&&o.messageContentType&&(n?n["X-WebChannel-Content-Type"]=o.messageContentType:n={"X-WebChannel-Content-Type":o.messageContentType}),o&&o.sa&&(n?n["X-WebChannel-Client-Profile"]=o.sa:n={"X-WebChannel-Client-Profile":o.sa}),this.g.U=n,(n=o&&o.Qb)&&!d(n)&&(this.g.u=n),this.A=o&&o.supportsCrossDomainXhr||!1,this.v=o&&o.sendRawJson||!1,(o=o&&o.httpSessionIdParam)&&!d(o)&&(this.g.G=o,n=this.h,n!==null&&o in n&&(n=this.h,o in n&&delete n[o])),this.j=new le(this)}b(lt,et),lt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},lt.prototype.close=function(){Rr(this.g)},lt.prototype.o=function(n){var o=this.g;if(typeof n=="string"){var a={};a.__data__=n,n=a}else this.v&&(a={},a.__data__=pr(n),n=a);o.i.push(new kc(o.Ya++,n)),o.I==3&&En(o)},lt.prototype.N=function(){this.g.l=null,delete this.j,Rr(this.g),delete this.g,lt.Z.N.call(this)};function Wi(n){gr.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var o=n.__sm__;if(o){t:{for(let a in o){n=a;break t}n=void 0}(this.i=n)&&(n=this.i,o=o!==null&&n in o?o[n]:void 0),this.data=o}else this.data=n}b(Wi,gr);function Qi(){yr.call(this),this.status=1}b(Qi,yr);function le(n){this.g=n}b(le,Hi),le.prototype.ra=function(){rt(this.g,"a")},le.prototype.qa=function(n){rt(this.g,new Wi(n))},le.prototype.pa=function(n){rt(this.g,new Qi)},le.prototype.oa=function(){rt(this.g,"b")},vn.prototype.createWebChannel=vn.prototype.g,lt.prototype.send=lt.prototype.o,lt.prototype.open=lt.prototype.m,lt.prototype.close=lt.prototype.close,os=Vt.createWebChannelTransport=function(){return new vn},is=Vt.getStatEventTarget=function(){return fn()},ss=Vt.Event=Wt,Mn=Vt.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},mn.NO_ERROR=0,mn.TIMEOUT=8,mn.HTTP_ERROR=6,tn=Vt.ErrorCode=mn,hi.COMPLETE="complete",rs=Vt.EventType=hi,oi.EventType=Ce,Ce.OPEN="a",Ce.CLOSE="b",Ce.ERROR="c",Ce.MESSAGE="d",et.prototype.listen=et.prototype.J,me=Vt.WebChannel=oi,Il=Vt.FetchXmlHttpFactory=yn,$.prototype.listenOnce=$.prototype.K,$.prototype.getLastError=$.prototype.Ha,$.prototype.getLastErrorCode=$.prototype.ya,$.prototype.getStatus=$.prototype.ca,$.prototype.getResponseJson=$.prototype.La,$.prototype.getResponseText=$.prototype.la,$.prototype.send=$.prototype.ea,$.prototype.setWithCredentials=$.prototype.Fa,ns=Vt.XhrIo=$}).apply(typeof On<"u"?On:typeof self<"u"?self:typeof window<"u"?window:{});var X=class{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}};X.UNAUTHENTICATED=new X(null),X.GOOGLE_CREDENTIALS=new X("google-credentials-uid"),X.FIRST_PARTY=new X("first-party-uid"),X.MOCK_USER=new X("mock-user");var Te="12.8.0";function oa(r){Te=r}var we=new $t("@firebase/firestore");function L(r,...t){if(we.logLevel<=B.DEBUG){let e=t.map(vs);we.debug(`Firestore (${Te}): ${r}`,...e)}}function Ts(r,...t){if(we.logLevel<=B.ERROR){let e=t.map(vs);we.error(`Firestore (${Te}): ${r}`,...e)}}function an(r,...t){if(we.logLevel<=B.WARN){let e=t.map(vs);we.warn(`Firestore (${Te}): ${r}`,...e)}}function vs(r){if(typeof r=="string")return r;try{return function(e){return JSON.stringify(e)}(r)}catch{return r}}function Z(r,t,e){let s="Unexpected state";typeof t=="string"?s=t:e=t,aa(r,s,e)}function aa(r,t,e){let s=`FIRESTORE (${Te}) INTERNAL ASSERTION FAILED: ${t} (ID: ${r.toString(16)})`;if(e!==void 0)try{s+=" CONTEXT: "+JSON.stringify(e)}catch{s+=" CONTEXT: "+e}throw Ts(s),new Error(s)}function Ht(r,t,e,s){let i="Unexpected state";typeof e=="string"?i=e:s=e,r||aa(t,i,s)}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends ht{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var re=class{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}};var Ln=class{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}},Bn=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(X.UNAUTHENTICATED))}shutdown(){}},ls=class{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}},Un=class{constructor(t){this.t=t,this.currentUser=X.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){Ht(this.o===void 0,42304);let s=this.i,i=E=>this.i!==s?(s=this.i,e(E)):Promise.resolve(),c=new re;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new re,t.enqueueRetryable(()=>i(this.currentUser))};let u=()=>{let E=c;t.enqueueRetryable(()=>S(this,null,function*(){yield E.promise,yield i(this.currentUser)}))},m=E=>{L("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=E,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(E=>m(E)),setTimeout(()=>{if(!this.auth){let E=this.t.getImmediate({optional:!0});E?m(E):(L("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new re)}},0),u()}getToken(){let t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(s=>this.i!==t?(L("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Ht(typeof s.accessToken=="string",31837,{l:s}),new Ln(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let t=this.auth&&this.auth.getUid();return Ht(t===null||typeof t=="string",2055,{h:t}),new X(t)}},hs=class{constructor(t,e,s){this.P=t,this.T=e,this.I=s,this.type="FirstParty",this.user=X.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let t=this.A();return t&&this.R.set("Authorization",t),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},ds=class{constructor(t,e,s){this.P=t,this.T=e,this.I=s}getToken(){return Promise.resolve(new hs(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable(()=>e(X.FIRST_PARTY))}shutdown(){}invalidateToken(){}},qn=class{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},jn=class{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$o(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){Ht(this.o===void 0,3512);let s=c=>{c.error!=null&&L("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);let u=c.token!==this.m;return this.m=c.token,L("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?e(c.token):Promise.resolve()};this.o=c=>{t.enqueueRetryable(()=>s(c))};let i=c=>{L("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(c=>i(c)),setTimeout(()=>{if(!this.appCheck){let c=this.V.getImmediate({optional:!0});c?i(c):L("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new qn(this.p));let t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(Ht(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new qn(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function El(r){let t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(r);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let s=0;s<r;s++)e[s]=Math.floor(256*Math.random());return e}var rn=class{static newId(){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516),s="";for(;s.length<20;){let i=El(40);for(let c=0;c<i.length;++c)s.length<20&&i[c]<e&&(s+=t.charAt(i[c]%62))}return s}};function Nt(r,t){return r<t?-1:r>t?1:0}function Tl(r,t){let e=Math.min(r.length,t.length);for(let s=0;s<e;s++){let i=r.charAt(s),c=t.charAt(s);if(i!==c)return as(i)===as(c)?Nt(i,c):as(i)?1:-1}return Nt(r.length,t.length)}var vl=55296,bl=57343;function as(r){let t=r.charCodeAt(0);return t>=vl&&t<=bl}var Jo="__name__",zn=class r{constructor(t,e,s){e===void 0?e=0:e>t.length&&Z(637,{offset:e,range:t.length}),s===void 0?s=t.length-e:s>t.length-e&&Z(1746,{length:s,range:t.length-e}),this.segments=t,this.offset=e,this.len=s}get length(){return this.len}isEqual(t){return r.comparator(this,t)===0}child(t){let e=this.segments.slice(this.offset,this.limit());return t instanceof r?t.forEach(s=>{e.push(s)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,s=this.limit();e<s;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){let s=Math.min(t.length,e.length);for(let i=0;i<s;i++){let c=r.compareSegments(t.get(i),e.get(i));if(c!==0)return c}return Nt(t.length,e.length)}static compareSegments(t,e){let s=r.isNumericId(t),i=r.isNumericId(e);return s&&!i?-1:!s&&i?1:s&&i?r.extractNumericId(t).compare(r.extractNumericId(e)):Tl(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Nn.fromString(t.substring(4,t.length-2))}},At=class r extends zn{construct(t,e,s){return new r(t,e,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){let e=[];for(let s of t){if(s.indexOf("//")>=0)throw new D(P.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);e.push(...s.split("/").filter(i=>i.length>0))}return new r(e)}static emptyPath(){return new r([])}},Al=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$n=class r extends zn{construct(t,e,s){return new r(t,e,s)}static isValidIdentifier(t){return Al.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Jo}static keyField(){return new r([Jo])}static fromServerFormat(t){let e=[],s="",i=0,c=()=>{if(s.length===0)throw new D(P.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(s),s=""},u=!1;for(;i<t.length;){let m=t[i];if(m==="\\"){if(i+1===t.length)throw new D(P.INVALID_ARGUMENT,"Path has trailing escape character: "+t);let E=t[i+1];if(E!=="\\"&&E!=="."&&E!=="`")throw new D(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);s+=E,i+=2}else m==="`"?(u=!u,i++):m!=="."||u?(s+=m,i++):(c(),i++)}if(c(),u)throw new D(P.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new r(e)}static emptyPath(){return new r([])}};var yt=class r{constructor(t){this.path=t}static fromPath(t){return new r(At.fromString(t))}static fromName(t){return new r(At.fromString(t).popFirst(5))}static empty(){return new r(At.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&At.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return At.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new r(new At(t.slice()))}};function ca(r,t,e,s){if(t===!0&&s===!0)throw new D(P.INVALID_ARGUMENT,`${r} and ${e} cannot be used together.`)}function Sl(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function ua(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{let t=function(s){return s.constructor?s.constructor.name:null}(r);return t?`a custom ${t} object`:"an object"}}return typeof r=="function"?"a function":Z(12329,{type:typeof r})}function bs(r,t){if("_delegate"in r&&(r=r._delegate),!(r instanceof t)){if(t.name===r.constructor.name)throw new D(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let e=ua(r);throw new D(P.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return r}function K(r,t){let e={typeString:r};return t&&(e.value=t),e}function ve(r,t){if(!Sl(r))throw new D(P.INVALID_ARGUMENT,"JSON must be an object");let e;for(let s in t)if(t[s]){let i=t[s].typeString,c="value"in t[s]?{value:t[s].value}:void 0;if(!(s in r)){e=`JSON missing required field: '${s}'`;break}let u=r[s];if(i&&typeof u!==i){e=`JSON field '${s}' must be a ${i}.`;break}if(c!==void 0&&u!==c.value){e=`Expected '${s}' field to equal '${c.value}'`;break}}if(e)throw new D(P.INVALID_ARGUMENT,e);return!0}var Xo=-62135596800,Zo=1e6,ge=class r{static now(){return r.fromMillis(Date.now())}static fromDate(t){return r.fromMillis(t.getTime())}static fromMillis(t){let e=Math.floor(t/1e3),s=Math.floor((t-1e3*e)*Zo);return new r(e,s)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new D(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new D(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<Xo)throw new D(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new D(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Zo}_compareTo(t){return this.seconds===t.seconds?Nt(this.nanoseconds,t.nanoseconds):Nt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:r._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(ve(t,r._jsonSchema))return new r(t.seconds,t.nanoseconds)}valueOf(){let t=this.seconds-Xo;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};ge._jsonSchemaVersion="firestore/timestamp/1.0",ge._jsonSchema={type:K("string",ge._jsonSchemaVersion),seconds:K("number"),nanoseconds:K("number")};var Gn=class{constructor(t,e,s,i){this.indexId=t,this.collectionGroup=e,this.fields=s,this.indexState=i}};Gn.UNKNOWN_ID=-1;function Rl(r){return r.name==="IndexedDbTransactionError"}function Pl(r){return r===0&&1/r==-1/0}var Cl="remoteDocuments",la="owner";var ha="mutationQueues";var da="mutations";var fa="documentMutations",Dl="remoteDocumentsV14";var ma="remoteDocumentGlobal";var pa="targets";var ga="targetDocuments";var ya="targetGlobal",_a="collectionParents";var wa="clientMetadata";var Ia="bundles";var Ea="namedQueries";var xl="indexConfiguration";var Vl="indexState";var kl="indexEntries";var Ta="documentOverlays";var Nl="globals";var Ol=[ha,da,fa,Cl,pa,la,ya,ga,wa,ma,_a,Ia,Ea],mp=[...Ol,Ta],Ml=[ha,da,fa,Dl,pa,la,ya,ga,wa,ma,_a,Ia,Ea,Ta],Fl=Ml,Ll=[...Fl,xl,Vl,kl];var pp=[...Ll,Nl];var Ie=class r{constructor(t,e){this.comparator=t,this.root=e||St.EMPTY}insert(t,e){return new r(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,St.BLACK,null,null))}remove(t){return new r(this.comparator,this.root.remove(t,this.comparator).copy(null,null,St.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){let s=this.comparator(t,e.key);if(s===0)return e.value;s<0?e=e.left:s>0&&(e=e.right)}return null}indexOf(t){let e=0,s=this.root;for(;!s.isEmpty();){let i=this.comparator(t,s.key);if(i===0)return e+s.left.size;i<0?s=s.left:(e+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,s)=>(t(e,s),!1))}toString(){let t=[];return this.inorderTraversal((e,s)=>(t.push(`${e}:${s}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new pe(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new pe(this.root,t,this.comparator,!1)}getReverseIterator(){return new pe(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new pe(this.root,t,this.comparator,!0)}},pe=class{constructor(t,e,s,i){this.isReverse=i,this.nodeStack=[];let c=1;for(;!t.isEmpty();)if(c=e?s(t.key,e):1,e&&i&&(c*=-1),c<0)t=this.isReverse?t.left:t.right;else{if(c===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}},St=class r{constructor(t,e,s,i,c){this.key=t,this.value=e,this.color=s??r.RED,this.left=i??r.EMPTY,this.right=c??r.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,s,i,c){return new r(t??this.key,e??this.value,s??this.color,i??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,s){let i=this,c=s(t,i.key);return i=c<0?i.copy(null,null,null,i.left.insert(t,e,s),null):c===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return r.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let s,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return r.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,r.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Z(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Z(14113,{key:this.key,value:this.value});let t=this.left.check();if(t!==this.right.check())throw Z(27949);return t+(this.isRed()?0:1)}};St.EMPTY=null,St.RED=!0,St.BLACK=!1;St.EMPTY=new class{constructor(){this.size=0}get key(){throw Z(57766)}get value(){throw Z(16141)}get color(){throw Z(16727)}get left(){throw Z(29726)}get right(){throw Z(36894)}copy(t,e,s,i,c){return this}insert(t,e,s){return new St(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Kn=class r{constructor(t){this.comparator=t,this.data=new Ie(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,s)=>(t(e),!1))}forEachInRange(t,e){let s=this.data.getIteratorFrom(t[0]);for(;s.hasNext();){let i=s.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let s;for(s=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();s.hasNext();)if(!t(s.getNext().key))return}firstAfterOrEqual(t){let e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Hn(this.data.getIterator())}getIteratorFrom(t){return new Hn(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(s=>{e=e.add(s)}),e}isEqual(t){if(!(t instanceof r)||this.size!==t.size)return!1;let e=this.data.getIterator(),s=t.data.getIterator();for(;e.hasNext();){let i=e.getNext().key,c=s.getNext().key;if(this.comparator(i,c)!==0)return!1}return!0}toArray(){let t=[];return this.forEach(e=>{t.push(e)}),t}toString(){let t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){let e=new r(this.comparator);return e.data=t,e}},Hn=class{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var fs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ot=class r{constructor(t){this.binaryString=t}static fromBase64String(t){let e=function(i){try{return atob(i)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new fs("Invalid base64 string: "+c):c}}(t);return new r(e)}static fromUint8Array(t){let e=function(i){let c="";for(let u=0;u<i.length;++u)c+=String.fromCharCode(i[u]);return c}(t);return new r(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){let s=new Uint8Array(e.length);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Nt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}};Ot.EMPTY_BYTE_STRING=new Ot("");var Bl=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ul(r){if(Ht(!!r,39018),typeof r=="string"){let t=0,e=Bl.exec(r);if(Ht(!!e,46558,{timestamp:r}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}let s=new Date(r);return{seconds:Math.floor(s.getTime()/1e3),nanos:t}}return{seconds:nn(r.seconds),nanos:nn(r.nanos)}}function nn(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function ql(r){return typeof r=="string"?Ot.fromBase64String(r):Ot.fromUint8Array(r)}var Wn="(default)",Qn=class r{constructor(t,e){this.projectId=t,this.database=e||Wn}static empty(){return new r("","")}get isDefaultDatabase(){return this.database===Wn}isEqual(t){return t instanceof r&&t.projectId===this.projectId&&t.database===this.database}};function va(r,t){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new D(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qn(r.options.projectId,t)}var ba="__type__",jl="__max__";var Aa="__vector__",Sa="value";function zl(r){return(r?.mapValue?.fields||{})[ba]?.stringValue===Aa}function $l(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===jl}var yp={mapValue:{fields:{[ba]:{stringValue:Aa},[Sa]:{arrayValue:{}}}}};var ms=class{constructor(t,e=null,s=[],i=[],c=null,u="F",m=null,E=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=s,this.filters=i,this.limit=c,this.limitType=u,this.startAt=m,this.endAt=E,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function Ra(r){return new ms(r)}var _p=new Ie(yt.comparator);var wp=new Ie(yt.comparator);var Ip=new Ie(yt.comparator),Ep=new Kn(yt.comparator);var Tp=new Kn(Nt);var H,F;function Gl(r){if(r===void 0)return Ts("GRPC error has no .code"),P.UNKNOWN;switch(r){case H.OK:return P.OK;case H.CANCELLED:return P.CANCELLED;case H.UNKNOWN:return P.UNKNOWN;case H.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case H.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case H.INTERNAL:return P.INTERNAL;case H.UNAVAILABLE:return P.UNAVAILABLE;case H.UNAUTHENTICATED:return P.UNAUTHENTICATED;case H.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case H.NOT_FOUND:return P.NOT_FOUND;case H.ALREADY_EXISTS:return P.ALREADY_EXISTS;case H.PERMISSION_DENIED:return P.PERMISSION_DENIED;case H.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case H.ABORTED:return P.ABORTED;case H.OUT_OF_RANGE:return P.OUT_OF_RANGE;case H.UNIMPLEMENTED:return P.UNIMPLEMENTED;case H.DATA_LOSS:return P.DATA_LOSS;default:return Z(39323,{code:r})}}(F=H||(H={}))[F.OK=0]="OK",F[F.CANCELLED=1]="CANCELLED",F[F.UNKNOWN=2]="UNKNOWN",F[F.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",F[F.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",F[F.NOT_FOUND=5]="NOT_FOUND",F[F.ALREADY_EXISTS=6]="ALREADY_EXISTS",F[F.PERMISSION_DENIED=7]="PERMISSION_DENIED",F[F.UNAUTHENTICATED=16]="UNAUTHENTICATED",F[F.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",F[F.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",F[F.ABORTED=10]="ABORTED",F[F.OUT_OF_RANGE=11]="OUT_OF_RANGE",F[F.UNIMPLEMENTED=12]="UNIMPLEMENTED",F[F.INTERNAL=13]="INTERNAL",F[F.UNAVAILABLE=14]="UNAVAILABLE",F[F.DATA_LOSS=15]="DATA_LOSS";var vp=new Nn([4294967295,4294967295],0);var Yn=class{constructor(){}Dt(t,e){this.Ct(t,e),e.vt()}Ct(t,e){if("nullValue"in t)this.Ft(e,5);else if("booleanValue"in t)this.Ft(e,10),e.Mt(t.booleanValue?1:0);else if("integerValue"in t)this.Ft(e,15),e.Mt(nn(t.integerValue));else if("doubleValue"in t){let s=nn(t.doubleValue);isNaN(s)?this.Ft(e,13):(this.Ft(e,15),Pl(s)?e.Mt(0):e.Mt(s))}else if("timestampValue"in t){let s=t.timestampValue;this.Ft(e,20),typeof s=="string"&&(s=Ul(s)),e.xt(`${s.seconds||""}`),e.Mt(s.nanos||0)}else if("stringValue"in t)this.Ot(t.stringValue,e),this.Nt(e);else if("bytesValue"in t)this.Ft(e,30),e.Bt(ql(t.bytesValue)),this.Nt(e);else if("referenceValue"in t)this.Lt(t.referenceValue,e);else if("geoPointValue"in t){let s=t.geoPointValue;this.Ft(e,45),e.Mt(s.latitude||0),e.Mt(s.longitude||0)}else"mapValue"in t?$l(t)?this.Ft(e,Number.MAX_SAFE_INTEGER):zl(t)?this.kt(t.mapValue,e):(this.Kt(t.mapValue,e),this.Nt(e)):"arrayValue"in t?(this.qt(t.arrayValue,e),this.Nt(e)):Z(19022,{Ut:t})}Ot(t,e){this.Ft(e,25),this.$t(t,e)}$t(t,e){e.xt(t)}Kt(t,e){let s=t.fields||{};this.Ft(e,55);for(let i of Object.keys(s))this.Ot(i,e),this.Ct(s[i],e)}kt(t,e){let s=t.fields||{};this.Ft(e,53);let i=Sa,c=s[i].arrayValue?.values?.length||0;this.Ft(e,15),e.Mt(nn(c)),this.Ot(i,e),this.Ct(s[i],e)}qt(t,e){let s=t.values||[];this.Ft(e,50);for(let i of s)this.Ct(i,e)}Lt(t,e){this.Ft(e,37),yt.fromName(t).path.forEach(s=>{this.Ft(e,60),this.$t(s,e)})}Ft(t,e){t.Mt(e)}Nt(t){t.Mt(2)}};Yn.Wt=new Yn;var bp=new Uint8Array(0);var Pa=41943040,bt=class r{static withCacheSize(t){return new r(t,r.DEFAULT_COLLECTION_PERCENTILE,r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,s){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=s}};bt.DEFAULT_COLLECTION_PERCENTILE=10,bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bt.DEFAULT=new bt(Pa,bt.DEFAULT_COLLECTION_PERCENTILE,bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bt.DISABLED=new bt(-1,0,0);var Kl=1048576;var Fn=null;function ps(){return Fn===null?Fn=function(){return 268435456+Math.round(2147483648*Math.random())}():Fn++,"0x"+Fn.toString(16)}var cs="RestConnection",Hl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},gs=class{get Ko(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let e=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=e+"://"+t.host,this.Uo=`projects/${s}/databases/${i}`,this.$o=this.databaseId.database===Wn?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Wo(t,e,s,i,c){let u=ps(),m=this.Qo(t,e.toUriEncodedString());L(cs,`Sending RPC '${t}' ${u}:`,m,s);let E={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(E,i,c);let{host:T}=new URL(m),R=Cn(T);return this.zo(t,m,E,s,R).then(b=>(L(cs,`Received RPC '${t}' ${u}: `,b),b),b=>{throw an(cs,`RPC '${t}' ${u} failed with error: `,b,"url: ",m,"request:",s),b})}jo(t,e,s,i,c,u){return this.Wo(t,e,s,i,c)}Go(t,e,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Te}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((i,c)=>t[c]=i),s&&s.headers.forEach((i,c)=>t[c]=i)}Qo(t,e){let s=Hl[t],i=`${this.qo}/v1/${e}:${s}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}};var ys=class{constructor(t){this.Ho=t.Ho,this.Jo=t.Jo}Zo(t){this.Xo=t}Yo(t){this.e_=t}t_(t){this.n_=t}onMessage(t){this.r_=t}close(){this.Jo()}send(t){this.Ho(t)}i_(){this.Xo()}s_(){this.e_()}o_(t){this.n_(t)}__(t){this.r_(t)}};var nt="WebChannelConnection",en=(r,t,e)=>{r.listen(t,s=>{try{e(s)}catch(i){setTimeout(()=>{throw i},0)}})},_s=class r extends gs{constructor(t){super(t),this.a_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}static u_(){if(!r.c_){let t=is();en(t,ss.STAT_EVENT,e=>{e.stat===Mn.PROXY?L(nt,"STAT_EVENT: detected buffering proxy"):e.stat===Mn.NOPROXY&&L(nt,"STAT_EVENT: detected no buffering proxy")}),r.c_=!0}}zo(t,e,s,i,c){let u=ps();return new Promise((m,E)=>{let T=new ns;T.setWithCredentials(!0),T.listenOnce(rs.COMPLETE,()=>{try{switch(T.getLastErrorCode()){case tn.NO_ERROR:let b=T.getResponseJson();L(nt,`XHR for RPC '${t}' ${u} received:`,JSON.stringify(b)),m(b);break;case tn.TIMEOUT:L(nt,`RPC '${t}' ${u} timed out`),E(new D(P.DEADLINE_EXCEEDED,"Request time out"));break;case tn.HTTP_ERROR:let A=T.getStatus();if(L(nt,`RPC '${t}' ${u} failed with status:`,A,"response text:",T.getResponseText()),A>0){let O=T.getResponseJson();Array.isArray(O)&&(O=O[0]);let x=O?.error;if(x&&x.status&&x.message){let M=function(Y){let J=Y.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(J)>=0?J:P.UNKNOWN}(x.status);E(new D(M,x.message))}else E(new D(P.UNKNOWN,"Server responded with status "+T.getStatus()))}else E(new D(P.UNAVAILABLE,"Connection failed."));break;default:Z(9055,{l_:t,streamId:u,h_:T.getLastErrorCode(),P_:T.getLastError()})}}finally{L(nt,`RPC '${t}' ${u} completed.`)}});let R=JSON.stringify(i);L(nt,`RPC '${t}' ${u} sending request:`,i),T.send(e,"POST",R,s,15)})}T_(t,e,s){let i=ps(),c=[this.qo,"/","google.firestore.v1.Firestore","/",t,"/channel"],u=this.createWebChannelTransport(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},E=this.longPollingOptions.timeoutSeconds;E!==void 0&&(m.longPollingTimeout=Math.round(1e3*E)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Go(m.initMessageHeaders,e,s),m.encodeInitMessageHeaders=!0;let T=c.join("");L(nt,`Creating RPC '${t}' stream ${i}: ${T}`,m);let R=u.createWebChannel(T,m);this.I_(R);let b=!1,A=!1,O=new ys({Ho:x=>{A?L(nt,`Not sending because RPC '${t}' stream ${i} is closed:`,x):(b||(L(nt,`Opening RPC '${t}' stream ${i} transport.`),R.open(),b=!0),L(nt,`RPC '${t}' stream ${i} sending:`,x),R.send(x))},Jo:()=>R.close()});return en(R,me.EventType.OPEN,()=>{A||(L(nt,`RPC '${t}' stream ${i} transport opened.`),O.i_())}),en(R,me.EventType.CLOSE,()=>{A||(A=!0,L(nt,`RPC '${t}' stream ${i} transport closed`),O.o_(),this.E_(R))}),en(R,me.EventType.ERROR,x=>{A||(A=!0,an(nt,`RPC '${t}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),O.o_(new D(P.UNAVAILABLE,"The operation could not be completed")))}),en(R,me.EventType.MESSAGE,x=>{if(!A){let M=x.data[0];Ht(!!M,16349);let q=M,Y=q?.error||q[0]?.error;if(Y){L(nt,`RPC '${t}' stream ${i} received error:`,Y);let J=Y.status,tt=function(at){let g=H[at];if(g!==void 0)return Gl(g)}(J),mt=Y.message;tt===void 0&&(tt=P.INTERNAL,mt="Unknown error status: "+J+" with message "+Y.message),A=!0,O.o_(new D(tt,mt)),R.close()}else L(nt,`RPC '${t}' stream ${i} received:`,M),O.__(M)}}),r.u_(),setTimeout(()=>{O.s_()},0),O}terminate(){this.a_.forEach(t=>t.close()),this.a_=[]}I_(t){this.a_.push(t)}E_(t){this.a_=this.a_.filter(e=>e===t)}Go(t,e,s){super.Go(t,e,s),this.databaseInfo.apiKey&&(t["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return os()}};function us(){return typeof document<"u"?document:null}_s.c_=!1;var ws=class{constructor(t,e,s=1e3,i=1.5,c=6e4){this.Ci=t,this.timerId=e,this.R_=s,this.A_=i,this.V_=c,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(t){this.cancel();let e=Math.floor(this.d_+this.y_()),s=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-s);i>0&&L("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${e} ms, last attempt: ${s} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),t())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var Is=class r{constructor(t,e,s,i,c){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=s,this.op=i,this.removalCallback=c,this.deferred=new re,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,s,i,c){let u=Date.now()+s,m=new r(t,e,u,i,c);return m.start(s),m}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(P.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};var ta,ea;(ea=ta||(ta={})).Ma="default",ea.Cache="cache";function Wl(r){let t={};return r.timeoutSeconds!==void 0&&(t.timeoutSeconds=r.timeoutSeconds),t}var Ql="ComponentProvider",na=new Map;var Ca="firestore.googleapis.com",ra=!0,Jn=class{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new D(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ca,this.ssl=ra}else this.host=t.host,this.ssl=t.ssl??ra;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Pa;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<Kl)throw new D(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}ca("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Wl(t.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new D(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new D(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new D(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(s,i){return s.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}},Xn=class{constructor(t,e,s,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jn({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new D(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new D(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jn(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new Bn;switch(s.type){case"firstParty":return new ds(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new D(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return S(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let s=na.get(e);s&&(L(Ql,"Removing Datastore"),na.delete(e),s.terminate())}(this),Promise.resolve()}};function Da(r,t,e,s={}){r=bs(r,Xn);let i=Cn(t),c=r._getSettings(),u=V(C({},c),{emulatorOptions:r._getEmulatorOptions()}),m=`${t}:${e}`;i&&(Ro(`https://${m}`),Co("Firestore",!0)),c.host!==Ca&&c.host!==m&&an("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let E=V(C({},c),{host:m,ssl:i,emulatorOptions:s});if(!Dt(E,u)&&(r._setSettings(E),s.mockUserToken)){let T,R;if(typeof s.mockUserToken=="string")T=s.mockUserToken,R=X.MOCK_USER;else{T=Po(s.mockUserToken,r._app?.options.projectId);let b=s.mockUserToken.sub||s.mockUserToken.user_id;if(!b)throw new D(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");R=new X(b)}r._authCredentials=new ls(new Ln(T,R))}}var sn=class r{constructor(t,e,s){this.converter=e,this._query=s,this.type="query",this.firestore=t}withConverter(t){return new r(this.firestore,t,this._query)}},kt=class r{constructor(t,e,s){this.converter=e,this._key=s,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new r(this.firestore,t,this._key)}toJSON(){return{type:r._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,s){if(ve(e,r._jsonSchema))return new r(t,s||null,new yt(At.fromString(e.referencePath)))}};kt._jsonSchemaVersion="firestore/documentReference/1.0",kt._jsonSchema={type:K("string",kt._jsonSchemaVersion),referencePath:K("string")};var Zn=class r extends sn{constructor(t,e,s){super(t,e,Ra(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let t=this._path.popLast();return t.isEmpty()?null:new kt(this.firestore,null,new yt(t))}withConverter(t){return new r(this.firestore,t,this._path)}};var sa="AsyncQueue",tr=class{constructor(t=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ws(this,"async_queue_retry"),this._c=()=>{let s=us();s&&L(sa,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=t;let e=us();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;let e=us();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});let e=new re;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Yu.push(t),this.lc()))}lc(){return S(this,null,function*(){if(this.Yu.length!==0){try{yield this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(t){if(!Rl(t))throw t;L(sa,"Operation failed with retryable error: "+t)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}})}cc(t){let e=this.ac.then(()=>(this.rc=!0,t().catch(s=>{throw this.nc=s,this.rc=!1,Ts("INTERNAL UNHANDLED ERROR: ",ia(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=e,e}enqueueAfterDelay(t,e,s){this.uc(),this.oc.indexOf(t)>-1&&(e=0);let i=Is.createAndSchedule(this,t,e,s,c=>this.hc(c));return this.tc.push(i),i}uc(){this.nc&&Z(47125,{Pc:ia(this.nc)})}verifyOperationInProgress(){}Tc(){return S(this,null,function*(){let t;do t=this.ac,yield t;while(t!==this.ac)})}Ic(t){for(let e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((e,s)=>e.targetTimeMs-s.targetTimeMs);for(let e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()})}Rc(t){this.oc.push(t)}hc(t){let e=this.tc.indexOf(t);this.tc.splice(e,1)}};function ia(r){let t=r.message||"";return r.stack&&(t=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),t}var on=class extends Xn{constructor(t,e,s,i){super(t,e,s,i),this.type="firestore",this._queue=new tr,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return S(this,null,function*(){if(this._firestoreClient){let t=this._firestoreClient.terminate();this._queue=new tr(t),this._firestoreClient=void 0,yield t}})}};function As(r,t){let e=typeof r=="object"?r:Ze(),s=typeof r=="string"?r:t||Wn,i=Kt(e,"firestore").getImmediate({identifier:s});if(!i._initialized){let c=So("firestore");c&&Da(i,...c)}return i}var se=class r{constructor(t){this._byteString=t}static fromBase64String(t){try{return new r(Ot.fromBase64String(t))}catch(e){throw new D(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new r(Ot.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:r._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(ve(t,r._jsonSchema))return r.fromBase64String(t.bytes)}};se._jsonSchemaVersion="firestore/bytes/1.0",se._jsonSchema={type:K("string",se._jsonSchemaVersion),bytes:K("string")};var Ee=class{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new D(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $n(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}};var ye=class r{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new D(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new D(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Nt(this._lat,t._lat)||Nt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:r._jsonSchemaVersion}}static fromJSON(t){if(ve(t,r._jsonSchema))return new r(t.latitude,t.longitude)}};ye._jsonSchemaVersion="firestore/geoPoint/1.0",ye._jsonSchema={type:K("string",ye._jsonSchemaVersion),latitude:K("number"),longitude:K("number")};var _e=class r{constructor(t){this._values=(t||[]).map(e=>e)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(s,i){if(s.length!==i.length)return!1;for(let c=0;c<s.length;++c)if(s[c]!==i[c])return!1;return!0}(this._values,t._values)}toJSON(){return{type:r._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(ve(t,r._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(e=>typeof e=="number"))return new r(t.vectorValues);throw new D(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};_e._jsonSchemaVersion="firestore/vectorValue/1.0",_e._jsonSchema={type:K("string",_e._jsonSchemaVersion),vectorValues:K("object")};function Ss(r,t,e){if((t=ee(t))instanceof Ee)return t._internalPath;if(typeof t=="string")return xa(r,t);throw Es("Field path arguments must be of type string or ",r,!1,void 0,e)}var Yl=new RegExp("[~\\*/\\[\\]]");function xa(r,t,e){if(t.search(Yl)>=0)throw Es(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,e);try{return new Ee(...t.split("."))._internalPath}catch{throw Es(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,e)}}function Es(r,t,e,s,i){let c=s&&!s.isEmpty(),u=i!==void 0,m=`Function ${t}() called with invalid data`;e&&(m+=" (via `toFirestore()`)"),m+=". ";let E="";return(c||u)&&(E+=" (found",c&&(E+=` in field ${s}`),u&&(E+=` in document ${i}`),E+=")"),new D(P.INVALID_ARGUMENT,m+r+E)}var Va="@firebase/firestore",ka="4.10.0";var er=class{constructor(t,e,s,i,c){this._firestore=t,this._userDataWriter=e,this._key=s,this._document=i,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new kt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let t=new Rs(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(t){if(this._document){let e=this._document.data.field(Ss("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}},Rs=class extends er{data(){return super.data()}};var be=class{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}},Ae=class r extends er{constructor(t,e,s,i,c,u){super(t,e,s,i,u),this._firestore=t,this._firestoreImpl=t,this.metadata=c}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){let e=new Se(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){let s=this._document.data.field(Ss("DocumentSnapshot.get",t));if(s!==null)return this._userDataWriter.convertValue(s,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new D(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let t=this._document,e={};return e.type=r._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}};Ae._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ae._jsonSchema={type:K("string",Ae._jsonSchemaVersion),bundleSource:K("string","DocumentSnapshot"),bundleName:K("string"),bundle:K("string")};var Se=class extends Ae{data(t={}){return super.data(t)}},cn=class r{constructor(t,e,s,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new be(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){let t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(s=>{t.call(e,new Se(this._firestore,this._userDataWriter,s.key,s,new be(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){let e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new D(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(i,c){if(i._snapshot.oldDocs.isEmpty()){let u=0;return i._snapshot.docChanges.map(m=>{let E=new Se(i._firestore,i._userDataWriter,m.doc.key,m.doc,new be(i._snapshot.mutatedKeys.has(m.doc.key),i._snapshot.fromCache),i.query.converter);return m.doc,{type:"added",doc:E,oldIndex:-1,newIndex:u++}})}{let u=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(m=>c||m.type!==3).map(m=>{let E=new Se(i._firestore,i._userDataWriter,m.doc.key,m.doc,new be(i._snapshot.mutatedKeys.has(m.doc.key),i._snapshot.fromCache),i.query.converter),T=-1,R=-1;return m.type!==0&&(T=u.indexOf(m.doc.key),u=u.delete(m.doc.key)),m.type!==1&&(u=u.add(m.doc),R=u.indexOf(m.doc.key)),{type:rh(m.type),doc:E,oldIndex:T,newIndex:R}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new D(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let t={};t.type=r._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=rn.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let e=[],s=[],i=[];return this.docs.forEach(c=>{c._document!==null&&(e.push(c._document),s.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),i.push(c.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}};function rh(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Z(61501,{type:r})}}cn._jsonSchemaVersion="firestore/querySnapshot/1.0",cn._jsonSchema={type:K("string",cn._jsonSchemaVersion),bundleSource:K("string","QuerySnapshot"),bundleName:K("string"),bundle:K("string")};(function(t,e=!0){oa(Go),gt(new it("firestore",(s,{instanceIdentifier:i,options:c})=>{let u=s.getProvider("app").getImmediate(),m=new on(new Un(s.getProvider("auth-internal")),new jn(u,s.getProvider("app-check-internal")),va(u,i),u);return c=C({useFetchStreams:e},c),m._setSettings(c),m},"PUBLIC").setMultipleInstances(!0)),ut(Va,ka,t),ut(Va,ka,"esm2020")})();var sh=(r,t)=>t.some(e=>r instanceof e),Na,Oa;function ih(){return Na||(Na=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oh(){return Oa||(Oa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Ma=new WeakMap,Cs=new WeakMap,Fa=new WeakMap,Ps=new WeakMap,xs=new WeakMap;function ah(r){let t=new Promise((e,s)=>{let i=()=>{r.removeEventListener("success",c),r.removeEventListener("error",u)},c=()=>{e(Rt(r.result)),i()},u=()=>{s(r.error),i()};r.addEventListener("success",c),r.addEventListener("error",u)});return t.then(e=>{e instanceof IDBCursor&&Ma.set(e,r)}).catch(()=>{}),xs.set(t,r),t}function ch(r){if(Cs.has(r))return;let t=new Promise((e,s)=>{let i=()=>{r.removeEventListener("complete",c),r.removeEventListener("error",u),r.removeEventListener("abort",u)},c=()=>{e(),i()},u=()=>{s(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",c),r.addEventListener("error",u),r.addEventListener("abort",u)});Cs.set(r,t)}var Ds={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return Cs.get(r);if(t==="objectStoreNames")return r.objectStoreNames||Fa.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Rt(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function La(r){Ds=r(Ds)}function uh(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){let s=r.call(nr(this),t,...e);return Fa.set(s,t.sort?t.sort():[t]),Rt(s)}:oh().includes(r)?function(...t){return r.apply(nr(this),t),Rt(Ma.get(this))}:function(...t){return Rt(r.apply(nr(this),t))}}function lh(r){return typeof r=="function"?uh(r):(r instanceof IDBTransaction&&ch(r),sh(r,ih())?new Proxy(r,Ds):r)}function Rt(r){if(r instanceof IDBRequest)return ah(r);if(Ps.has(r))return Ps.get(r);let t=lh(r);return t!==r&&(Ps.set(r,t),xs.set(t,r)),t}var nr=r=>xs.get(r);function Ua(r,t,{blocked:e,upgrade:s,blocking:i,terminated:c}={}){let u=indexedDB.open(r,t),m=Rt(u);return s&&u.addEventListener("upgradeneeded",E=>{s(Rt(u.result),E.oldVersion,E.newVersion,Rt(u.transaction),E)}),e&&u.addEventListener("blocked",E=>e(E.oldVersion,E.newVersion,E)),m.then(E=>{c&&E.addEventListener("close",()=>c()),i&&E.addEventListener("versionchange",T=>i(T.oldVersion,T.newVersion,T))}).catch(()=>{}),m}var hh=["get","getKey","getAll","getAllKeys","count"],dh=["put","add","delete","clear"],Vs=new Map;function Ba(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(Vs.get(t))return Vs.get(t);let e=t.replace(/FromIndex$/,""),s=t!==e,i=dh.includes(e);if(!(e in(s?IDBIndex:IDBObjectStore).prototype)||!(i||hh.includes(e)))return;let c=function(u,...m){return S(this,null,function*(){let E=this.transaction(u,i?"readwrite":"readonly"),T=E.store;return s&&(T=T.index(m.shift())),(yield Promise.all([T[e](...m),i&&E.done]))[0]})};return Vs.set(t,c),c}La(r=>V(C({},r),{get:(t,e,s)=>Ba(t,e)||r.get(t,e,s),has:(t,e)=>!!Ba(t,e)||r.has(t,e)}));var za="@firebase/installations",Ms="0.6.19";var $a=1e4,Ga=`w:${Ms}`,Ka="FIS_v2",fh="https://firebaseinstallations.googleapis.com/v1",mh=60*60*1e3,ph="installations",gh="Installations";var yh={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},oe=new Ct(ph,gh,yh);function Ha(r){return r instanceof ht&&r.code.includes("request-failed")}function Wa({projectId:r}){return`${fh}/projects/${r}/installations`}function Qa(r){return{token:r.token,requestStatus:2,expiresIn:wh(r.expiresIn),creationTime:Date.now()}}function Ya(r,t){return S(this,null,function*(){let s=(yield t.json()).error;return oe.create("request-failed",{requestName:r,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})})}function Ja({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function _h(r,{refreshToken:t}){let e=Ja(r);return e.append("Authorization",Ih(t)),e}function Xa(r){return S(this,null,function*(){let t=yield r();return t.status>=500&&t.status<600?r():t})}function wh(r){return Number(r.replace("s","000"))}function Ih(r){return`${Ka} ${r}`}function Eh(s,i){return S(this,arguments,function*({appConfig:r,heartbeatServiceProvider:t},{fid:e}){let c=Wa(r),u=Ja(r),m=t.getImmediate({optional:!0});if(m){let b=yield m.getHeartbeatsHeader();b&&u.append("x-firebase-client",b)}let E={fid:e,authVersion:Ka,appId:r.appId,sdkVersion:Ga},T={method:"POST",headers:u,body:JSON.stringify(E)},R=yield Xa(()=>fetch(c,T));if(R.ok){let b=yield R.json();return{fid:b.fid||e,registrationStatus:2,refreshToken:b.refreshToken,authToken:Qa(b.authToken)}}else throw yield Ya("Create Installation",R)})}function Za(r){return new Promise(t=>{setTimeout(t,r)})}function Th(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}var vh=/^[cdef][\w-]{21}$/,Os="";function bh(){try{let r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;let e=Ah(r);return vh.test(e)?e:Os}catch{return Os}}function Ah(r){return Th(r).substr(0,22)}function sr(r){return`${r.appName}!${r.appId}`}var tc=new Map;function ec(r,t){let e=sr(r);nc(e,t),Sh(e,t)}function nc(r,t){let e=tc.get(r);if(e)for(let s of e)s(t)}function Sh(r,t){let e=Rh();e&&e.postMessage({key:r,fid:t}),Ph()}var ie=null;function Rh(){return!ie&&"BroadcastChannel"in self&&(ie=new BroadcastChannel("[Firebase] FID Change"),ie.onmessage=r=>{nc(r.data.key,r.data.fid)}),ie}function Ph(){tc.size===0&&ie&&(ie.close(),ie=null)}var Ch="firebase-installations-database",Dh=1,ae="firebase-installations-store",ks=null;function Fs(){return ks||(ks=Ua(Ch,Dh,{upgrade:(r,t)=>{switch(t){case 0:r.createObjectStore(ae)}}})),ks}function rr(r,t){return S(this,null,function*(){let e=sr(r),i=(yield Fs()).transaction(ae,"readwrite"),c=i.objectStore(ae),u=yield c.get(e);return yield c.put(t,e),yield i.done,(!u||u.fid!==t.fid)&&ec(r,t.fid),t})}function rc(r){return S(this,null,function*(){let t=sr(r),s=(yield Fs()).transaction(ae,"readwrite");yield s.objectStore(ae).delete(t),yield s.done})}function ir(r,t){return S(this,null,function*(){let e=sr(r),i=(yield Fs()).transaction(ae,"readwrite"),c=i.objectStore(ae),u=yield c.get(e),m=t(u);return m===void 0?yield c.delete(e):yield c.put(m,e),yield i.done,m&&(!u||u.fid!==m.fid)&&ec(r,m.fid),m})}function Ls(r){return S(this,null,function*(){let t,e=yield ir(r.appConfig,s=>{let i=xh(s),c=Vh(r,i);return t=c.registrationPromise,c.installationEntry});return e.fid===Os?{installationEntry:yield t}:{installationEntry:e,registrationPromise:t}})}function xh(r){let t=r||{fid:bh(),registrationStatus:0};return sc(t)}function Vh(r,t){if(t.registrationStatus===0){if(!navigator.onLine){let i=Promise.reject(oe.create("app-offline"));return{installationEntry:t,registrationPromise:i}}let e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},s=kh(r,e);return{installationEntry:e,registrationPromise:s}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:Nh(r)}:{installationEntry:t}}function kh(r,t){return S(this,null,function*(){try{let e=yield Eh(r,t);return rr(r.appConfig,e)}catch(e){throw Ha(e)&&e.customData.serverCode===409?yield rc(r.appConfig):yield rr(r.appConfig,{fid:t.fid,registrationStatus:0}),e}})}function Nh(r){return S(this,null,function*(){let t=yield qa(r.appConfig);for(;t.registrationStatus===1;)yield Za(100),t=yield qa(r.appConfig);if(t.registrationStatus===0){let{installationEntry:e,registrationPromise:s}=yield Ls(r);return s||e}return t})}function qa(r){return ir(r,t=>{if(!t)throw oe.create("installation-not-found");return sc(t)})}function sc(r){return Oh(r)?{fid:r.fid,registrationStatus:0}:r}function Oh(r){return r.registrationStatus===1&&r.registrationTime+$a<Date.now()}function Mh(s,i){return S(this,arguments,function*({appConfig:r,heartbeatServiceProvider:t},e){let c=Fh(r,e),u=_h(r,e),m=t.getImmediate({optional:!0});if(m){let b=yield m.getHeartbeatsHeader();b&&u.append("x-firebase-client",b)}let E={installation:{sdkVersion:Ga,appId:r.appId}},T={method:"POST",headers:u,body:JSON.stringify(E)},R=yield Xa(()=>fetch(c,T));if(R.ok){let b=yield R.json();return Qa(b)}else throw yield Ya("Generate Auth Token",R)})}function Fh(r,{fid:t}){return`${Wa(r)}/${t}/authTokens:generate`}function Bs(r,t=!1){return S(this,null,function*(){let e,s=yield ir(r.appConfig,c=>{if(!ic(c))throw oe.create("not-registered");let u=c.authToken;if(!t&&Uh(u))return c;if(u.requestStatus===1)return e=Lh(r,t),c;{if(!navigator.onLine)throw oe.create("app-offline");let m=jh(c);return e=Bh(r,m),m}});return e?yield e:s.authToken})}function Lh(r,t){return S(this,null,function*(){let e=yield ja(r.appConfig);for(;e.authToken.requestStatus===1;)yield Za(100),e=yield ja(r.appConfig);let s=e.authToken;return s.requestStatus===0?Bs(r,t):s})}function ja(r){return ir(r,t=>{if(!ic(t))throw oe.create("not-registered");let e=t.authToken;return zh(e)?V(C({},t),{authToken:{requestStatus:0}}):t})}function Bh(r,t){return S(this,null,function*(){try{let e=yield Mh(r,t),s=V(C({},t),{authToken:e});return yield rr(r.appConfig,s),e}catch(e){if(Ha(e)&&(e.customData.serverCode===401||e.customData.serverCode===404))yield rc(r.appConfig);else{let s=V(C({},t),{authToken:{requestStatus:0}});yield rr(r.appConfig,s)}throw e}})}function ic(r){return r!==void 0&&r.registrationStatus===2}function Uh(r){return r.requestStatus===2&&!qh(r)}function qh(r){let t=Date.now();return t<r.creationTime||r.creationTime+r.expiresIn<t+mh}function jh(r){let t={requestStatus:1,requestTime:Date.now()};return V(C({},r),{authToken:t})}function zh(r){return r.requestStatus===1&&r.requestTime+$a<Date.now()}function $h(r){return S(this,null,function*(){let t=r,{installationEntry:e,registrationPromise:s}=yield Ls(t);return s?s.catch(console.error):Bs(t).catch(console.error),e.fid})}function Gh(r,t=!1){return S(this,null,function*(){let e=r;return yield Kh(e),(yield Bs(e,t)).token})}function Kh(r){return S(this,null,function*(){let{registrationPromise:t}=yield Ls(r);t&&(yield t)})}function Hh(r){if(!r||!r.options)throw Ns("App Configuration");if(!r.name)throw Ns("App Name");let t=["projectId","apiKey","appId"];for(let e of t)if(!r.options[e])throw Ns(e);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function Ns(r){return oe.create("missing-app-config-values",{valueName:r})}var oc="installations",Wh="installations-internal",Qh=r=>{let t=r.getProvider("app").getImmediate(),e=Hh(t),s=Kt(t,"heartbeat");return{app:t,appConfig:e,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},Yh=r=>{let t=r.getProvider("app").getImmediate(),e=Kt(t,oc).getImmediate();return{getId:()=>$h(e),getToken:i=>Gh(e,i)}};function Jh(){gt(new it(oc,Qh,"PUBLIC")),gt(new it(Wh,Yh,"PRIVATE"))}Jh();ut(za,Ms);ut(za,Ms,"esm2020");var or="analytics",Xh="firebase_id",Zh="origin",td=60*1e3,ed="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Ks="https://www.googletagmanager.com/gtag/js";var ot=new $t("@firebase/analytics");var nd={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},dt=new Ct("analytics","Analytics",nd);function rd(r){if(!r.startsWith(Ks)){let t=dt.create("invalid-gtag-resource",{gtagURL:r});return ot.warn(t.message),""}return r}function fc(r){return Promise.all(r.map(t=>t.catch(e=>e)))}function sd(r,t){let e;return window.trustedTypes&&(e=window.trustedTypes.createPolicy(r,t)),e}function id(r,t){let e=sd("firebase-js-sdk-policy",{createScriptURL:rd}),s=document.createElement("script"),i=`${Ks}?l=${r}&id=${t}`;s.src=e?e?.createScriptURL(i):i,s.async=!0,document.head.appendChild(s)}function od(r){let t=[];return Array.isArray(window[r])?t=window[r]:window[r]=t,t}function ad(r,t,e,s,i,c){return S(this,null,function*(){let u=s[i];try{if(u)yield t[u];else{let E=(yield fc(e)).find(T=>T.measurementId===i);E&&(yield t[E.appId])}}catch(m){ot.error(m)}r("config",i,c)})}function cd(r,t,e,s,i){return S(this,null,function*(){try{let c=[];if(i&&i.send_to){let u=i.send_to;Array.isArray(u)||(u=[u]);let m=yield fc(e);for(let E of u){let T=m.find(b=>b.measurementId===E),R=T&&t[T.appId];if(R)c.push(R);else{c=[];break}}}c.length===0&&(c=Object.values(t)),yield Promise.all(c),r("event",s,i||{})}catch(c){ot.error(c)}})}function ud(r,t,e,s){function i(c,...u){return S(this,null,function*(){try{if(c==="event"){let[m,E]=u;yield cd(r,t,e,m,E)}else if(c==="config"){let[m,E]=u;yield ad(r,t,e,s,m,E)}else if(c==="consent"){let[m,E]=u;r("consent",m,E)}else if(c==="get"){let[m,E,T]=u;r("get",m,E,T)}else if(c==="set"){let[m]=u;r("set",m)}else r(c,...u)}catch(m){ot.error(m)}})}return i}function ld(r,t,e,s,i){let c=function(...u){window[s].push(arguments)};return window[i]&&typeof window[i]=="function"&&(c=window[i]),window[i]=ud(c,r,t,e),{gtagCore:c,wrappedGtag:window[i]}}function hd(r){let t=window.document.getElementsByTagName("script");for(let e of Object.values(t))if(e.src&&e.src.includes(Ks)&&e.src.includes(r))return e;return null}var dd=30,fd=1e3,qs=class{constructor(t={},e=fd){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}},mc=new qs;function md(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}function pd(r){return S(this,null,function*(){let{appId:t,apiKey:e}=r,s={method:"GET",headers:md(e)},i=ed.replace("{app-id}",t),c=yield fetch(i,s);if(c.status!==200&&c.status!==304){let u="";try{let m=yield c.json();m.error?.message&&(u=m.error.message)}catch{}throw dt.create("config-fetch-failed",{httpStatus:c.status,responseMessage:u})}return c.json()})}function gd(s){return S(this,arguments,function*(r,t=mc,e){let{appId:i,apiKey:c,measurementId:u}=r.options;if(!i)throw dt.create("no-app-id");if(!c){if(u)return{measurementId:u,appId:i};throw dt.create("no-api-key")}let m=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},E=new js;return setTimeout(()=>S(this,null,function*(){E.abort()}),e!==void 0?e:td),pc({appId:i,apiKey:c,measurementId:u},m,E,t)})}function pc(c,u,m){return S(this,arguments,function*(r,{throttleEndTimeMillis:t,backoffCount:e},s,i=mc){let{appId:E,measurementId:T}=r;try{yield yd(s,t)}catch(R){if(T)return ot.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${T} provided in the "measurementId" field in the local Firebase config. [${R?.message}]`),{appId:E,measurementId:T};throw R}try{let R=yield pd(r);return i.deleteThrottleMetadata(E),R}catch(R){let b=R;if(!_d(b)){if(i.deleteThrottleMetadata(E),T)return ot.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${T} provided in the "measurementId" field in the local Firebase config. [${b?.message}]`),{appId:E,measurementId:T};throw R}let A=Number(b?.customData?.httpStatus)===503?Ur(e,i.intervalMillis,dd):Ur(e,i.intervalMillis),O={throttleEndTimeMillis:Date.now()+A,backoffCount:e+1};return i.setThrottleMetadata(E,O),ot.debug(`Calling attemptFetch again in ${A} millis`),pc(r,O,s,i)}})}function yd(r,t){return new Promise((e,s)=>{let i=Math.max(t-Date.now(),0),c=setTimeout(e,i);r.addEventListener(()=>{clearTimeout(c),s(dt.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function _d(r){if(!(r instanceof ht)||!r.customData)return!1;let t=Number(r.customData.httpStatus);return t===429||t===500||t===503||t===504}var js=class{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}};var zs;function wd(r,t,e,s,i){return S(this,null,function*(){if(i&&i.global){r("event",e,s);return}else{let c=yield t,u=V(C({},s),{send_to:c});r("event",e,u)}})}function Id(r,t,e,s){return S(this,null,function*(){if(s&&s.global){let i={};for(let c of Object.keys(e))i[`user_properties.${c}`]=e[c];return r("set",i),Promise.resolve()}else{let i=yield t;r("config",i,{update:!0,user_properties:e})}})}var $s;function Ed(r){$s=r}function Td(r){zs=r}function vd(){return S(this,null,function*(){if(Je())try{yield Dn()}catch(r){return ot.warn(dt.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}else return ot.warn(dt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function bd(r,t,e,s,i,c,u){return S(this,null,function*(){let m=gd(r);m.then(A=>{e[A.measurementId]=A.appId,r.options.measurementId&&A.measurementId!==r.options.measurementId&&ot.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${A.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(A=>ot.error(A)),t.push(m);let E=vd().then(A=>{if(A)return s.getId()}),[T,R]=yield Promise.all([m,E]);hd(c)||id(c,T.measurementId),$s&&(i("consent","default",$s),Ed(void 0)),i("js",new Date);let b=u?.config??{};return b[Zh]="firebase",b.update=!0,R!=null&&(b[Xh]=R),i("config",T.measurementId,b),zs&&(i("set",zs),Td(void 0)),T.measurementId})}var Gs=class{constructor(t){this.app=t}_delete(){return delete Re[this.app.options.appId],Promise.resolve()}},Re={},ac=[],cc={},Us="dataLayer",Ad="gtag",uc,Hs,lc=!1;function Sd(){let r=[];if(Do()&&r.push("This is a browser extension environment."),xo()||r.push("Cookies are not available."),r.length>0){let t=r.map((s,i)=>`(${i+1}) ${s}`).join(" "),e=dt.create("invalid-analytics-context",{errorInfo:t});ot.warn(e.message)}}function Rd(r,t,e){Sd();let s=r.options.appId;if(!s)throw dt.create("no-app-id");if(!r.options.apiKey)if(r.options.measurementId)ot.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw dt.create("no-api-key");if(Re[s]!=null)throw dt.create("already-exists",{id:s});if(!lc){od(Us);let{wrappedGtag:c,gtagCore:u}=ld(Re,ac,cc,Us,Ad);Hs=c,uc=u,lc=!0}return Re[s]=bd(r,ac,cc,t,uc,Us,e),new Gs(r)}function gc(r=Ze()){r=ee(r);let t=Kt(r,or);return t.isInitialized()?t.getImmediate():Pd(r)}function Pd(r,t={}){let e=Kt(r,or);if(e.isInitialized()){let i=e.getImmediate();if(Dt(t,e.getOptions()))return i;throw dt.create("already-initialized")}return e.initialize({options:t})}function Cd(r,t,e){r=ee(r),Id(Hs,Re[r.app.options.appId],t,e).catch(s=>ot.error(s))}function Dd(r,t,e,s){r=ee(r),wd(Hs,Re[r.app.options.appId],t,e,s).catch(i=>ot.error(i))}var hc="@firebase/analytics",dc="0.10.19";function xd(){gt(new it(or,(t,{options:e})=>{let s=t.getProvider("app").getImmediate(),i=t.getProvider("installations-internal").getImmediate();return Rd(s,i,e)},"PUBLIC")),gt(new it("analytics-internal",r,"PRIVATE")),ut(hc,dc),ut(hc,dc,"esm2020");function r(t){try{let e=t.getProvider(or).getImmediate();return{logEvent:(s,i,c)=>Dd(e,s,i,c),setUserProperties:(s,i)=>Cd(e,s,i)}}catch(e){throw dt.create("interop-component-reg-failed",{reason:e})}}}xd();var Oy=(()=>{class r{constructor(){if(this.app=es(Rn.firebase),this.db=As(this.app),typeof window<"u"&&Rn.production)try{this.analytics=gc(this.app)}catch(e){console.warn("Analytics not available:",e)}console.log("Firebase initialized with project:",Rn.firebase.projectId)}getFirestore(){return this.db}getApp(){return this.app}getAnalytics(){return this.analytics}static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{Tt as a,ro as b,Bd as c,Ud as d,qd as e,de as f,z as g,An as h,ao as i,Or as j,fe as k,pt as l,yo as m,co as n,uo as o,lo as p,Nr as q,We as r,ho as s,mo as t,po as u,go as v,Sn as w,jf as x,Yf as y,em as z,am as A,mm as B,Em as C,bm as D,Rn as E,Oy as F};
