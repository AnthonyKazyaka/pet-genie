import{e as ce}from"./chunk-HF736BE6.js";import{a as ne,b as ie,c as oe,d as ae,e as le,f as re,h as me}from"./chunk-EKRWJKAO.js";import{b as Z,c as $}from"./chunk-RIANM46A.js";import{a as ee,b as te}from"./chunk-JCPHAOSO.js";import{a as H,d as J,h as U,i as X}from"./chunk-XWJJCW7V.js";import{b as j,f as q,i as K,p as G,r as Y}from"./chunk-7VLTXITI.js";import{a as W,b as A,d as B,e as Q,f as z,g as R}from"./chunk-WNYBICT2.js";import{fa as O,ha as T,ia as V,ja as F,ka as N}from"./chunk-77V6CQ2B.js";import{Bb as E,Cb as b,Db as i,Eb as n,Fb as k,Jb as f,Mb as p,Ob as c,Pc as I,Yb as l,Zb as L,_a as s,bc as h,cc as x,dc as M,fc as v,ha as w,lb as _,ma as P,rb as g,tb as y,ua as d,va as C,vb as S,xc as D,yb as u}from"./chunk-5MEO4XP4.js";var de=(t,r)=>r.id;function Ce(t,r){t&1&&(i(0,"mat-icon",16),l(1,"check_circle"),n())}function _e(t,r){t&1&&k(0,"mat-divider")}function pe(t,r){if(t&1){let e=f();i(0,"mat-list-item",12),p("click",function(){let o=d(e).$implicit,m=c(3);return C(m.selectClient(o.id))}),i(1,"mat-icon",13),l(2,"person"),n(),i(3,"div",14),l(4),n(),i(5,"div",15),l(6),n(),g(7,Ce,2,0,"mat-icon",16),n(),g(8,_e,1,0,"mat-divider")}if(t&2){let e=r.$implicit,a=c(3);S("selected",a.selectedClientId()===e.id),s(4),L(e.name),s(2),L(e.address||"No address"),s(),u(7,a.selectedClientId()===e.id?7:-1),s(),u(8,e!==a.filteredClients()[a.filteredClients().length-1]?8:-1)}}function ge(t,r){if(t&1&&(i(0,"mat-list"),E(1,pe,9,6,null,null,de),n()),t&2){let e=c(2);s(),b(e.filteredClients())}}function ue(t,r){t&1&&(i(0,"div",17)(1,"mat-icon"),l(2,"person_off"),n(),i(3,"p"),l(4,"No clients found"),n()())}function fe(t,r){if(t&1){let e=f();i(0,"mat-form-field",5)(1,"mat-label"),l(2,"Search clients"),n(),i(3,"mat-icon",6),l(4,"search"),n(),i(5,"input",7),M("ngModelChange",function(o){d(e);let m=c();return x(m.searchQuery,o)||(m.searchQuery=o),C(o)}),n()(),i(6,"div",8),g(7,ge,3,0,"mat-list")(8,ue,5,0),n(),k(9,"mat-divider",9),i(10,"div",10)(11,"span"),l(12,"or"),n()(),i(13,"button",11),p("click",function(){d(e);let o=c();return C(o.toggleCreateForm())}),i(14,"mat-icon"),l(15,"add"),n(),l(16," Create new client "),n()}if(t&2){let e=c();s(5),h("ngModel",e.searchQuery),s(2),u(7,e.filteredClients().length>0?7:8)}}function he(t,r){if(t&1){let e=f();i(0,"div",18)(1,"div",19)(2,"h3"),l(3,"New client"),n(),i(4,"button",20),p("click",function(){d(e);let o=c();return C(o.toggleCreateForm())}),i(5,"mat-icon"),l(6,"close"),n()()(),i(7,"mat-form-field",5)(8,"mat-label"),l(9,"Client Name"),n(),i(10,"mat-icon",6),l(11,"person"),n(),i(12,"input",21),M("ngModelChange",function(o){d(e);let m=c();return x(m.newClientName,o)||(m.newClientName=o),C(o)}),n()(),i(13,"mat-form-field",5)(14,"mat-label"),l(15,"Address"),n(),i(16,"mat-icon",6),l(17,"location_on"),n(),i(18,"textarea",22),M("ngModelChange",function(o){d(e);let m=c();return x(m.newClientAddress,o)||(m.newClientAddress=o),C(o)}),n()(),i(19,"div",23)(20,"mat-form-field",24)(21,"mat-label"),l(22,"Phone"),n(),i(23,"mat-icon",6),l(24,"phone"),n(),i(25,"input",25),M("ngModelChange",function(o){d(e);let m=c();return x(m.newClientPhone,o)||(m.newClientPhone=o),C(o)}),n()(),i(26,"mat-form-field",24)(27,"mat-label"),l(28,"Email"),n(),i(29,"mat-icon",6),l(30,"email"),n(),i(31,"input",26),M("ngModelChange",function(o){d(e);let m=c();return x(m.newClientEmail,o)||(m.newClientEmail=o),C(o)}),n()()()()}if(t&2){let e=c();s(12),h("ngModel",e.newClientName),s(6),h("ngModel",e.newClientAddress),s(7),h("ngModel",e.newClientPhone),s(6),h("ngModel",e.newClientEmail)}}function xe(t,r){if(t&1){let e=f();i(0,"button",27),p("click",function(){d(e);let o=c();return C(o.confirmSelection())}),l(1," Link Client "),n()}if(t&2){let e=c();y("disabled",!e.selectedClientId())}}function Me(t,r){if(t&1){let e=f();i(0,"button",27),p("click",function(){d(e);let o=c();return C(o.createAndLink())}),l(1," Create & Link "),n()}if(t&2){let e=c();y("disabled",!e.newClientName().trim())}}var qe=(()=>{class t{constructor(){this.dialogRef=w(W),this.data=w(A),this.searchQuery=_(""),this.showCreateForm=_(!1),this.selectedClientId=_(null),this.newClientName=_(""),this.newClientAddress=_(""),this.newClientPhone=_(""),this.newClientEmail=_(""),this.filteredClients=D(()=>{let e=this.searchQuery().toLowerCase();return e?this.data.clients.filter(a=>a.name.toLowerCase().includes(e)||a.address?.toLowerCase().includes(e)):this.data.clients}),this.data.candidateName&&this.searchQuery.set(this.data.candidateName),this.data.currentClientId&&this.selectedClientId.set(this.data.currentClientId)}selectClient(e){this.selectedClientId.set(e)}confirmSelection(){let e=this.selectedClientId();if(!e)return;let a={action:"select",clientId:e};this.dialogRef.close(a)}toggleCreateForm(){if(this.showCreateForm.set(!this.showCreateForm()),this.showCreateForm()){let e=this.searchQuery()||this.data.candidateName||"";this.newClientName.set(e)}}createAndLink(){let e=this.newClientName().trim();if(!e)return;let o={action:"create",newClient:{name:e,address:this.newClientAddress().trim(),phone:this.newClientPhone().trim(),email:this.newClientEmail().trim()}};this.dialogRef.close(o)}cancel(){let e={action:"cancel"};this.dialogRef.close(e)}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=P({type:t,selectors:[["app-link-client-dialog"]],standalone:!0,features:[v],decls:12,vars:2,consts:[["mat-dialog-title",""],[1,"helper-text"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"disabled"],["appearance","outline",1,"full-width"],["matPrefix",""],["matInput","","placeholder","Search clients\u2026",3,"ngModelChange","ngModel"],[1,"client-list"],[1,"section-divider"],[1,"or-section"],["mat-stroked-button","",1,"full-width",3,"click"],[3,"click"],["matListItemIcon",""],["matListItemTitle",""],["matListItemLine",""],["matListItemMeta","","color","primary"],[1,"empty-state"],[1,"create-form"],[1,"form-header"],["mat-icon-button","",3,"click"],["matInput","","placeholder","Client name","required","",3,"ngModelChange","ngModel"],["matInput","","rows","2","placeholder","Street address",3,"ngModelChange","ngModel"],[1,"form-row"],["appearance","outline"],["matInput","","type","tel","placeholder","Phone number",3,"ngModelChange","ngModel"],["matInput","","type","email","placeholder","Email address",3,"ngModelChange","ngModel"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(a,o){a&1&&(i(0,"h2",0),l(1,"Link this visit to a client"),n(),i(2,"mat-dialog-content")(3,"p",1),l(4,"Pick the client for this visit. You only need to do this once."),n(),g(5,fe,17,2)(6,he,32,4),n(),i(7,"mat-dialog-actions",2)(8,"button",3),p("click",function(){return o.cancel()}),l(9,"Cancel"),n(),g(10,xe,2,1,"button",4)(11,Me,2,1),n()),a&2&&(s(5),u(5,o.showCreateForm()?6:5),s(5),u(10,o.showCreateForm()?11:10))},dependencies:[I,Y,j,q,G,K,R,B,z,Q,V,O,T,N,F,X,U,H,J,$,Z,me,le,re,ae,ee,ie,ne,oe,te,ce],styles:[".helper-text[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:var(--text-secondary);font-size:.9rem;line-height:1.5}.full-width[_ngcontent-%COMP%]{width:100%}.client-list[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;margin:1rem 0;border:1px solid var(--border-color);border-radius:8px}.client-list[_ngcontent-%COMP%]   mat-list[_ngcontent-%COMP%]{padding:0}.client-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{cursor:pointer;transition:background-color .2s}.client-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]:hover{background-color:var(--surface-variant)}.client-list[_ngcontent-%COMP%]   mat-list-item.selected[_ngcontent-%COMP%]{background-color:rgba(var(--primary-rgb),.1)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.section-divider[_ngcontent-%COMP%]{margin:1.5rem 0}.or-section[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:-.75rem 0 1.5rem;position:relative}.or-section[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:var(--background);padding:0 1rem;color:var(--text-secondary);font-size:.875rem;text-transform:uppercase;letter-spacing:.5px}.create-form[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.create-form[_ngcontent-%COMP%]   .form-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;font-weight:500}.create-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}mat-dialog-content[_ngcontent-%COMP%]{min-width:500px;max-width:600px}mat-dialog-actions[_ngcontent-%COMP%]{padding:1rem 1.5rem;gap:1rem}@media (max-width: 768px){mat-dialog-content[_ngcontent-%COMP%]{min-width:unset;max-width:90vw}.create-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return t})();function se(t){return t.trim().toLowerCase()}function we(t,r){if(!r)return[];let e=se(r);return t.filter(a=>se(a.name)===e)}function ye(t){if(t.clientName)return t.clientName.trim();if(t.title){let e=t.title.split(" - ")[0].trim();return e.length<2||["visit","walk","drop-in","overnight","housesit","meet","greet"].includes(e.toLowerCase())?null:e}return null}function Ge(t,r){let e=ye(r);if(!e)return null;let a=we(t,e);return a.length===1?a[0].id:null}export{qe as a,ye as b,Ge as c};
